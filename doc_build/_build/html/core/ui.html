<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Pyleoclim User API &mdash; Pyleoclim 0.7.1beta documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/plot_directive.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/rtd_sphinx_search.min.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/js/rtd_sphinx_search.min.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Tutorials" href="../tutorials.html" />
    <link rel="prev" title="Installing Pyleoclim" href="../installation.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> Pyleoclim
            <img src="../_static/pyleoclim_insigna_full_white.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.7.1beta
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Working with Pyleoclim</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installing Pyleoclim</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Pyleoclim User API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#series-pyleoclim-series">Series (pyleoclim.Series)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#multipleseries-pyleoclim-multipleseries">MultipleSeries (pyleoclim.MultipleSeries)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ensembleseries-pyleoclim-ensembleseries">EnsembleSeries (pyleoclim.EnsembleSeries)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#surrogateseries-pyleoclim-surrogateseries">SurrogateSeries (pyleoclim.SurrogateSeries)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#lipd-pyleoclim-lipd">Lipd (pyleoclim.Lipd)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#lipdseries-pyleoclim-lipdseries">LipdSeries (pyleoclim.LipdSeries)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#psd-pyleoclim-psd">PSD (pyleoclim.PSD)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#multiplepsd-pyleoclim-multiplepsd">MultiplePSD (pyleoclim.MultiplePSD)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#scalogram-pyleoclim-scalogram">Scalogram (pyleoclim.Scalogram)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#multiplescalogram-pyleoclim-multiplescalogram">MultipleScalogram (pyleoclim.MultipleScalogram)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#coherence-pyleoclim-coherence">Coherence (pyleoclim.Coherence)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#corr-pyleoclim-corr">Corr (pyleoclim.Corr)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#correns-pyleoclim-correns">CorrEns (pyleoclim.CorrEns)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#spatialdecomp-pyleoclim-spatialdecomp">SpatialDecomp (pyleoclim.SpatialDecomp)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ssares-pyleoclim-ssares">SsaRes (pyleoclim.SsaRes)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#gen-ts-pyleoclim-gen-ts">gen_ts (pyleoclim.gen_ts)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">Tutorials</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced functionalities</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../utils/introduction.html">Pyleoclim Utilities API (pyleoclim.utils)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Getting Involved</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../citation.html">Citing Pyleoclim</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contribution_guide.html">Contributing to Pyleoclim</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Pyleoclim</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Pyleoclim User API</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/core/ui.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="pyleoclim-user-api">
<h1>Pyleoclim User API<a class="headerlink" href="#pyleoclim-user-api" title="Permalink to this headline"></a></h1>
<p>Pyleoclim, like a lot of other Python packages, follows an object-oriented design. It sounds fancy, but it really is <a class="reference external" href="https://www.freecodecamp.org/news/object-oriented-programming-concepts-21bb035f7260/">quite simple</a>. What this means for you is that we’ve gone through the trouble of coding up a lot of timeseries analysis methods that apply in various situations - so you don’t have to worry about that.
These situations are described in classes, the beauty of which is called “inheritance” (see link above). Basically, it allows to define methods that will automatically apply to your dataset, as long as you put your data within one of those classes.
A major advantage of object-oriented design is that you, the user, can harness the power of Pyleoclim methods in very few lines of code through the user API without ever having to get your hands dirty with our code (unless you want to, of course).
The flipside is that any user would do well to understand Pyleoclim classes, what they are intended for, and what methods they can and cannot support.</p>
<a class="reference internal image-reference" href="../_images/Pyleoclim_API.png"><img alt="The Pyleoclim User API. Credit: Feng Zhu" class="align-center" src="../_images/Pyleoclim_API.png" style="width: 1846.5px; height: 1182.6px;" /></a>
<p>The following describes the various classes that undergird the Pyleoclim edifice.</p>
<section id="series-pyleoclim-series">
<h2>Series (pyleoclim.Series)<a class="headerlink" href="#series-pyleoclim-series" title="Permalink to this headline"></a></h2>
<p>The Series class describes the most basic objects in Pyleoclim. A Series is a simple <a class="reference external" href="https://docs.python.org/3/tutorial/datastructures.html#dictionaries">dictionary</a> that contains 3 things:
- a series of real-valued numbers;
- a time axis at which those values were measured/simulated ;
- optionally, some metadata about both axes, like units, labels and the like.</p>
<p>How to create and manipulate such objects is described in a short example below, while <a class="reference external" href="https://nbviewer.jupyter.org/github/LinkedEarth/Pyleoclim_util/blob/master/example_notebooks/pyleoclim_ui_tutorial.ipynb">this notebook</a> demonstrates how to apply various Pyleoclim methods to Series objects.</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyleoclim.core.ui.Series">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pyleoclim.core.ui.</span></span><span class="sig-name descname"><span class="pre">Series</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clean_ts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#Series"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.Series" title="Permalink to this definition"></a></dt>
<dd><p>pyleoSeries object</p>
<p>The Series class is, at its heart, a simple structure containing two arrays y and t of equal length, and some
metadata allowing to interpret and plot the series. It is similar to a pandas Series, but the concept
was extended because pandas does not yet support geologic time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong> (<em>list</em><em> or </em><em>numpy.array</em>) – independent variable (t)</p></li>
<li><p><strong>value</strong> (<em>list of numpy.array</em>) – values of the dependent variable (y)</p></li>
<li><p><strong>time_unit</strong> (<em>string</em>) – Units for the time vector (e.g., ‘years’).
Default is ‘years’</p></li>
<li><p><strong>time_name</strong> (<em>string</em>) – Name of the time vector (e.g., ‘Time’,’Age’).
Default is None. This is used to label the time axis on plots</p></li>
<li><p><strong>value_name</strong> (<em>string</em>) – Name of the value vector (e.g., ‘temperature’)
Default is None</p></li>
<li><p><strong>value_unit</strong> (<em>string</em>) – Units for the value vector (e.g., ‘deg C’)
Default is None</p></li>
<li><p><strong>label</strong> (<em>string</em>) – Name of the time series (e.g., ‘Nino 3.4’)
Default is None</p></li>
<li><p><strong>clean_ts</strong> (<em>boolean flag</em>) – set to True to remove the NaNs and make time axis strictly prograde with duplicated timestamps reduced by averaging the values
Default is True</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – If True, will print warning messages if there is any</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>In this example, we import the Southern Oscillation Index (SOI) into a pandas dataframe and create a pyleoSeries object.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">pyleoclim</span> <span class="k">as</span> <span class="nn">pyleo</span>

<span class="gp">In [2]: </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="gp">In [3]: </span><span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
<span class="gp">   ...: </span>    <span class="s1">&#39;https://raw.githubusercontent.com/LinkedEarth/Pyleoclim_util/Development/example_data/soi_data.csv&#39;</span><span class="p">,</span>
<span class="gp">   ...: </span>    <span class="n">skiprows</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">1</span>
<span class="gp">   ...: </span><span class="p">)</span>
<span class="gp">   ...: </span>

<span class="gp">In [4]: </span><span class="n">time</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>

<span class="gp">In [5]: </span><span class="n">value</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>

<span class="gp">In [6]: </span><span class="n">ts</span><span class="o">=</span><span class="n">pyleo</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span>
<span class="gp">   ...: </span>    <span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">,</span>
<span class="gp">   ...: </span>    <span class="n">time_name</span><span class="o">=</span><span class="s1">&#39;Year (CE)&#39;</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s1">&#39;SOI&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Southern Oscillation Index&#39;</span>
<span class="gp">   ...: </span><span class="p">)</span>
<span class="gp">   ...: </span>

<span class="gp">In [7]: </span><span class="n">ts</span>
<span class="gh">Out[7]: </span><span class="go">&lt;pyleoclim.core.ui.Series at 0x1ab5ae8b0&gt;</span>

<span class="gp">In [8]: </span><span class="n">ts</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="gh">Out[8]: </span><span class="go">dict_keys([&#39;time&#39;, &#39;value&#39;, &#39;time_name&#39;, &#39;time_unit&#39;, &#39;value_name&#39;, &#39;value_unit&#39;, &#39;label&#39;])</span>
</pre></div>
</div>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyleoclim.core.ui.Series.anomaly" title="pyleoclim.core.ui.Series.anomaly"><code class="xref py py-obj docutils literal notranslate"><span class="pre">anomaly</span></code></a>([timespan])</p></td>
<td><p>Calculate the anomaly of the series</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyleoclim.core.ui.Series.bin" title="pyleoclim.core.ui.Series.bin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bin</span></code></a>(**kwargs)</p></td>
<td><p>Bin values in a time series</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyleoclim.core.ui.Series.causality" title="pyleoclim.core.ui.Series.causality"><code class="xref py py-obj docutils literal notranslate"><span class="pre">causality</span></code></a>(target_series[, method, settings])</p></td>
<td><p>Perform causality analysis with the target timeseries</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyleoclim.core.ui.Series.clean" title="pyleoclim.core.ui.Series.clean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">clean</span></code></a>([verbose])</p></td>
<td><p>Clean up the timeseries by removing NaNs and sort with increasing time points</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyleoclim.core.ui.Series.convert_time_unit" title="pyleoclim.core.ui.Series.convert_time_unit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">convert_time_unit</span></code></a>([time_unit])</p></td>
<td><p>Convert the time unit of the Series object</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyleoclim.core.ui.Series.copy" title="pyleoclim.core.ui.Series.copy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy</span></code></a>()</p></td>
<td><p>Make a copy of the Series object</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyleoclim.core.ui.Series.correlation" title="pyleoclim.core.ui.Series.correlation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">correlation</span></code></a>(target_series[, timespan, ...])</p></td>
<td><p>Estimates the Pearson's correlation and associated significance between two non IID time series</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyleoclim.core.ui.Series.detrend" title="pyleoclim.core.ui.Series.detrend"><code class="xref py py-obj docutils literal notranslate"><span class="pre">detrend</span></code></a>([method])</p></td>
<td><p>Detrend Series object</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyleoclim.core.ui.Series.distplot" title="pyleoclim.core.ui.Series.distplot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">distplot</span></code></a>([figsize, title, savefig_settings, ...])</p></td>
<td><p>Plot the distribution of the timeseries values</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyleoclim.core.ui.Series.fill_na" title="pyleoclim.core.ui.Series.fill_na"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fill_na</span></code></a>([timespan, dt])</p></td>
<td><p>Fill NaNs into the timespan</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyleoclim.core.ui.Series.filter" title="pyleoclim.core.ui.Series.filter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter</span></code></a>([cutoff_freq, cutoff_scale, method])</p></td>
<td><p>Filtering methods for Series objects using four possible methods:</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyleoclim.core.ui.Series.gaussianize" title="pyleoclim.core.ui.Series.gaussianize"><code class="xref py py-obj docutils literal notranslate"><span class="pre">gaussianize</span></code></a>()</p></td>
<td><p>Gaussianizes the timeseries</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyleoclim.core.ui.Series.gkernel" title="pyleoclim.core.ui.Series.gkernel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">gkernel</span></code></a>([step_type])</p></td>
<td><p>Coarse-grain a Series object via a Gaussian kernel.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyleoclim.core.ui.Series.interp" title="pyleoclim.core.ui.Series.interp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">interp</span></code></a>([method])</p></td>
<td><p>Interpolate a Series object onto a new time axis</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyleoclim.core.ui.Series.is_evenly_spaced" title="pyleoclim.core.ui.Series.is_evenly_spaced"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_evenly_spaced</span></code></a>([tol])</p></td>
<td><p>Check if the Series time axis is evenly-spaced, within tolerance</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyleoclim.core.ui.Series.make_labels" title="pyleoclim.core.ui.Series.make_labels"><code class="xref py py-obj docutils literal notranslate"><span class="pre">make_labels</span></code></a>()</p></td>
<td><p>Initialization of labels</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyleoclim.core.ui.Series.outliers" title="pyleoclim.core.ui.Series.outliers"><code class="xref py py-obj docutils literal notranslate"><span class="pre">outliers</span></code></a>([auto, remove, fig_outliers, ...])</p></td>
<td><p>Detects outliers in a timeseries and removes if specified</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyleoclim.core.ui.Series.plot" title="pyleoclim.core.ui.Series.plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot</span></code></a>([figsize, marker, markersize, color, ...])</p></td>
<td><p>Plot the timeseries</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyleoclim.core.ui.Series.segment" title="pyleoclim.core.ui.Series.segment"><code class="xref py py-obj docutils literal notranslate"><span class="pre">segment</span></code></a>([factor])</p></td>
<td><p>Gap detection</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyleoclim.core.ui.Series.slice" title="pyleoclim.core.ui.Series.slice"><code class="xref py py-obj docutils literal notranslate"><span class="pre">slice</span></code></a>(timespan)</p></td>
<td><p>Slicing the timeseries with a timespan (tuple or list)</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyleoclim.core.ui.Series.sort" title="pyleoclim.core.ui.Series.sort"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sort</span></code></a>([verbose])</p></td>
<td><p>Ensure timeseries is aligned to a prograde axis.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyleoclim.core.ui.Series.spectral" title="pyleoclim.core.ui.Series.spectral"><code class="xref py py-obj docutils literal notranslate"><span class="pre">spectral</span></code></a>([method, freq_method, freq_kwargs, ...])</p></td>
<td><p>Perform spectral analysis on the timeseries</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyleoclim.core.ui.Series.ssa" title="pyleoclim.core.ui.Series.ssa"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ssa</span></code></a>([M, nMC, f, trunc, var_thresh])</p></td>
<td><p>Singular Spectrum Analysis</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyleoclim.core.ui.Series.standardize" title="pyleoclim.core.ui.Series.standardize"><code class="xref py py-obj docutils literal notranslate"><span class="pre">standardize</span></code></a>()</p></td>
<td><p>Standardizes the time series</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyleoclim.core.ui.Series.stats" title="pyleoclim.core.ui.Series.stats"><code class="xref py py-obj docutils literal notranslate"><span class="pre">stats</span></code></a>()</p></td>
<td><p>Compute basic statistics for the time series</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyleoclim.core.ui.Series.summary_plot" title="pyleoclim.core.ui.Series.summary_plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">summary_plot</span></code></a>([psd, scalogram, figsize, ...])</p></td>
<td><p>Generate a plot of the timeseries and its frequency content through spectral and wavelet analyses.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyleoclim.core.ui.Series.surrogates" title="pyleoclim.core.ui.Series.surrogates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">surrogates</span></code></a>([method, number, length, seed, ...])</p></td>
<td><p>Generate surrogates with increasing time axis</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyleoclim.core.ui.Series.wavelet" title="pyleoclim.core.ui.Series.wavelet"><code class="xref py py-obj docutils literal notranslate"><span class="pre">wavelet</span></code></a>([method, settings, freq_method, ...])</p></td>
<td><p>Perform wavelet analysis on the timeseries</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyleoclim.core.ui.Series.wavelet_coherence" title="pyleoclim.core.ui.Series.wavelet_coherence"><code class="xref py py-obj docutils literal notranslate"><span class="pre">wavelet_coherence</span></code></a>(target_series[, method, ...])</p></td>
<td><p>Perform wavelet coherence analysis with the target timeseries</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.Series.anomaly">
<span class="sig-name descname"><span class="pre">anomaly</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timespan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#Series.anomaly"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.Series.anomaly" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the anomaly of the series</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>timespan</strong> (<em>tuple</em><em> or </em><em>list</em>) – The timespan of the mean as the reference for anomaly calculation.
It is in form of [a, b], where a, b are two time points.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>new</strong> – The standardized series object</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pyleoclim.Series</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.Series.bin">
<span class="sig-name descname"><span class="pre">bin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#Series.bin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.Series.bin" title="Permalink to this definition"></a></dt>
<dd><p>Bin values in a time series</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kwargs</strong> – Arguments for binning function. See pyleoclim.utils.tsutils.bin for details</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>new</strong> – An binned Series object</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pyleoclim.Series</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="../utils/tsutils/bin_values.html#pyleoclim.utils.tsutils.bin" title="pyleoclim.utils.tsutils.bin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.tsutils.bin</span></code></a></dt><dd><p>bin the time series into evenly-spaced bins</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.Series.causality">
<span class="sig-name descname"><span class="pre">causality</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'liang'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">settings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#Series.causality"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.Series.causality" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Perform causality analysis with the target timeseries</dt><dd><p>The timeseries are first sorted in ascending order.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target_series</strong> (<em>pyleoclim.Series</em>) – A pyleoclim Series object on which to compute causality</p></li>
<li><p><strong>method</strong> (<em>{'liang'</em><em>, </em><em>'granger'}</em>) – The causality method to use.</p></li>
<li><p><strong>settings</strong> (<em>dict</em>) – Parameters associated with the causality methods. Note that each method has different parameters. See individual methods for details</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>res</strong> – Dictionary containing the results of the the causality analysis. See indivudal methods for details</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="../utils/causality/liang.html#pyleoclim.utils.causality.liang_causality" title="pyleoclim.utils.causality.liang_causality"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.causality.liang_causality</span></code></a></dt><dd><p>Liang causality</p>
</dd>
<dt><a class="reference internal" href="../utils/causality/granger.html#pyleoclim.utils.causality.granger_causality" title="pyleoclim.utils.causality.granger_causality"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.causality.granger_causality</span></code></a></dt><dd><p>Granger causality</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p>Liang causality</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">pyleoclim</span> <span class="k">as</span> <span class="nn">pyleo</span>

<span class="gp">In [2]: </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="gp">In [3]: </span><span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/LinkedEarth/Pyleoclim_util/Development/example_data/wtc_test_data_nino.csv&#39;</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">t</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>

<span class="gp">In [5]: </span><span class="n">air</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>

<span class="gp">In [6]: </span><span class="n">nino</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>

<span class="gp">In [7]: </span><span class="n">ts_nino</span><span class="o">=</span><span class="n">pyleo</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">t</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="n">nino</span><span class="p">)</span>

<span class="gp">In [8]: </span><span class="n">ts_air</span><span class="o">=</span><span class="n">pyleo</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">t</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="n">air</span><span class="p">)</span>

<span class="go"># plot the two timeseries</span>
<span class="gp">In [9]: </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ts_nino</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;NINO3 -- SST Anomalies&#39;</span><span class="p">)</span>
<span class="go">&lt;Figure size 1000x400 with 1 Axes&gt;</span>

<span class="gp">In [10]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">closefig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>

<span class="gp">In [11]: </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ts_air</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Deasonalized All Indian Rainfall Index&#39;</span><span class="p">)</span>
<span class="go">&lt;Figure size 1000x400 with 1 Axes&gt;</span>

<span class="gp">In [12]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">closefig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>

<span class="go"># we use the specific params below in ts_nino.causality() just to make the example less heavier;</span>
<span class="go"># please drop the `settings` for real work</span>
<span class="gp">In [13]: </span><span class="n">caus_res</span> <span class="o">=</span> <span class="n">ts_nino</span><span class="o">.</span><span class="n">causality</span><span class="p">(</span><span class="n">ts_air</span><span class="p">,</span> <span class="n">settings</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;nsim&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;signif_test&#39;</span><span class="p">:</span> <span class="s1">&#39;isopersist&#39;</span><span class="p">})</span>

<span class="gp">In [14]: </span><span class="nb">print</span><span class="p">(</span><span class="n">caus_res</span><span class="p">)</span>
<span class="go">{&#39;T21&#39;: 0.005840218794983322, &#39;tau21&#39;: 0.04731826159975568, &#39;Z&#39;: 0.12342420447275003, &#39;dH1_star&#39;: -0.5094709112673714, &#39;dH1_noise&#39;: 0.4432108271328729, &#39;signif_qs&#39;: [0.005, 0.025, 0.05, 0.95, 0.975, 0.995], &#39;T21_noise&#39;: array([-2.76381095e-04, -2.76381095e-04, -2.76381095e-04, -1.18390580e-06,</span>
<span class="go">       -1.18390580e-06, -1.18390580e-06]), &#39;tau21_noise&#39;: array([-2.49864416e-03, -2.49864416e-03, -2.49864416e-03, -1.01521456e-05,</span>
<span class="go">       -1.01521456e-05, -1.01521456e-05])}</span>
</pre></div>
</div>
<img alt="../_images/ts_nino.png" src="../_images/ts_nino.png" />
<img alt="../_images/ts_air.png" src="../_images/ts_air.png" />
<p>Granger causality</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [15]: </span><span class="n">caus_res</span> <span class="o">=</span> <span class="n">ts_nino</span><span class="o">.</span><span class="n">causality</span><span class="p">(</span><span class="n">ts_air</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;granger&#39;</span><span class="p">)</span>

<span class="go">Granger Causality</span>
<span class="go">number of lags (no zero) 1</span>
<span class="go">ssr based F test:         F=20.8492 , p=0.0000  , df_denom=1592, df_num=1</span>
<span class="go">ssr based chi2 test:   chi2=20.8885 , p=0.0000  , df=1</span>
<span class="go">likelihood ratio test: chi2=20.7529 , p=0.0000  , df=1</span>
<span class="go">parameter F test:         F=20.8492 , p=0.0000  , df_denom=1592, df_num=1</span>

<span class="gp">In [16]: </span><span class="nb">print</span><span class="p">(</span><span class="n">caus_res</span><span class="p">)</span>
<span class="go">{1: ({&#39;ssr_ftest&#39;: (20.849204239268076, 5.350981736047143e-06, 1592.0, 1), &#39;ssr_chi2test&#39;: (20.88849294072398, 4.868102345429935e-06, 1), &#39;lrtest&#39;: (20.752895243242165, 5.22525200803166e-06, 1), &#39;params_ftest&#39;: (20.84920423926806, 5.350981736047143e-06, 1592.0, 1.0)}, [&lt;statsmodels.regression.linear_model.RegressionResultsWrapper object at 0x1ab8d86a0&gt;, &lt;statsmodels.regression.linear_model.RegressionResultsWrapper object at 0x1ab8d8940&gt;, array([[0., 1., 0.]])])}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.Series.clean">
<span class="sig-name descname"><span class="pre">clean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#Series.clean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.Series.clean" title="Permalink to this definition"></a></dt>
<dd><p>Clean up the timeseries by removing NaNs and sort with increasing time points</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>verbose</strong> (<em>bool</em>) – If True, will print warning messages if there is any</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Series object with removed NaNs and sorting</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#pyleoclim.core.ui.Series" title="pyleoclim.core.ui.Series">Series</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.Series.convert_time_unit">
<span class="sig-name descname"><span class="pre">convert_time_unit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'years'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#Series.convert_time_unit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.Series.convert_time_unit" title="Permalink to this definition"></a></dt>
<dd><p>Convert the time unit of the Series object</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>time_unit</strong> (<em>str</em>) – <p>the target time unit, possible input:
{</p>
<blockquote>
<div><p>’year’, ‘years’, ‘yr’, ‘yrs’,
‘y BP’, ‘yr BP’, ‘yrs BP’, ‘year BP’, ‘years BP’,
‘ky BP’, ‘kyr BP’, ‘kyrs BP’, ‘ka BP’, ‘ka’,
‘my BP’, ‘myr BP’, ‘myrs BP’, ‘ma BP’, ‘ma’,</p>
</div></blockquote>
<p>}</p>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">pyleoclim</span> <span class="k">as</span> <span class="nn">pyleo</span>

<span class="gp">In [2]: </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="gp">In [3]: </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
<span class="gp">   ...: </span>    <span class="s1">&#39;https://raw.githubusercontent.com/LinkedEarth/Pyleoclim_util/Development/example_data/soi_data.csv&#39;</span><span class="p">,</span>
<span class="gp">   ...: </span>    <span class="n">skiprows</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">1</span>
<span class="gp">   ...: </span><span class="p">)</span>
<span class="gp">   ...: </span>

<span class="gp">In [4]: </span><span class="n">time</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>

<span class="gp">In [5]: </span><span class="n">value</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>

<span class="gp">In [6]: </span><span class="n">ts</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">,</span> <span class="n">time_unit</span><span class="o">=</span><span class="s1">&#39;years&#39;</span><span class="p">)</span>

<span class="gp">In [7]: </span><span class="n">new_ts</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">convert_time_unit</span><span class="p">(</span><span class="n">time_unit</span><span class="o">=</span><span class="s1">&#39;yrs BP&#39;</span><span class="p">)</span>

<span class="gp">In [8]: </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Original timeseries:&#39;</span><span class="p">)</span>
<span class="go">Original timeseries:</span>

<span class="gp">In [9]: </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;time unit:&#39;</span><span class="p">,</span> <span class="n">ts</span><span class="o">.</span><span class="n">time_unit</span><span class="p">)</span>
<span class="go">time unit: years</span>

<span class="gp">In [10]: </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;time:&#39;</span><span class="p">,</span> <span class="n">ts</span><span class="o">.</span><span class="n">time</span><span class="p">)</span>
<span class="go">time: [1951.       1951.083333 1951.166667 1951.25     1951.333333 1951.416667</span>
<span class="go"> 1951.5      1951.583333 1951.666667 1951.75     1951.833333 1951.916667</span>
<span class="go"> 1952.       1952.083333 1952.166667 1952.25     1952.333333 1952.416667</span>
<span class="go"> 1952.5      1952.583333 1952.666667 1952.75     1952.833333 1952.916667</span>
<span class="go"> 1953.       1953.083333 1953.166667 1953.25     1953.333333 1953.416667</span>
<span class="go"> 1953.5      1953.583333 1953.666667 1953.75     1953.833333 1953.916667</span>
<span class="go"> 1954.       1954.083333 1954.166667 1954.25     1954.333333 1954.416667</span>
<span class="go"> 1954.5      1954.583333 1954.666667 1954.75     1954.833333 1954.916667</span>
<span class="go"> 1955.       1955.083333 1955.166667 1955.25     1955.333333 1955.416667</span>
<span class="go"> 1955.5      1955.583333 1955.666667 1955.75     1955.833333 1955.916667</span>
<span class="go"> 1956.       1956.083333 1956.166667 1956.25     1956.333333 1956.416667</span>
<span class="go"> 1956.5      1956.583333 1956.666667 1956.75     1956.833333 1956.916667</span>
<span class="go"> 1957.       1957.083333 1957.166667 1957.25     1957.333333 1957.416667</span>
<span class="go"> 1957.5      1957.583333 1957.666667 1957.75     1957.833333 1957.916667</span>
<span class="go"> 1958.       1958.083333 1958.166667 1958.25     1958.333333 1958.416667</span>
<span class="go"> 1958.5      1958.583333 1958.666667 1958.75     1958.833333 1958.916667</span>
<span class="go"> 1959.       1959.083333 1959.166667 1959.25     1959.333333 1959.416667</span>
<span class="go"> 1959.5      1959.583333 1959.666667 1959.75     1959.833333 1959.916667</span>
<span class="go"> 1960.       1960.083333 1960.166667 1960.25     1960.333333 1960.416667</span>
<span class="go"> 1960.5      1960.583333 1960.666667 1960.75     1960.833333 1960.916667</span>
<span class="go"> 1961.       1961.083333 1961.166667 1961.25     1961.333333 1961.416667</span>
<span class="go"> 1961.5      1961.583333 1961.666667 1961.75     1961.833333 1961.916667</span>
<span class="go"> 1962.       1962.083333 1962.166667 1962.25     1962.333333 1962.416667</span>
<span class="go"> 1962.5      1962.583333 1962.666667 1962.75     1962.833333 1962.916667</span>
<span class="go"> 1963.       1963.083333 1963.166667 1963.25     1963.333333 1963.416667</span>
<span class="go"> 1963.5      1963.583333 1963.666667 1963.75     1963.833333 1963.916667</span>
<span class="go"> 1964.       1964.083333 1964.166667 1964.25     1964.333333 1964.416667</span>
<span class="go"> 1964.5      1964.583333 1964.666667 1964.75     1964.833333 1964.916667</span>
<span class="go"> 1965.       1965.083333 1965.166667 1965.25     1965.333333 1965.416667</span>
<span class="go"> 1965.5      1965.583333 1965.666667 1965.75     1965.833333 1965.916667</span>
<span class="go"> 1966.       1966.083333 1966.166667 1966.25     1966.333333 1966.416667</span>
<span class="go"> 1966.5      1966.583333 1966.666667 1966.75     1966.833333 1966.916667</span>
<span class="go"> 1967.       1967.083333 1967.166667 1967.25     1967.333333 1967.416667</span>
<span class="go"> 1967.5      1967.583333 1967.666667 1967.75     1967.833333 1967.916667</span>
<span class="go"> 1968.       1968.083333 1968.166667 1968.25     1968.333333 1968.416667</span>
<span class="go"> 1968.5      1968.583333 1968.666667 1968.75     1968.833333 1968.916667</span>
<span class="go"> 1969.       1969.083333 1969.166667 1969.25     1969.333333 1969.416667</span>
<span class="go"> 1969.5      1969.583333 1969.666667 1969.75     1969.833333 1969.916667</span>
<span class="go"> 1970.       1970.083333 1970.166667 1970.25     1970.333333 1970.416667</span>
<span class="go"> 1970.5      1970.583333 1970.666667 1970.75     1970.833333 1970.916667</span>
<span class="go"> 1971.       1971.083333 1971.166667 1971.25     1971.333333 1971.416667</span>
<span class="go"> 1971.5      1971.583333 1971.666667 1971.75     1971.833333 1971.916667</span>
<span class="go"> 1972.       1972.083333 1972.166667 1972.25     1972.333333 1972.416667</span>
<span class="go"> 1972.5      1972.583333 1972.666667 1972.75     1972.833333 1972.916667</span>
<span class="go"> 1973.       1973.083333 1973.166667 1973.25     1973.333333 1973.416667</span>
<span class="go"> 1973.5      1973.583333 1973.666667 1973.75     1973.833333 1973.916667</span>
<span class="go"> 1974.       1974.083333 1974.166667 1974.25     1974.333333 1974.416667</span>
<span class="go"> 1974.5      1974.583333 1974.666667 1974.75     1974.833333 1974.916667</span>
<span class="go"> 1975.       1975.083333 1975.166667 1975.25     1975.333333 1975.416667</span>
<span class="go"> 1975.5      1975.583333 1975.666667 1975.75     1975.833333 1975.916667</span>
<span class="go"> 1976.       1976.083333 1976.166667 1976.25     1976.333333 1976.416667</span>
<span class="go"> 1976.5      1976.583333 1976.666667 1976.75     1976.833333 1976.916667</span>
<span class="go"> 1977.       1977.083333 1977.166667 1977.25     1977.333333 1977.416667</span>
<span class="go"> 1977.5      1977.583333 1977.666667 1977.75     1977.833333 1977.916667</span>
<span class="go"> 1978.       1978.083333 1978.166667 1978.25     1978.333333 1978.416667</span>
<span class="go"> 1978.5      1978.583333 1978.666667 1978.75     1978.833333 1978.916667</span>
<span class="go"> 1979.       1979.083333 1979.166667 1979.25     1979.333333 1979.416667</span>
<span class="go"> 1979.5      1979.583333 1979.666667 1979.75     1979.833333 1979.916667</span>
<span class="go"> 1980.       1980.083333 1980.166667 1980.25     1980.333333 1980.416667</span>
<span class="go"> 1980.5      1980.583333 1980.666667 1980.75     1980.833333 1980.916667</span>
<span class="go"> 1981.       1981.083333 1981.166667 1981.25     1981.333333 1981.416667</span>
<span class="go"> 1981.5      1981.583333 1981.666667 1981.75     1981.833333 1981.916667</span>
<span class="go"> 1982.       1982.083333 1982.166667 1982.25     1982.333333 1982.416667</span>
<span class="go"> 1982.5      1982.583333 1982.666667 1982.75     1982.833333 1982.916667</span>
<span class="go"> 1983.       1983.083333 1983.166667 1983.25     1983.333333 1983.416667</span>
<span class="go"> 1983.5      1983.583333 1983.666667 1983.75     1983.833333 1983.916667</span>
<span class="go"> 1984.       1984.083333 1984.166667 1984.25     1984.333333 1984.416667</span>
<span class="go"> 1984.5      1984.583333 1984.666667 1984.75     1984.833333 1984.916667</span>
<span class="go"> 1985.       1985.083333 1985.166667 1985.25     1985.333333 1985.416667</span>
<span class="go"> 1985.5      1985.583333 1985.666667 1985.75     1985.833333 1985.916667</span>
<span class="go"> 1986.       1986.083333 1986.166667 1986.25     1986.333333 1986.416667</span>
<span class="go"> 1986.5      1986.583333 1986.666667 1986.75     1986.833333 1986.916667</span>
<span class="go"> 1987.       1987.083333 1987.166667 1987.25     1987.333333 1987.416667</span>
<span class="go"> 1987.5      1987.583333 1987.666667 1987.75     1987.833333 1987.916667</span>
<span class="go"> 1988.       1988.083333 1988.166667 1988.25     1988.333333 1988.416667</span>
<span class="go"> 1988.5      1988.583333 1988.666667 1988.75     1988.833333 1988.916667</span>
<span class="go"> 1989.       1989.083333 1989.166667 1989.25     1989.333333 1989.416667</span>
<span class="go"> 1989.5      1989.583333 1989.666667 1989.75     1989.833333 1989.916667</span>
<span class="go"> 1990.       1990.083333 1990.166667 1990.25     1990.333333 1990.416667</span>
<span class="go"> 1990.5      1990.583333 1990.666667 1990.75     1990.833333 1990.916667</span>
<span class="go"> 1991.       1991.083333 1991.166667 1991.25     1991.333333 1991.416667</span>
<span class="go"> 1991.5      1991.583333 1991.666667 1991.75     1991.833333 1991.916667</span>
<span class="go"> 1992.       1992.083333 1992.166667 1992.25     1992.333333 1992.416667</span>
<span class="go"> 1992.5      1992.583333 1992.666667 1992.75     1992.833333 1992.916667</span>
<span class="go"> 1993.       1993.083333 1993.166667 1993.25     1993.333333 1993.416667</span>
<span class="go"> 1993.5      1993.583333 1993.666667 1993.75     1993.833333 1993.916667</span>
<span class="go"> 1994.       1994.083333 1994.166667 1994.25     1994.333333 1994.416667</span>
<span class="go"> 1994.5      1994.583333 1994.666667 1994.75     1994.833333 1994.916667</span>
<span class="go"> 1995.       1995.083333 1995.166667 1995.25     1995.333333 1995.416667</span>
<span class="go"> 1995.5      1995.583333 1995.666667 1995.75     1995.833333 1995.916667</span>
<span class="go"> 1996.       1996.083333 1996.166667 1996.25     1996.333333 1996.416667</span>
<span class="go"> 1996.5      1996.583333 1996.666667 1996.75     1996.833333 1996.916667</span>
<span class="go"> 1997.       1997.083333 1997.166667 1997.25     1997.333333 1997.416667</span>
<span class="go"> 1997.5      1997.583333 1997.666667 1997.75     1997.833333 1997.916667</span>
<span class="go"> 1998.       1998.083333 1998.166667 1998.25     1998.333333 1998.416667</span>
<span class="go"> 1998.5      1998.583333 1998.666667 1998.75     1998.833333 1998.916667</span>
<span class="go"> 1999.       1999.083333 1999.166667 1999.25     1999.333333 1999.416667</span>
<span class="go"> 1999.5      1999.583333 1999.666667 1999.75     1999.833333 1999.916667</span>
<span class="go"> 2000.       2000.083333 2000.166667 2000.25     2000.333333 2000.416667</span>
<span class="go"> 2000.5      2000.583333 2000.666667 2000.75     2000.833333 2000.916667</span>
<span class="go"> 2001.       2001.083333 2001.166667 2001.25     2001.333333 2001.416667</span>
<span class="go"> 2001.5      2001.583333 2001.666667 2001.75     2001.833333 2001.916667</span>
<span class="go"> 2002.       2002.083333 2002.166667 2002.25     2002.333333 2002.416667</span>
<span class="go"> 2002.5      2002.583333 2002.666667 2002.75     2002.833333 2002.916667</span>
<span class="go"> 2003.       2003.083333 2003.166667 2003.25     2003.333333 2003.416667</span>
<span class="go"> 2003.5      2003.583333 2003.666667 2003.75     2003.833333 2003.916667</span>
<span class="go"> 2004.       2004.083333 2004.166667 2004.25     2004.333333 2004.416667</span>
<span class="go"> 2004.5      2004.583333 2004.666667 2004.75     2004.833333 2004.916667</span>
<span class="go"> 2005.       2005.083333 2005.166667 2005.25     2005.333333 2005.416667</span>
<span class="go"> 2005.5      2005.583333 2005.666667 2005.75     2005.833333 2005.916667</span>
<span class="go"> 2006.       2006.083333 2006.166667 2006.25     2006.333333 2006.416667</span>
<span class="go"> 2006.5      2006.583333 2006.666667 2006.75     2006.833333 2006.916667</span>
<span class="go"> 2007.       2007.083333 2007.166667 2007.25     2007.333333 2007.416667</span>
<span class="go"> 2007.5      2007.583333 2007.666667 2007.75     2007.833333 2007.916667</span>
<span class="go"> 2008.       2008.083333 2008.166667 2008.25     2008.333333 2008.416667</span>
<span class="go"> 2008.5      2008.583333 2008.666667 2008.75     2008.833333 2008.916667</span>
<span class="go"> 2009.       2009.083333 2009.166667 2009.25     2009.333333 2009.416667</span>
<span class="go"> 2009.5      2009.583333 2009.666667 2009.75     2009.833333 2009.916667</span>
<span class="go"> 2010.       2010.083333 2010.166667 2010.25     2010.333333 2010.416667</span>
<span class="go"> 2010.5      2010.583333 2010.666667 2010.75     2010.833333 2010.916667</span>
<span class="go"> 2011.       2011.083333 2011.166667 2011.25     2011.333333 2011.416667</span>
<span class="go"> 2011.5      2011.583333 2011.666667 2011.75     2011.833333 2011.916667</span>
<span class="go"> 2012.       2012.083333 2012.166667 2012.25     2012.333333 2012.416667</span>
<span class="go"> 2012.5      2012.583333 2012.666667 2012.75     2012.833333 2012.916667</span>
<span class="go"> 2013.       2013.083333 2013.166667 2013.25     2013.333333 2013.416667</span>
<span class="go"> 2013.5      2013.583333 2013.666667 2013.75     2013.833333 2013.916667</span>
<span class="go"> 2014.       2014.083333 2014.166667 2014.25     2014.333333 2014.416667</span>
<span class="go"> 2014.5      2014.583333 2014.666667 2014.75     2014.833333 2014.916667</span>
<span class="go"> 2015.       2015.083333 2015.166667 2015.25     2015.333333 2015.416667</span>
<span class="go"> 2015.5      2015.583333 2015.666667 2015.75     2015.833333 2015.916667</span>
<span class="go"> 2016.       2016.083333 2016.166667 2016.25     2016.333333 2016.416667</span>
<span class="go"> 2016.5      2016.583333 2016.666667 2016.75     2016.833333 2016.916667</span>
<span class="go"> 2017.       2017.083333 2017.166667 2017.25     2017.333333 2017.416667</span>
<span class="go"> 2017.5      2017.583333 2017.666667 2017.75     2017.833333 2017.916667</span>
<span class="go"> 2018.       2018.083333 2018.166667 2018.25     2018.333333 2018.416667</span>
<span class="go"> 2018.5      2018.583333 2018.666667 2018.75     2018.833333 2018.916667</span>
<span class="go"> 2019.       2019.083333 2019.166667 2019.25     2019.333333 2019.416667</span>
<span class="go"> 2019.5      2019.583333 2019.666667 2019.75     2019.833333 2019.916667]</span>

<span class="gp">In [11]: </span><span class="nb">print</span><span class="p">()</span>


<span class="gp">In [12]: </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Converted timeseries:&#39;</span><span class="p">)</span>
<span class="go">Converted timeseries:</span>

<span class="gp">In [13]: </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;time unit:&#39;</span><span class="p">,</span> <span class="n">new_ts</span><span class="o">.</span><span class="n">time_unit</span><span class="p">)</span>
<span class="go">time unit: yrs BP</span>

<span class="gp">In [14]: </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;time:&#39;</span><span class="p">,</span> <span class="n">new_ts</span><span class="o">.</span><span class="n">time</span><span class="p">)</span>
<span class="go">time: [-69.916667 -69.833333 -69.75     -69.666667 -69.583333 -69.5</span>
<span class="go"> -69.416667 -69.333333 -69.25     -69.166667 -69.083333 -69.</span>
<span class="go"> -68.916667 -68.833333 -68.75     -68.666667 -68.583333 -68.5</span>
<span class="go"> -68.416667 -68.333333 -68.25     -68.166667 -68.083333 -68.</span>
<span class="go"> -67.916667 -67.833333 -67.75     -67.666667 -67.583333 -67.5</span>
<span class="go"> -67.416667 -67.333333 -67.25     -67.166667 -67.083333 -67.</span>
<span class="go"> -66.916667 -66.833333 -66.75     -66.666667 -66.583333 -66.5</span>
<span class="go"> -66.416667 -66.333333 -66.25     -66.166667 -66.083333 -66.</span>
<span class="go"> -65.916667 -65.833333 -65.75     -65.666667 -65.583333 -65.5</span>
<span class="go"> -65.416667 -65.333333 -65.25     -65.166667 -65.083333 -65.</span>
<span class="go"> -64.916667 -64.833333 -64.75     -64.666667 -64.583333 -64.5</span>
<span class="go"> -64.416667 -64.333333 -64.25     -64.166667 -64.083333 -64.</span>
<span class="go"> -63.916667 -63.833333 -63.75     -63.666667 -63.583333 -63.5</span>
<span class="go"> -63.416667 -63.333333 -63.25     -63.166667 -63.083333 -63.</span>
<span class="go"> -62.916667 -62.833333 -62.75     -62.666667 -62.583333 -62.5</span>
<span class="go"> -62.416667 -62.333333 -62.25     -62.166667 -62.083333 -62.</span>
<span class="go"> -61.916667 -61.833333 -61.75     -61.666667 -61.583333 -61.5</span>
<span class="go"> -61.416667 -61.333333 -61.25     -61.166667 -61.083333 -61.</span>
<span class="go"> -60.916667 -60.833333 -60.75     -60.666667 -60.583333 -60.5</span>
<span class="go"> -60.416667 -60.333333 -60.25     -60.166667 -60.083333 -60.</span>
<span class="go"> -59.916667 -59.833333 -59.75     -59.666667 -59.583333 -59.5</span>
<span class="go"> -59.416667 -59.333333 -59.25     -59.166667 -59.083333 -59.</span>
<span class="go"> -58.916667 -58.833333 -58.75     -58.666667 -58.583333 -58.5</span>
<span class="go"> -58.416667 -58.333333 -58.25     -58.166667 -58.083333 -58.</span>
<span class="go"> -57.916667 -57.833333 -57.75     -57.666667 -57.583333 -57.5</span>
<span class="go"> -57.416667 -57.333333 -57.25     -57.166667 -57.083333 -57.</span>
<span class="go"> -56.916667 -56.833333 -56.75     -56.666667 -56.583333 -56.5</span>
<span class="go"> -56.416667 -56.333333 -56.25     -56.166667 -56.083333 -56.</span>
<span class="go"> -55.916667 -55.833333 -55.75     -55.666667 -55.583333 -55.5</span>
<span class="go"> -55.416667 -55.333333 -55.25     -55.166667 -55.083333 -55.</span>
<span class="go"> -54.916667 -54.833333 -54.75     -54.666667 -54.583333 -54.5</span>
<span class="go"> -54.416667 -54.333333 -54.25     -54.166667 -54.083333 -54.</span>
<span class="go"> -53.916667 -53.833333 -53.75     -53.666667 -53.583333 -53.5</span>
<span class="go"> -53.416667 -53.333333 -53.25     -53.166667 -53.083333 -53.</span>
<span class="go"> -52.916667 -52.833333 -52.75     -52.666667 -52.583333 -52.5</span>
<span class="go"> -52.416667 -52.333333 -52.25     -52.166667 -52.083333 -52.</span>
<span class="go"> -51.916667 -51.833333 -51.75     -51.666667 -51.583333 -51.5</span>
<span class="go"> -51.416667 -51.333333 -51.25     -51.166667 -51.083333 -51.</span>
<span class="go"> -50.916667 -50.833333 -50.75     -50.666667 -50.583333 -50.5</span>
<span class="go"> -50.416667 -50.333333 -50.25     -50.166667 -50.083333 -50.</span>
<span class="go"> -49.916667 -49.833333 -49.75     -49.666667 -49.583333 -49.5</span>
<span class="go"> -49.416667 -49.333333 -49.25     -49.166667 -49.083333 -49.</span>
<span class="go"> -48.916667 -48.833333 -48.75     -48.666667 -48.583333 -48.5</span>
<span class="go"> -48.416667 -48.333333 -48.25     -48.166667 -48.083333 -48.</span>
<span class="go"> -47.916667 -47.833333 -47.75     -47.666667 -47.583333 -47.5</span>
<span class="go"> -47.416667 -47.333333 -47.25     -47.166667 -47.083333 -47.</span>
<span class="go"> -46.916667 -46.833333 -46.75     -46.666667 -46.583333 -46.5</span>
<span class="go"> -46.416667 -46.333333 -46.25     -46.166667 -46.083333 -46.</span>
<span class="go"> -45.916667 -45.833333 -45.75     -45.666667 -45.583333 -45.5</span>
<span class="go"> -45.416667 -45.333333 -45.25     -45.166667 -45.083333 -45.</span>
<span class="go"> -44.916667 -44.833333 -44.75     -44.666667 -44.583333 -44.5</span>
<span class="go"> -44.416667 -44.333333 -44.25     -44.166667 -44.083333 -44.</span>
<span class="go"> -43.916667 -43.833333 -43.75     -43.666667 -43.583333 -43.5</span>
<span class="go"> -43.416667 -43.333333 -43.25     -43.166667 -43.083333 -43.</span>
<span class="go"> -42.916667 -42.833333 -42.75     -42.666667 -42.583333 -42.5</span>
<span class="go"> -42.416667 -42.333333 -42.25     -42.166667 -42.083333 -42.</span>
<span class="go"> -41.916667 -41.833333 -41.75     -41.666667 -41.583333 -41.5</span>
<span class="go"> -41.416667 -41.333333 -41.25     -41.166667 -41.083333 -41.</span>
<span class="go"> -40.916667 -40.833333 -40.75     -40.666667 -40.583333 -40.5</span>
<span class="go"> -40.416667 -40.333333 -40.25     -40.166667 -40.083333 -40.</span>
<span class="go"> -39.916667 -39.833333 -39.75     -39.666667 -39.583333 -39.5</span>
<span class="go"> -39.416667 -39.333333 -39.25     -39.166667 -39.083333 -39.</span>
<span class="go"> -38.916667 -38.833333 -38.75     -38.666667 -38.583333 -38.5</span>
<span class="go"> -38.416667 -38.333333 -38.25     -38.166667 -38.083333 -38.</span>
<span class="go"> -37.916667 -37.833333 -37.75     -37.666667 -37.583333 -37.5</span>
<span class="go"> -37.416667 -37.333333 -37.25     -37.166667 -37.083333 -37.</span>
<span class="go"> -36.916667 -36.833333 -36.75     -36.666667 -36.583333 -36.5</span>
<span class="go"> -36.416667 -36.333333 -36.25     -36.166667 -36.083333 -36.</span>
<span class="go"> -35.916667 -35.833333 -35.75     -35.666667 -35.583333 -35.5</span>
<span class="go"> -35.416667 -35.333333 -35.25     -35.166667 -35.083333 -35.</span>
<span class="go"> -34.916667 -34.833333 -34.75     -34.666667 -34.583333 -34.5</span>
<span class="go"> -34.416667 -34.333333 -34.25     -34.166667 -34.083333 -34.</span>
<span class="go"> -33.916667 -33.833333 -33.75     -33.666667 -33.583333 -33.5</span>
<span class="go"> -33.416667 -33.333333 -33.25     -33.166667 -33.083333 -33.</span>
<span class="go"> -32.916667 -32.833333 -32.75     -32.666667 -32.583333 -32.5</span>
<span class="go"> -32.416667 -32.333333 -32.25     -32.166667 -32.083333 -32.</span>
<span class="go"> -31.916667 -31.833333 -31.75     -31.666667 -31.583333 -31.5</span>
<span class="go"> -31.416667 -31.333333 -31.25     -31.166667 -31.083333 -31.</span>
<span class="go"> -30.916667 -30.833333 -30.75     -30.666667 -30.583333 -30.5</span>
<span class="go"> -30.416667 -30.333333 -30.25     -30.166667 -30.083333 -30.</span>
<span class="go"> -29.916667 -29.833333 -29.75     -29.666667 -29.583333 -29.5</span>
<span class="go"> -29.416667 -29.333333 -29.25     -29.166667 -29.083333 -29.</span>
<span class="go"> -28.916667 -28.833333 -28.75     -28.666667 -28.583333 -28.5</span>
<span class="go"> -28.416667 -28.333333 -28.25     -28.166667 -28.083333 -28.</span>
<span class="go"> -27.916667 -27.833333 -27.75     -27.666667 -27.583333 -27.5</span>
<span class="go"> -27.416667 -27.333333 -27.25     -27.166667 -27.083333 -27.</span>
<span class="go"> -26.916667 -26.833333 -26.75     -26.666667 -26.583333 -26.5</span>
<span class="go"> -26.416667 -26.333333 -26.25     -26.166667 -26.083333 -26.</span>
<span class="go"> -25.916667 -25.833333 -25.75     -25.666667 -25.583333 -25.5</span>
<span class="go"> -25.416667 -25.333333 -25.25     -25.166667 -25.083333 -25.</span>
<span class="go"> -24.916667 -24.833333 -24.75     -24.666667 -24.583333 -24.5</span>
<span class="go"> -24.416667 -24.333333 -24.25     -24.166667 -24.083333 -24.</span>
<span class="go"> -23.916667 -23.833333 -23.75     -23.666667 -23.583333 -23.5</span>
<span class="go"> -23.416667 -23.333333 -23.25     -23.166667 -23.083333 -23.</span>
<span class="go"> -22.916667 -22.833333 -22.75     -22.666667 -22.583333 -22.5</span>
<span class="go"> -22.416667 -22.333333 -22.25     -22.166667 -22.083333 -22.</span>
<span class="go"> -21.916667 -21.833333 -21.75     -21.666667 -21.583333 -21.5</span>
<span class="go"> -21.416667 -21.333333 -21.25     -21.166667 -21.083333 -21.</span>
<span class="go"> -20.916667 -20.833333 -20.75     -20.666667 -20.583333 -20.5</span>
<span class="go"> -20.416667 -20.333333 -20.25     -20.166667 -20.083333 -20.</span>
<span class="go"> -19.916667 -19.833333 -19.75     -19.666667 -19.583333 -19.5</span>
<span class="go"> -19.416667 -19.333333 -19.25     -19.166667 -19.083333 -19.</span>
<span class="go"> -18.916667 -18.833333 -18.75     -18.666667 -18.583333 -18.5</span>
<span class="go"> -18.416667 -18.333333 -18.25     -18.166667 -18.083333 -18.</span>
<span class="go"> -17.916667 -17.833333 -17.75     -17.666667 -17.583333 -17.5</span>
<span class="go"> -17.416667 -17.333333 -17.25     -17.166667 -17.083333 -17.</span>
<span class="go"> -16.916667 -16.833333 -16.75     -16.666667 -16.583333 -16.5</span>
<span class="go"> -16.416667 -16.333333 -16.25     -16.166667 -16.083333 -16.</span>
<span class="go"> -15.916667 -15.833333 -15.75     -15.666667 -15.583333 -15.5</span>
<span class="go"> -15.416667 -15.333333 -15.25     -15.166667 -15.083333 -15.</span>
<span class="go"> -14.916667 -14.833333 -14.75     -14.666667 -14.583333 -14.5</span>
<span class="go"> -14.416667 -14.333333 -14.25     -14.166667 -14.083333 -14.</span>
<span class="go"> -13.916667 -13.833333 -13.75     -13.666667 -13.583333 -13.5</span>
<span class="go"> -13.416667 -13.333333 -13.25     -13.166667 -13.083333 -13.</span>
<span class="go"> -12.916667 -12.833333 -12.75     -12.666667 -12.583333 -12.5</span>
<span class="go"> -12.416667 -12.333333 -12.25     -12.166667 -12.083333 -12.</span>
<span class="go"> -11.916667 -11.833333 -11.75     -11.666667 -11.583333 -11.5</span>
<span class="go"> -11.416667 -11.333333 -11.25     -11.166667 -11.083333 -11.</span>
<span class="go"> -10.916667 -10.833333 -10.75     -10.666667 -10.583333 -10.5</span>
<span class="go"> -10.416667 -10.333333 -10.25     -10.166667 -10.083333 -10.</span>
<span class="go">  -9.916667  -9.833333  -9.75      -9.666667  -9.583333  -9.5</span>
<span class="go">  -9.416667  -9.333333  -9.25      -9.166667  -9.083333  -9.</span>
<span class="go">  -8.916667  -8.833333  -8.75      -8.666667  -8.583333  -8.5</span>
<span class="go">  -8.416667  -8.333333  -8.25      -8.166667  -8.083333  -8.</span>
<span class="go">  -7.916667  -7.833333  -7.75      -7.666667  -7.583333  -7.5</span>
<span class="go">  -7.416667  -7.333333  -7.25      -7.166667  -7.083333  -7.</span>
<span class="go">  -6.916667  -6.833333  -6.75      -6.666667  -6.583333  -6.5</span>
<span class="go">  -6.416667  -6.333333  -6.25      -6.166667  -6.083333  -6.</span>
<span class="go">  -5.916667  -5.833333  -5.75      -5.666667  -5.583333  -5.5</span>
<span class="go">  -5.416667  -5.333333  -5.25      -5.166667  -5.083333  -5.</span>
<span class="go">  -4.916667  -4.833333  -4.75      -4.666667  -4.583333  -4.5</span>
<span class="go">  -4.416667  -4.333333  -4.25      -4.166667  -4.083333  -4.</span>
<span class="go">  -3.916667  -3.833333  -3.75      -3.666667  -3.583333  -3.5</span>
<span class="go">  -3.416667  -3.333333  -3.25      -3.166667  -3.083333  -3.</span>
<span class="go">  -2.916667  -2.833333  -2.75      -2.666667  -2.583333  -2.5</span>
<span class="go">  -2.416667  -2.333333  -2.25      -2.166667  -2.083333  -2.</span>
<span class="go">  -1.916667  -1.833333  -1.75      -1.666667  -1.583333  -1.5</span>
<span class="go">  -1.416667  -1.333333  -1.25      -1.166667  -1.083333  -1.      ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.Series.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#Series.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.Series.copy" title="Permalink to this definition"></a></dt>
<dd><p>Make a copy of the Series object</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A copy of the Series object</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#pyleoclim.core.ui.Series" title="pyleoclim.core.ui.Series">Series</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.Series.correlation">
<span class="sig-name descname"><span class="pre">correlation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timespan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">settings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">common_time_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#Series.correlation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.Series.correlation" title="Permalink to this definition"></a></dt>
<dd><p>Estimates the Pearson’s correlation and associated significance between two non IID time series</p>
<p>The significance of the correlation is assessed using one of the following methods:</p>
<ol class="arabic simple">
<li><p>‘ttest’: T-test adjusted for effective sample size.</p></li>
<li><p>‘isopersistent’: AR(1) modeling of x and y.</p></li>
<li><p>‘isospectral’: phase randomization of original inputs. (default)</p></li>
</ol>
<p>The T-test is a parametric test, hence computationally cheap but can only be performed in ideal circumstances.
The others are non-parametric, but their computational requirements scale with the number of simulations.</p>
<p>The choise of significance test and associated number of Monte-Carlo simulations are passed through the settings parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target_series</strong> (<em>pyleoclim.Series</em>) – A pyleoclim Series object</p></li>
<li><p><strong>timespan</strong> (<em>tuple</em>) – The time interval over which to perform the calculation</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) – The significance level (default: 0.05)</p></li>
<li><p><strong>settings</strong> (<em>dict</em>) – <p>Parameters for the correlation function, including:</p>
<dl class="simple">
<dt>nsim<span class="classifier">int</span></dt><dd><p>the number of simulations (default: 1000)</p>
</dd>
<dt>method<span class="classifier">str, {‘ttest’,’isopersistent’,’isospectral’ (default)}</span></dt><dd><p>method for significance testing</p>
</dd>
</dl>
</p></li>
<li><p><strong>common_time_kwargs</strong> (<em>dict</em>) – Parameters for the method <cite>MultipleSeries.common_time()</cite>. Will use interpolation by default.</p></li>
<li><p><strong>seed</strong> (<em>float</em><em> or </em><em>int</em>) – random seed for isopersistent and isospectral methods</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><strong>corr</strong> – the result object, containing</p>
<ul class="simple">
<li><dl class="simple">
<dt>r<span class="classifier">float</span></dt><dd><p>correlation coefficient</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>p<span class="classifier">float</span></dt><dd><p>the p-value</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>signif<span class="classifier">bool</span></dt><dd><p>true if significant; false otherwise
Note that signif = True if and only if p &lt;= alpha.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>alpha<span class="classifier">float</span></dt><dd><p>the significance level</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pyleoclim.ui.Corr</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="../utils/correlation/corr_sig.html#pyleoclim.utils.correlation.corr_sig" title="pyleoclim.utils.correlation.corr_sig"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.correlation.corr_sig</span></code></a></dt><dd><p>Correlation function</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p>Correlation between the Nino3.4 index and the Deasonalized All Indian Rainfall Index</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">pyleoclim</span> <span class="k">as</span> <span class="nn">pyleo</span>

<span class="gp">In [2]: </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="gp">In [3]: </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/LinkedEarth/Pyleoclim_util/Development/example_data/wtc_test_data_nino.csv&#39;</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">t</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>

<span class="gp">In [5]: </span><span class="n">air</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>

<span class="gp">In [6]: </span><span class="n">nino</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>

<span class="gp">In [7]: </span><span class="n">ts_nino</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">t</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">nino</span><span class="p">)</span>

<span class="gp">In [8]: </span><span class="n">ts_air</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">t</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">air</span><span class="p">)</span>

<span class="go"># with `nsim=20` and default `method=&#39;isospectral&#39;`</span>
<span class="go"># set an arbitrary randome seed to fix the result</span>
<span class="gp">In [9]: </span><span class="n">corr_res</span> <span class="o">=</span> <span class="n">ts_nino</span><span class="o">.</span><span class="n">correlation</span><span class="p">(</span><span class="n">ts_air</span><span class="p">,</span> <span class="n">settings</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;nsim&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">},</span> <span class="n">seed</span><span class="o">=</span><span class="mi">2333</span><span class="p">)</span>

<span class="gp">In [10]: </span><span class="nb">print</span><span class="p">(</span><span class="n">corr_res</span><span class="p">)</span>
<span class="go">  correlation  p-value    signif. (α: 0.05)</span>
<span class="go">-------------  ---------  -------------------</span>
<span class="go">    -0.152394  &lt; 1e-6     True</span>


<span class="go"># using a simple t-test</span>
<span class="go"># set an arbitrary randome seed to fix the result</span>
<span class="gp">In [11]: </span><span class="n">corr_res</span> <span class="o">=</span> <span class="n">ts_nino</span><span class="o">.</span><span class="n">correlation</span><span class="p">(</span><span class="n">ts_air</span><span class="p">,</span> <span class="n">settings</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;nsim&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="s1">&#39;method&#39;</span><span class="p">:</span> <span class="s1">&#39;ttest&#39;</span><span class="p">},</span> <span class="n">seed</span><span class="o">=</span><span class="mi">2333</span><span class="p">)</span>

<span class="gp">In [12]: </span><span class="nb">print</span><span class="p">(</span><span class="n">corr_res</span><span class="p">)</span>
<span class="go">  correlation  p-value    signif. (α: 0.05)</span>
<span class="go">-------------  ---------  -------------------</span>
<span class="go">    -0.152394  &lt; 1e-7     True</span>


<span class="go"># using the method &quot;isopersistent&quot;</span>
<span class="go"># set an arbitrary random seed to fix the result</span>
<span class="gp">In [13]: </span><span class="n">corr_res</span> <span class="o">=</span> <span class="n">ts_nino</span><span class="o">.</span><span class="n">correlation</span><span class="p">(</span><span class="n">ts_air</span><span class="p">,</span> <span class="n">settings</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;nsim&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="s1">&#39;method&#39;</span><span class="p">:</span> <span class="s1">&#39;isopersistent&#39;</span><span class="p">},</span> <span class="n">seed</span><span class="o">=</span><span class="mi">2333</span><span class="p">)</span>

<span class="gp">In [14]: </span><span class="nb">print</span><span class="p">(</span><span class="n">corr_res</span><span class="p">)</span>
<span class="go">  correlation  p-value    signif. (α: 0.05)</span>
<span class="go">-------------  ---------  -------------------</span>
<span class="go">    -0.152394  &lt; 1e-4     True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.Series.detrend">
<span class="sig-name descname"><span class="pre">detrend</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'emd'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#Series.detrend"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.Series.detrend" title="Permalink to this definition"></a></dt>
<dd><p>Detrend Series object</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method</strong> (<em>str</em><em>, </em><em>optional</em>) – <p>The method for detrending. The default is ‘emd’.
Options include:</p>
<blockquote>
<div><ul>
<li><p>linear: the result of a linear least-squares fit to y is subtracted from y.</p></li>
<li><p>constant: only the mean of data is subtrated.</p></li>
<li><p>”savitzky-golay”, y is filtered using the Savitzky-Golay filters and the resulting filtered series is subtracted from y.</p></li>
<li><p>”emd” (default): Empirical mode decomposition. The last mode is assumed to be the trend and removed from the series</p></li>
</ul>
</div></blockquote>
</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>) – Relevant arguments for each of the methods.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>new</strong> – Detrended Series object</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pyleoclim.Series</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="../utils/tsutils/detrend.html#pyleoclim.utils.tsutils.detrend" title="pyleoclim.utils.tsutils.detrend"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.tsutils.detrend</span></code></a></dt><dd><p>detrending wrapper functions</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p>We will generate a random signal and use the different detrending functions</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">pyleoclim</span> <span class="k">as</span> <span class="nn">pyleo</span>

<span class="gp">In [2]: </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="go"># Generate a mixed signal with known frequencies</span>
<span class="gp">In [3]: </span><span class="n">freqs</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="mi">20</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">80</span><span class="p">]</span>

<span class="gp">In [4]: </span><span class="n">time</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2001</span><span class="p">)</span>

<span class="gp">In [5]: </span><span class="n">signals</span><span class="o">=</span><span class="p">[]</span>

<span class="gp">In [6]: </span><span class="k">for</span> <span class="n">freq</span> <span class="ow">in</span> <span class="n">freqs</span><span class="p">:</span>
<span class="gp">   ...: </span>    <span class="n">signals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">freq</span><span class="o">*</span><span class="n">time</span><span class="p">))</span>
<span class="gp">   ...: </span>

<span class="gp">In [7]: </span><span class="n">signal</span><span class="o">=</span><span class="nb">sum</span><span class="p">(</span><span class="n">signals</span><span class="p">)</span>

<span class="go"># Add a non-linear trend</span>
<span class="gp">In [8]: </span><span class="n">slope</span> <span class="o">=</span> <span class="mf">1e-5</span>

<span class="gp">In [9]: </span><span class="n">intercept</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

<span class="gp">In [10]: </span><span class="n">nonlinear_trend</span> <span class="o">=</span> <span class="n">slope</span><span class="o">*</span><span class="n">time</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">intercept</span>

<span class="gp">In [11]: </span><span class="n">signal_trend</span> <span class="o">=</span> <span class="n">signal</span> <span class="o">+</span> <span class="n">nonlinear_trend</span>

<span class="go"># Add white noise</span>
<span class="gp">In [12]: </span><span class="n">sig_var</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">signal</span><span class="p">)</span>

<span class="gp">In [13]: </span><span class="n">noise_var</span> <span class="o">=</span> <span class="n">sig_var</span> <span class="o">/</span> <span class="mi">2</span> <span class="c1">#signal is twice the size of noise</span>

<span class="gp">In [14]: </span><span class="n">white_noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">noise_var</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">signal</span><span class="p">))</span>

<span class="gp">In [15]: </span><span class="n">signal_noise</span> <span class="o">=</span> <span class="n">signal_trend</span> <span class="o">+</span> <span class="n">white_noise</span>

<span class="go"># Create a series object</span>
<span class="gp">In [16]: </span><span class="n">ts</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="n">signal_noise</span><span class="p">)</span>

<span class="gp">In [17]: </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Timeseries with nonlinear trend&#39;</span><span class="p">)</span>
<span class="go">&lt;Figure size 1000x400 with 1 Axes&gt;</span>

<span class="gp">In [18]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">closefig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>

<span class="go"># kStandardize</span>
<span class="gp">In [19]: </span><span class="n">ts_std</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">standardize</span><span class="p">()</span>

<span class="go"># Detrend using EMD</span>
<span class="gp">In [20]: </span><span class="n">ts_emd</span> <span class="o">=</span> <span class="n">ts_std</span><span class="o">.</span><span class="n">detrend</span><span class="p">()</span>

<span class="gp">In [21]: </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ts_emd</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Detrended with EMD method&#39;</span><span class="p">)</span>
<span class="go">&lt;Figure size 1000x400 with 1 Axes&gt;</span>

<span class="gp">In [22]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">closefig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>

<span class="go"># Detrend using Savitzky-Golay filter</span>
<span class="gp">In [23]: </span><span class="n">ts_sg</span> <span class="o">=</span> <span class="n">ts_std</span><span class="o">.</span><span class="n">detrend</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;savitzky-golay&#39;</span><span class="p">)</span>

<span class="gp">In [24]: </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ts_sg</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Detrended with Savitzky-Golay filter&#39;</span><span class="p">)</span>
<span class="go">&lt;Figure size 1000x400 with 1 Axes&gt;</span>

<span class="gp">In [25]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">closefig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/random_series.png" src="../_images/random_series.png" />
<img alt="../_images/ts_emd.png" src="../_images/ts_emd.png" />
<img alt="../_images/ts_sg.png" src="../_images/ts_sg.png" />
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.Series.distplot">
<span class="sig-name descname"><span class="pre">distplot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[10,</span> <span class="pre">4]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savefig_settings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'KDE'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vertical</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edgecolor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'w'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">plot_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#Series.distplot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.Series.distplot" title="Permalink to this definition"></a></dt>
<dd><p>Plot the distribution of the timeseries values</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>list</em>) – a list of two integers indicating the figure size</p></li>
<li><p><strong>title</strong> (<em>str</em>) – the title for the figure</p></li>
<li><p><strong>savefig_settings</strong> (<em>dict</em>) – <dl class="simple">
<dt>the dictionary of arguments for plt.savefig(); some notes below:</dt><dd><ul>
<li><p>”path” must be specified; it can be any existed or non-existed path,
with or without a suffix; if the suffix is not given in “path”, it will follow “format”</p></li>
<li><p>”format” can be one of {“pdf”, “eps”, “png”, “ps”}</p></li>
</ul>
</dd>
</dl>
</p></li>
<li><p><strong>ax</strong> (<em>matplotlib.axis</em><em>, </em><em>optional</em>) – A matplotlib axis</p></li>
<li><p><strong>ylabel</strong> (<em>str</em>) – Label for the count axis</p></li>
<li><p><strong>vertical</strong> (<em>{True</em><em>,</em><em>False}</em>) – Whether to flip the plot vertically</p></li>
<li><p><strong>edgecolor</strong> (<em>matplotlib.color</em>) – The color of the edges of the bar</p></li>
<li><p><strong>mute</strong> (<em>{True</em><em>,</em><em>False}</em>) – if True, the plot will not show;
recommend to turn on when more modifications are going to be made on ax</p></li>
<li><p><strong>plot_kwargs</strong> (<em>dict</em>) – Plotting arguments for seaborn histplot: <a class="reference external" href="https://seaborn.pydata.org/generated/seaborn.histplot.html">https://seaborn.pydata.org/generated/seaborn.histplot.html</a></p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="../utils/plotting/savefig.html#pyleoclim.utils.plotting.savefig" title="pyleoclim.utils.plotting.savefig"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.plotting.savefig</span></code></a></dt><dd><p>saving figure in Pyleoclim</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p>Distribution of the SOI record</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">pyleoclim</span> <span class="k">as</span> <span class="nn">pyleo</span>

<span class="gp">In [2]: </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="gp">In [3]: </span><span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/LinkedEarth/Pyleoclim_util/Development/example_data/soi_data.csv&#39;</span><span class="p">,</span><span class="n">skiprows</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">time</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>

<span class="gp">In [5]: </span><span class="n">value</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>

<span class="gp">In [6]: </span><span class="n">ts</span><span class="o">=</span><span class="n">pyleo</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">,</span><span class="n">time_name</span><span class="o">=</span><span class="s1">&#39;Year C.E&#39;</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s1">&#39;SOI&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;SOI&#39;</span><span class="p">)</span>

<span class="gp">In [7]: </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="go">&lt;Figure size 1000x400 with 1 Axes&gt;</span>

<span class="gp">In [8]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">closefig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>

<span class="gp">In [9]: </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">distplot</span><span class="p">()</span>
<span class="go">&lt;Figure size 1000x400 with 1 Axes&gt;</span>

<span class="gp">In [10]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">closefig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/ts_plot5.png" src="../_images/ts_plot5.png" />
<img alt="../_images/ts_dist.png" src="../_images/ts_dist.png" />
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.Series.fill_na">
<span class="sig-name descname"><span class="pre">fill_na</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timespan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#Series.fill_na"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.Series.fill_na" title="Permalink to this definition"></a></dt>
<dd><p>Fill NaNs into the timespan</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>timespan</strong> (<em>tuple</em><em> or </em><em>list</em>) – The list of time points for slicing, whose length must be 2.
For example, if timespan = [a, b], then the sliced output includes one segment [a, b].
If None, will use the start point and end point of the original timeseries</p></li>
<li><p><strong>dt</strong> (<em>float</em>) – The time spacing to fill the NaNs; default is 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>new</strong> – The sliced Series object.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#pyleoclim.core.ui.Series" title="pyleoclim.core.ui.Series">Series</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.Series.filter">
<span class="sig-name descname"><span class="pre">filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cutoff_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'butterworth'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#Series.filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.Series.filter" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Filtering methods for Series objects using four possible methods:</dt><dd><ul class="simple">
<li><p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.butter.html">Butterworth</a></p></li>
<li><p><a class="reference external" href="http://scitools.org.uk/iris/docs/v1.2/examples/graphics/SOI_filtering.html">Lanczos</a></p></li>
<li><p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.firwin.html">Finite Impulse Response</a></p></li>
<li><p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.savgol_filter.html">Savitzky-Golay filter</a></p></li>
</ul>
</dd>
</dl>
<p>By default, this method implements a lowpass filter, though it can easily be turned into a bandpass or high-pass filter (see examples below).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method</strong> (<em>str</em><em>, </em><em>{'savitzky-golay'</em><em>, </em><em>'butterworth'</em><em>, </em><em>'firwin'</em><em>, </em><em>'lanczos'}</em>) – the filtering method
- ‘butterworth’: a Butterworth filter (default = 3rd order)
- ‘savitzky-golay’: Savitzky-Golay filter
- ‘firwin’: finite impulse response filter design using the window method, with default window as Hamming
- ‘lanczos’: Lanczos zero-phase filter</p></li>
<li><p><strong>cutoff_freq</strong> (<em>float</em><em> or </em><em>list</em>) – The cutoff frequency only works with the Butterworth method.
If a float, it is interpreted as a low-frequency cutoff (lowpass).
If a list,  it is interpreted as a frequency band (f1, f2), with f1 &lt; f2 (bandpass).
Note that only the Butterworth option (default) currently supports bandpass filtering.</p></li>
<li><p><strong>cutoff_scale</strong> (<em>float</em><em> or </em><em>list</em>) – cutoff_freq = 1 / cutoff_scale
The cutoff scale only works with the Butterworth method and when cutoff_freq is None.
If a float, it is interpreted as a low-frequency (high-scale) cutoff (lowpass).
If a list,  it is interpreted as a frequency band (f1, f2), with f1 &lt; f2 (bandpass).</p></li>
<li><p><strong>kwargs</strong> (<em>dict</em>) – a dictionary of the keyword arguments for the filtering method,
see <cite>pyleoclim.utils.filter.savitzky_golay</cite>, <cite>pyleoclim.utils.filter.butterworth</cite>, <cite>pyleoclim.utils.filter.lanczos</cite> and <cite>pyleoclim.utils.filter.firwin</cite> for the details</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>new</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pyleoclim.Series</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="../utils/filter/butterworth.html#pyleoclim.utils.filter.butterworth" title="pyleoclim.utils.filter.butterworth"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.filter.butterworth</span></code></a></dt><dd><p>Butterworth method</p>
</dd>
<dt><a class="reference internal" href="../utils/filter/savitzky_golay.html#pyleoclim.utils.filter.savitzky_golay" title="pyleoclim.utils.filter.savitzky_golay"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.filter.savitzky_golay</span></code></a></dt><dd><p>Savitzky-Golay method</p>
</dd>
<dt><a class="reference internal" href="../utils/filter/firwin.html#pyleoclim.utils.filter.firwin" title="pyleoclim.utils.filter.firwin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.filter.firwin</span></code></a></dt><dd><p>FIR filter design using the window method</p>
</dd>
<dt><a class="reference internal" href="../utils/filter/lanczos.html#pyleoclim.utils.filter.lanczos" title="pyleoclim.utils.filter.lanczos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.filter.lanczos</span></code></a></dt><dd><p>lowpass filter via Lanczos resampling</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p>In the example below, we generate a signal as the sum of two signals with frequency 10 Hz and 20 Hz, respectively.
Then we apply a low-pass filter with a cutoff frequency at 15 Hz, and compare the output to the signal of 10 Hz.
After that, we apply a band-pass filter with the band 15-25 Hz, and compare the outcome to the signal of 20 Hz.</p>
<ul class="simple">
<li><p>Generating the test data</p></li>
</ul>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">pyleoclim</span> <span class="k">as</span> <span class="nn">pyleo</span>

<span class="gp">In [2]: </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="gp">In [3]: </span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">sig1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">10</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>

<span class="gp">In [5]: </span><span class="n">sig2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mi">20</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>

<span class="gp">In [6]: </span><span class="n">sig</span> <span class="o">=</span> <span class="n">sig1</span> <span class="o">+</span> <span class="n">sig2</span>

<span class="gp">In [7]: </span><span class="n">ts1</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">t</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">sig1</span><span class="p">)</span>

<span class="gp">In [8]: </span><span class="n">ts2</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">t</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">sig2</span><span class="p">)</span>

<span class="gp">In [9]: </span><span class="n">ts</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">t</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">sig</span><span class="p">)</span>

<span class="gp">In [10]: </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mute</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;mix&#39;</span><span class="p">)</span>

<span class="gp">In [11]: </span><span class="n">ts1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;10 Hz&#39;</span><span class="p">)</span>
<span class="gh">Out[11]: </span><span class="go">&lt;AxesSubplot:xlabel=&#39;time&#39;, ylabel=&#39;value&#39;&gt;</span>

<span class="gp">In [12]: </span><span class="n">ts2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;20 Hz&#39;</span><span class="p">)</span>
<span class="gh">Out[12]: </span><span class="go">&lt;AxesSubplot:xlabel=&#39;time&#39;, ylabel=&#39;value&#39;&gt;</span>

<span class="gp">In [13]: </span><span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">),</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gh">Out[13]: </span><span class="go">&lt;matplotlib.legend.Legend at 0x1abe42940&gt;</span>

<span class="gp">In [14]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">showfig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
<span class="go">&lt;Figure size 1000x400 with 1 Axes&gt;</span>

<span class="gp">In [15]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">closefig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/ts_filter1.png" src="../_images/ts_filter1.png" />
<ul class="simple">
<li><p>Applying a low-pass filter</p></li>
</ul>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [16]: </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mute</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;mix&#39;</span><span class="p">)</span>

<span class="gp">In [17]: </span><span class="n">ts</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">cutoff_freq</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;After 15 Hz low-pass filter&#39;</span><span class="p">)</span>
<span class="gh">Out[17]: </span><span class="go">&lt;AxesSubplot:xlabel=&#39;time&#39;, ylabel=&#39;value&#39;&gt;</span>

<span class="gp">In [18]: </span><span class="n">ts1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;10 Hz&#39;</span><span class="p">)</span>
<span class="gh">Out[18]: </span><span class="go">&lt;AxesSubplot:xlabel=&#39;time&#39;, ylabel=&#39;value&#39;&gt;</span>

<span class="gp">In [19]: </span><span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">),</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gh">Out[19]: </span><span class="go">&lt;matplotlib.legend.Legend at 0x1abec3e80&gt;</span>

<span class="gp">In [20]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">showfig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
<span class="go">&lt;Figure size 1000x400 with 1 Axes&gt;</span>

<span class="gp">In [21]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">closefig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/ts_filter2.png" src="../_images/ts_filter2.png" />
<ul class="simple">
<li><p>Applying a band-pass filter</p></li>
</ul>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [22]: </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mute</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;mix&#39;</span><span class="p">)</span>

<span class="gp">In [23]: </span><span class="n">ts</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">cutoff_freq</span><span class="o">=</span><span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">25</span><span class="p">])</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;After 15-25 Hz band-pass filter&#39;</span><span class="p">)</span>
<span class="gh">Out[23]: </span><span class="go">&lt;AxesSubplot:xlabel=&#39;time&#39;, ylabel=&#39;value&#39;&gt;</span>

<span class="gp">In [24]: </span><span class="n">ts2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;20 Hz&#39;</span><span class="p">)</span>
<span class="gh">Out[24]: </span><span class="go">&lt;AxesSubplot:xlabel=&#39;time&#39;, ylabel=&#39;value&#39;&gt;</span>

<span class="gp">In [25]: </span><span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">),</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gh">Out[25]: </span><span class="go">&lt;matplotlib.legend.Legend at 0x1abf4bb20&gt;</span>

<span class="gp">In [26]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">showfig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
<span class="go">&lt;Figure size 1000x400 with 1 Axes&gt;</span>

<span class="gp">In [27]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">closefig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/ts_filter3.png" src="../_images/ts_filter3.png" />
<p>Above is using the default Butterworth filtering. To use FIR filtering with a window like Hanning is also simple:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [28]: </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mute</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;mix&#39;</span><span class="p">)</span>

<span class="gp">In [29]: </span><span class="n">ts</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">cutoff_freq</span><span class="o">=</span><span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">25</span><span class="p">],</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;firwin&#39;</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s1">&#39;hanning&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;After 15-25 Hz band-pass filter&#39;</span><span class="p">)</span>
<span class="gh">Out[29]: </span><span class="go">&lt;AxesSubplot:xlabel=&#39;time&#39;, ylabel=&#39;value&#39;&gt;</span>

<span class="gp">In [30]: </span><span class="n">ts2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;20 Hz&#39;</span><span class="p">)</span>
<span class="gh">Out[30]: </span><span class="go">&lt;AxesSubplot:xlabel=&#39;time&#39;, ylabel=&#39;value&#39;&gt;</span>

<span class="gp">In [31]: </span><span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">),</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gh">Out[31]: </span><span class="go">&lt;matplotlib.legend.Legend at 0x1abfcf3a0&gt;</span>

<span class="gp">In [32]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">showfig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
<span class="go">&lt;Figure size 1000x400 with 1 Axes&gt;</span>

<span class="gp">In [33]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">closefig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/ts_filter4.png" src="../_images/ts_filter4.png" />
<ul class="simple">
<li><p>Applying a high-pass filter</p></li>
</ul>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [34]: </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mute</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;mix&#39;</span><span class="p">)</span>

<span class="gp">In [35]: </span><span class="n">ts_low</span>  <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">cutoff_freq</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

<span class="gp">In [36]: </span><span class="n">ts_high</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="gp">In [37]: </span><span class="n">ts_high</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">value</span> <span class="o">-</span> <span class="n">ts_low</span><span class="o">.</span><span class="n">value</span> <span class="c1"># subtract low-pass filtered series from original one</span>

<span class="gp">In [38]: </span><span class="n">ts_high</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;High-pass filter @ 15Hz&#39;</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="gh">Out[38]: </span><span class="go">&lt;AxesSubplot:xlabel=&#39;time&#39;, ylabel=&#39;value&#39;&gt;</span>

<span class="gp">In [39]: </span><span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">),</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gh">Out[39]: </span><span class="go">&lt;matplotlib.legend.Legend at 0x1b4079b80&gt;</span>

<span class="gp">In [40]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">showfig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
<span class="go">&lt;Figure size 1000x400 with 1 Axes&gt;</span>

<span class="gp">In [41]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">closefig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/ts_filter5.png" src="../_images/ts_filter5.png" />
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.Series.gaussianize">
<span class="sig-name descname"><span class="pre">gaussianize</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#Series.gaussianize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.Series.gaussianize" title="Permalink to this definition"></a></dt>
<dd><p>Gaussianizes the timeseries</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>new</strong> – The Gaussianized series object</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>pyleoclim.Series</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.Series.gkernel">
<span class="sig-name descname"><span class="pre">gkernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'median'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#Series.gkernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.Series.gkernel" title="Permalink to this definition"></a></dt>
<dd><p>Coarse-grain a Series object via a Gaussian kernel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step_type</strong> (<em>str</em>) – type of timestep: ‘mean’, ‘median’, or ‘max’ of the time increments</p></li>
<li><p><strong>kwargs</strong> – Arguments for kernel function. See pyleoclim.utils.tsutils.gkernel for details</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>new</strong> – The coarse-grained Series object</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pyleoclim.Series</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="../utils/tsutils/gkernel.html#pyleoclim.utils.tsutils.gkernel" title="pyleoclim.utils.tsutils.gkernel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.tsutils.gkernel</span></code></a></dt><dd><p>application of a Gaussian kernel</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.Series.interp">
<span class="sig-name descname"><span class="pre">interp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#Series.interp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.Series.interp" title="Permalink to this definition"></a></dt>
<dd><p>Interpolate a Series object onto a new time axis</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method</strong> (<em>{‘linear’</em><em>, </em><em>‘nearest’</em><em>, </em><em>‘zero’</em><em>, </em><em>‘slinear’</em><em>, </em><em>‘quadratic’</em><em>, </em><em>‘cubic’</em><em>, </em><em>‘previous’</em><em>, </em><em>‘next’}</em>) – where ‘zero’, ‘slinear’, ‘quadratic’ and ‘cubic’ refer to a spline interpolation of zeroth, first, second or third order; ‘previous’ and ‘next’ simply return the previous or next value of the point) or as an integer specifying the order of the spline interpolator to use. Default is ‘linear’.</p></li>
<li><p><strong>kwargs</strong> – Arguments specific to each interpolation function. See pyleoclim.utils.tsutils.interp for details</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>new</strong> – An interpolated Series object</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pyleoclim.Series</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="../utils/tsutils/interp.html#pyleoclim.utils.tsutils.interp" title="pyleoclim.utils.tsutils.interp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.tsutils.interp</span></code></a></dt><dd><p>interpolation function</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.Series.is_evenly_spaced">
<span class="sig-name descname"><span class="pre">is_evenly_spaced</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#Series.is_evenly_spaced"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.Series.is_evenly_spaced" title="Permalink to this definition"></a></dt>
<dd><p>Check if the Series time axis is evenly-spaced, within tolerance</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>res</strong></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.Series.make_labels">
<span class="sig-name descname"><span class="pre">make_labels</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#Series.make_labels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.Series.make_labels" title="Permalink to this definition"></a></dt>
<dd><p>Initialization of labels</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>time_header</strong> (<em>str</em>) – Label for the time axis</p></li>
<li><p><strong>value_header</strong> (<em>str</em>) – Label for the value axis</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.Series.outliers">
<span class="sig-name descname"><span class="pre">outliers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">auto</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_outliers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_knee</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_outliers_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_knee_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[10,</span> <span class="pre">4]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveknee_settings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveoutliers_settings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#Series.outliers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.Series.outliers" title="Permalink to this definition"></a></dt>
<dd><p>Detects outliers in a timeseries and removes if specified</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>auto</strong> (<em>boolean</em>) – True by default, detects knee in the plot automatically</p></li>
<li><p><strong>remove</strong> (<em>boolean</em>) – True by default, removes all outlier points if detected</p></li>
<li><p><strong>fig_knee</strong> (<em>boolean</em>) – True by default, plots knee plot if true</p></li>
<li><p><strong>fig_outliers</strong> (<em>boolean</em>) – True by degault, plots outliers if true</p></li>
<li><p><strong>save_knee</strong> (<em>dict</em>) – default parameters from matplotlib savefig None by default</p></li>
<li><p><strong>save_outliers</strong> (<em>dict</em>) – default parameters from matplotlib savefig None by default</p></li>
<li><p><strong>plot_knee_kwargs</strong> (<em>dict</em>) – arguments for the knee plot</p></li>
<li><p><strong>plot_outliers_kwargs</strong> (<em>dict</em>) – arguments for the outliers plot</p></li>
<li><p><strong>figsize</strong> (<em>list</em>) – by default [10,4]</p></li>
<li><p><strong>mute</strong> (<em>{True</em><em>,</em><em>False}</em>) – if True, the plot will not show;
recommend to turn on when more modifications are going to be made on ax</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>new</strong> – Time series with outliers removed if they exist</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#pyleoclim.core.ui.Series" title="pyleoclim.core.ui.Series">Series</a></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="../utils/tsutils/remove_outliers.html#pyleoclim.utils.tsutils.remove_outliers" title="pyleoclim.utils.tsutils.remove_outliers"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.tsutils.remove_outliers</span></code></a></dt><dd><p>remove outliers function</p>
</dd>
<dt><a class="reference internal" href="../utils/plotting/plot_xy.html#pyleoclim.utils.plotting.plot_xy" title="pyleoclim.utils.plotting.plot_xy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.plotting.plot_xy</span></code></a></dt><dd><p>basic x-y plot</p>
</dd>
<dt><a class="reference internal" href="../utils/plotting/plot_scatter_xy.html#pyleoclim.utils.plotting.plot_scatter_xy" title="pyleoclim.utils.plotting.plot_scatter_xy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.plotting.plot_scatter_xy</span></code></a></dt><dd><p>Scatter plot on top of a line plot</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.Series.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[10,</span> <span class="pre">4]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marker</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">markersize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linestyle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lgd_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savefig_settings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">invert_xaxis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#Series.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.Series.plot" title="Permalink to this definition"></a></dt>
<dd><p>Plot the timeseries</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>list</em>) – a list of two integers indicating the figure size</p></li>
<li><p><strong>marker</strong> (<em>str</em>) – e.g., ‘o’ for dots
See [matplotlib.markers](<a class="reference external" href="https://matplotlib.org/3.1.3/api/markers_api.html">https://matplotlib.org/3.1.3/api/markers_api.html</a>) for details</p></li>
<li><p><strong>markersize</strong> (<em>float</em>) – the size of the marker</p></li>
<li><p><strong>color</strong> (<em>str</em><em>, </em><em>list</em>) – the color for the line plot
e.g., ‘r’ for red
See [matplotlib colors] (<a class="reference external" href="https://matplotlib.org/3.2.1/tutorials/colors/colors.html">https://matplotlib.org/3.2.1/tutorials/colors/colors.html</a>) for details</p></li>
<li><p><strong>linestyle</strong> (<em>str</em>) – e.g., ‘–’ for dashed line
See [matplotlib.linestyles](<a class="reference external" href="https://matplotlib.org/3.1.0/gallery/lines_bars_and_markers/linestyles.html">https://matplotlib.org/3.1.0/gallery/lines_bars_and_markers/linestyles.html</a>) for details</p></li>
<li><p><strong>linewidth</strong> (<em>float</em>) – the width of the line</p></li>
<li><p><strong>label</strong> (<em>str</em>) – the label for the line</p></li>
<li><p><strong>xlabel</strong> (<em>str</em>) – the label for the x-axis</p></li>
<li><p><strong>ylabel</strong> (<em>str</em>) – the label for the y-axis</p></li>
<li><p><strong>title</strong> (<em>str</em>) – the title for the figure</p></li>
<li><p><strong>zorder</strong> (<em>int</em>) – The default drawing order for all lines on the plot</p></li>
<li><p><strong>legend</strong> (<em>{True</em><em>, </em><em>False}</em>) – plot legend or not</p></li>
<li><p><strong>invert_xaxis</strong> (<em>bool</em><em>, </em><em>optional</em>) – if True, the x-axis of the plot will be inverted</p></li>
<li><p><strong>plot_kwargs</strong> (<em>dict</em>) – the dictionary of keyword arguments for ax.plot()
See [matplotlib.pyplot.plot](<a class="reference external" href="https://matplotlib.org/3.1.3/api/_as_gen/matplotlib.pyplot.plot.html">https://matplotlib.org/3.1.3/api/_as_gen/matplotlib.pyplot.plot.html</a>) for details</p></li>
<li><p><strong>lgd_kwargs</strong> (<em>dict</em>) – the dictionary of keyword arguments for ax.legend()
See [matplotlib.pyplot.legend](<a class="reference external" href="https://matplotlib.org/3.1.3/api/_as_gen/matplotlib.pyplot.legend.html">https://matplotlib.org/3.1.3/api/_as_gen/matplotlib.pyplot.legend.html</a>) for details</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) – Transparency setting</p></li>
<li><p><strong>savefig_settings</strong> (<em>dict</em>) – <p>the dictionary of arguments for plt.savefig(); some notes below:
- “path” must be specified; it can be any existed or non-existed path,</p>
<blockquote>
<div><p>with or without a suffix; if the suffix is not given in “path”, it will follow “format”</p>
</div></blockquote>
<ul>
<li><p>”format” can be one of {“pdf”, “eps”, “png”, “ps”}</p></li>
</ul>
</p></li>
<li><p><strong>ax</strong> (<em>matplotlib.axis</em><em>, </em><em>optional</em>) – the axis object from matplotlib
See [matplotlib.axes](<a class="reference external" href="https://matplotlib.org/api/axes_api.html">https://matplotlib.org/api/axes_api.html</a>) for details.</p></li>
<li><p><strong>mute</strong> (<em>{True</em><em>,</em><em>False}</em>) – if True, the plot will not show;
recommend to turn on when more modifications are going to be made on ax</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>fig</strong> (<em>matplotlib.figure</em>) – the figure object from matplotlib
See [matplotlib.pyplot.figure](<a class="reference external" href="https://matplotlib.org/3.1.1/api/_as_gen/matplotlib.pyplot.figure.html">https://matplotlib.org/3.1.1/api/_as_gen/matplotlib.pyplot.figure.html</a>) for details.</p></li>
<li><p><strong>ax</strong> (<em>matplotlib.axis</em>) – the axis object from matplotlib
See [matplotlib.axes](<a class="reference external" href="https://matplotlib.org/api/axes_api.html">https://matplotlib.org/api/axes_api.html</a>) for details.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>When <cite>ax</cite> is passed, the return will be <cite>ax</cite> only; otherwise, both <cite>fig</cite> and <cite>ax</cite> will be returned.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="../utils/plotting/savefig.html#pyleoclim.utils.plotting.savefig" title="pyleoclim.utils.plotting.savefig"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.plotting.savefig</span></code></a></dt><dd><p>saving figure in Pyleoclim</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p>Plot the SOI record</p>
<blockquote>
<div><div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">pyleoclim</span> <span class="k">as</span> <span class="nn">pyleo</span>

<span class="gp">In [2]: </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="gp">In [3]: </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/LinkedEarth/Pyleoclim_util/Development/example_data/soi_data.csv&#39;</span><span class="p">,</span><span class="n">skiprows</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">time</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>

<span class="gp">In [5]: </span><span class="n">value</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>

<span class="gp">In [6]: </span><span class="n">ts</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">,</span><span class="n">time_name</span><span class="o">=</span><span class="s1">&#39;Year C.E&#39;</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s1">&#39;SOI&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;SOI&#39;</span><span class="p">)</span>

<span class="gp">In [7]: </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="go">&lt;Figure size 1000x400 with 1 Axes&gt;</span>

<span class="gp">In [8]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">closefig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/ts_plot.png" src="../_images/ts_plot.png" />
</div></blockquote>
<p>Change the line color</p>
<blockquote>
<div><div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [9]: </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="go">&lt;Figure size 1000x400 with 1 Axes&gt;</span>

<span class="gp">In [10]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">closefig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/ts_plot2.png" src="../_images/ts_plot2.png" />
</div></blockquote>
<dl>
<dt>Save the figure. Two options available:</dt><dd><ul class="simple">
<li><p>Within the plotting command</p></li>
<li><p>After the figure has been generated</p></li>
</ul>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [11]: </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">savefig_settings</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;path&#39;</span><span class="p">:</span> <span class="s1">&#39;ts_plot3.png&#39;</span><span class="p">})</span>
<span class="go">Figure saved at: &quot;ts_plot3.png&quot;</span>

<span class="gp">In [12]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">path</span><span class="o">=</span><span class="s1">&#39;ts_plot3.png&#39;</span><span class="p">)</span>
<span class="go">Figure saved at: &quot;ts_plot3.png&quot;</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.Series.segment">
<span class="sig-name descname"><span class="pre">segment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#Series.segment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.Series.segment" title="Permalink to this definition"></a></dt>
<dd><p>Gap detection</p>
<dl class="simple">
<dt>This function segments a timeseries into n number of parts following a gap</dt><dd><p>detection algorithm. The rule of gap detection is very simple:
we define the intervals between time points as dts, then if dts[i] is larger than factor * dts[i-1],
we think that the change of dts (or the gradient) is too large, and we regard it as a breaking point
and divide the time series into two segments here</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ts</strong> (<em>pyleoclim Series</em>) – </p></li>
<li><p><strong>factor</strong> (<em>float</em>) – The factor that adjusts the threshold for gap detection</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>res</strong> – If gaps were detected, returns the segments in a MultipleSeries object,
else, returns the original timeseries.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pyleoclim MultipleSeries Object or pyleoclim Series Object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.Series.slice">
<span class="sig-name descname"><span class="pre">slice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timespan</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#Series.slice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.Series.slice" title="Permalink to this definition"></a></dt>
<dd><p>Slicing the timeseries with a timespan (tuple or list)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>timespan</strong> (<em>tuple</em><em> or </em><em>list</em>) – The list of time points for slicing, whose length must be even.
When there are n time points, the output Series includes n/2 segments.
For example, if timespan = [a, b], then the sliced output includes one segment [a, b];
if timespan = [a, b, c, d], then the sliced output includes segment [a, b] and segment [c, d].</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>new</strong> – The sliced Series object.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#pyleoclim.core.ui.Series" title="pyleoclim.core.ui.Series">Series</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.Series.sort">
<span class="sig-name descname"><span class="pre">sort</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#Series.sort"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.Series.sort" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Ensure timeseries is aligned to a prograde axis.</dt><dd><p>If the time axis is prograde to begin with, no transformation is applied.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>verbose</strong> (<em>bool</em>) – If True, will print warning messages if there is any</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Series object with removed NaNs and sorting</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#pyleoclim.core.ui.Series" title="pyleoclim.core.ui.Series">Series</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.Series.spectral">
<span class="sig-name descname"><span class="pre">spectral</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'lomb_scargle'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'log'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">settings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#Series.spectral"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.Series.spectral" title="Permalink to this definition"></a></dt>
<dd><p>Perform spectral analysis on the timeseries</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method</strong> (<em>str</em>) – {‘wwz’, ‘mtm’, ‘lomb_scargle’, ‘welch’, ‘periodogram’}</p></li>
<li><p><strong>freq_method</strong> (<em>str</em>) – {‘log’,’scale’, ‘nfft’, ‘lomb_scargle’, ‘welch’}</p></li>
<li><p><strong>freq_kwargs</strong> (<em>dict</em>) – Arguments for frequency vector</p></li>
<li><p><strong>settings</strong> (<em>dict</em>) – Arguments for the specific spectral method</p></li>
<li><p><strong>label</strong> (<em>str</em>) – Label for the PSD object</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – If True, will print warning messages if there is any</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>psd</strong> – A <code class="xref py py-mod docutils literal notranslate"><span class="pre">pyleoclim.PSD</span></code> object</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pyleoclim.PSD</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="../utils/spectral/mtm.html#pyleoclim.utils.spectral.mtm" title="pyleoclim.utils.spectral.mtm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.spectral.mtm</span></code></a></dt><dd><p>Spectral analysis using the Multitaper approach</p>
</dd>
<dt><a class="reference internal" href="../utils/spectral/lombscargle.html#pyleoclim.utils.spectral.lomb_scargle" title="pyleoclim.utils.spectral.lomb_scargle"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.spectral.lomb_scargle</span></code></a></dt><dd><p>Spectral analysis using the Lomb-Scargle method</p>
</dd>
<dt><a class="reference internal" href="../utils/spectral/welch.html#pyleoclim.utils.spectral.welch" title="pyleoclim.utils.spectral.welch"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.spectral.welch</span></code></a></dt><dd><p>Spectral analysis using the Welch segement approach</p>
</dd>
<dt><a class="reference internal" href="../utils/spectral/periodogram.html#pyleoclim.utils.spectral.periodogram" title="pyleoclim.utils.spectral.periodogram"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.spectral.periodogram</span></code></a></dt><dd><p>Spectral anaysis using the basic Fourier transform</p>
</dd>
<dt><a class="reference internal" href="../utils/spectral/wwz_psd.html#pyleoclim.utils.spectral.wwz_psd" title="pyleoclim.utils.spectral.wwz_psd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.spectral.wwz_psd</span></code></a></dt><dd><p>Spectral analysis using the Wavelet Weighted Z transform</p>
</dd>
<dt><a class="reference internal" href="../utils/wavelet/make_freq_vector.html#pyleoclim.utils.wavelet.make_freq_vector" title="pyleoclim.utils.wavelet.make_freq_vector"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.wavelet.make_freq_vector</span></code></a></dt><dd><p>Functions to create the frequency vector</p>
</dd>
<dt><a class="reference internal" href="../utils/tsutils/detrend.html#pyleoclim.utils.tsutils.detrend" title="pyleoclim.utils.tsutils.detrend"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.tsutils.detrend</span></code></a></dt><dd><p>Detrending function</p>
</dd>
<dt><a class="reference internal" href="#pyleoclim.core.ui.PSD" title="pyleoclim.core.ui.PSD"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.core.ui.PSD</span></code></a></dt><dd><p>PSD object</p>
</dd>
<dt><a class="reference internal" href="#pyleoclim.core.ui.MultiplePSD" title="pyleoclim.core.ui.MultiplePSD"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.core.ui.MultiplePSD</span></code></a></dt><dd><p>Multiple PSD object</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p>Calculate the spectrum of SOI using the various methods and compute significance</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">pyleoclim</span> <span class="k">as</span> <span class="nn">pyleo</span>

<span class="gp">In [2]: </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="gp">In [3]: </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/LinkedEarth/Pyleoclim_util/Development/example_data/soi_data.csv&#39;</span><span class="p">,</span><span class="n">skiprows</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">time</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>

<span class="gp">In [5]: </span><span class="n">value</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>

<span class="gp">In [6]: </span><span class="n">ts</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">,</span> <span class="n">time_name</span><span class="o">=</span><span class="s1">&#39;Year C.E&#39;</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s1">&#39;SOI&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;SOI&#39;</span><span class="p">)</span>

<span class="go"># Standardize the time series</span>
<span class="gp">In [7]: </span><span class="n">ts_std</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">standardize</span><span class="p">()</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Lomb-Scargle</p></li>
</ul>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [8]: </span><span class="n">psd_ls</span> <span class="o">=</span> <span class="n">ts_std</span><span class="o">.</span><span class="n">spectral</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;lomb_scargle&#39;</span><span class="p">)</span>

<span class="gp">In [9]: </span><span class="n">psd_ls_signif</span> <span class="o">=</span> <span class="n">psd_ls</span><span class="o">.</span><span class="n">signif_test</span><span class="p">(</span><span class="n">number</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <span class="c1">#in practice, need more AR1 simulations</span>

<span class="gp">In [10]: </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">psd_ls_signif</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;PSD using Lomb-Scargle method&#39;</span><span class="p">)</span>
<span class="go">&lt;Figure size 1000x400 with 1 Axes&gt;</span>

<span class="gp">In [11]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">closefig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/spec_ls.png" src="../_images/spec_ls.png" />
<p>We may pass in method-specific arguments via “settings”, which is a dictionary.
For instance, to adjust the number of overlapping segment for Lomb-Scargle, we may specify the method-specific argument “n50”;
to adjust the frequency vector, we may modify the “freq_method” or modify the method-specific argument “freq”.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [12]: </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="gp">In [13]: </span><span class="n">psd_LS_n50</span> <span class="o">=</span> <span class="n">ts_std</span><span class="o">.</span><span class="n">spectral</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;lomb_scargle&#39;</span><span class="p">,</span> <span class="n">settings</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;n50&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">})</span>  <span class="c1"># c=1e-2 yields lower frequency resolution</span>

<span class="gp">In [14]: </span><span class="n">psd_LS_freq</span> <span class="o">=</span> <span class="n">ts_std</span><span class="o">.</span><span class="n">spectral</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;lomb_scargle&#39;</span><span class="p">,</span> <span class="n">settings</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;freq&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">20</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mf">0.2</span><span class="p">,</span> <span class="mi">51</span><span class="p">)})</span>

<span class="gp">In [15]: </span><span class="n">psd_LS_LS</span> <span class="o">=</span> <span class="n">ts_std</span><span class="o">.</span><span class="n">spectral</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;lomb_scargle&#39;</span><span class="p">,</span> <span class="n">freq_method</span><span class="o">=</span><span class="s1">&#39;lomb_scargle&#39;</span><span class="p">)</span>  <span class="c1"># with frequency vector generated using REDFIT method</span>

<span class="gp">In [16]: </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">psd_LS_n50</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
<span class="gp">   ....: </span>    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;PSD using Lomb-Scargle method with 4 overlapping segments&#39;</span><span class="p">,</span>
<span class="gp">   ....: </span>    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;settings={&quot;n50&quot;: 4}&#39;</span><span class="p">,</span> <span class="n">mute</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">   ....: </span>

<span class="gp">In [17]: </span><span class="n">psd_ls</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;settings={&quot;n50&quot;: 3}&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="gh">Out[17]: </span><span class="go">&lt;AxesSubplot:title={&#39;center&#39;:&#39;PSD using Lomb-Scargle method with 4 overlapping segments&#39;}, xlabel=&#39;Period&#39;, ylabel=&#39;PSD&#39;&gt;</span>

<span class="gp">In [18]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">showfig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
<span class="go">&lt;Figure size 1000x400 with 1 Axes&gt;</span>

<span class="gp">In [19]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">closefig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>

<span class="gp">In [20]: </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">psd_LS_freq</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
<span class="gp">   ....: </span>    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;PSD using Lomb-Scargle method with differnt frequency vectors&#39;</span><span class="p">,</span> <span class="n">mute</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">   ....: </span>    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;freq=np.linspace(1/20, 1/0.2, 51)&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="gp">   ....: </span>

<span class="gp">In [21]: </span><span class="n">psd_ls</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;freq_method=&quot;log&quot;&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="gh">Out[21]: </span><span class="go">&lt;AxesSubplot:title={&#39;center&#39;:&#39;PSD using Lomb-Scargle method with differnt frequency vectors&#39;}, xlabel=&#39;Period&#39;, ylabel=&#39;PSD&#39;&gt;</span>

<span class="gp">In [22]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">showfig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
<span class="go">&lt;Figure size 1000x400 with 1 Axes&gt;</span>

<span class="gp">In [23]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">closefig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/spec_ls_n50.png" src="../_images/spec_ls_n50.png" />
<img alt="../_images/spec_ls_freq.png" src="../_images/spec_ls_freq.png" />
<p>You may notice the differences in the PSD curves regarding smoothness and the locations of the analyzed period points.</p>
<p>For other method-specific arguments, please look up the specific methods in the “See also” section.</p>
<ul class="simple">
<li><p>WWZ</p></li>
</ul>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [24]: </span><span class="n">psd_wwz</span> <span class="o">=</span> <span class="n">ts_std</span><span class="o">.</span><span class="n">spectral</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;wwz&#39;</span><span class="p">)</span>  <span class="c1"># wwz is the default method</span>

<span class="gp">In [25]: </span><span class="n">psd_wwz_signif</span> <span class="o">=</span> <span class="n">psd_wwz</span><span class="o">.</span><span class="n">signif_test</span><span class="p">(</span><span class="n">number</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># significance test; for real work, should use number=200 or even larger</span>

<span class="gp">In [26]: </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">psd_wwz_signif</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;PSD using WWZ method&#39;</span><span class="p">)</span>
<span class="go">&lt;Figure size 1000x400 with 1 Axes&gt;</span>

<span class="gp">In [27]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">closefig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/spec_wwz.png" src="../_images/spec_wwz.png" />
<ul class="simple">
<li><p>Periodogram</p></li>
</ul>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [28]: </span><span class="n">ts_interp</span> <span class="o">=</span> <span class="n">ts_std</span><span class="o">.</span><span class="n">interp</span><span class="p">()</span>

<span class="gp">In [29]: </span><span class="n">psd_perio</span> <span class="o">=</span> <span class="n">ts_interp</span><span class="o">.</span><span class="n">spectral</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;periodogram&#39;</span><span class="p">)</span>

<span class="gp">In [30]: </span><span class="n">psd_perio_signif</span> <span class="o">=</span> <span class="n">psd_perio</span><span class="o">.</span><span class="n">signif_test</span><span class="p">(</span><span class="n">number</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <span class="c1">#in practice, need more AR1 simulations</span>

<span class="gp">In [31]: </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">psd_perio_signif</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;PSD using Periodogram method&#39;</span><span class="p">)</span>
<span class="go">&lt;Figure size 1000x400 with 1 Axes&gt;</span>

<span class="gp">In [32]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">closefig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/spec_perio.png" src="../_images/spec_perio.png" />
<ul class="simple">
<li><p>Welch</p></li>
</ul>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [33]: </span><span class="n">ts_interp</span> <span class="o">=</span> <span class="n">ts_std</span><span class="o">.</span><span class="n">interp</span><span class="p">()</span>

<span class="gp">In [34]: </span><span class="n">psd_welch</span> <span class="o">=</span> <span class="n">ts_interp</span><span class="o">.</span><span class="n">spectral</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;welch&#39;</span><span class="p">)</span>

<span class="gp">In [35]: </span><span class="n">psd_welch_signif</span> <span class="o">=</span> <span class="n">psd_welch</span><span class="o">.</span><span class="n">signif_test</span><span class="p">(</span><span class="n">number</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <span class="c1">#in practice, need more AR1 simulations</span>

<span class="gp">In [36]: </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">psd_welch_signif</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;PSD using Welch method&#39;</span><span class="p">)</span>
<span class="go">&lt;Figure size 1000x400 with 1 Axes&gt;</span>

<span class="gp">In [37]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">closefig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/spec_welch.png" src="../_images/spec_welch.png" />
<ul class="simple">
<li><p>MTM</p></li>
</ul>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [38]: </span><span class="n">ts_interp</span> <span class="o">=</span> <span class="n">ts_std</span><span class="o">.</span><span class="n">interp</span><span class="p">()</span>

<span class="gp">In [39]: </span><span class="n">psd_mtm</span> <span class="o">=</span> <span class="n">ts_interp</span><span class="o">.</span><span class="n">spectral</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;mtm&#39;</span><span class="p">)</span>

<span class="gp">In [40]: </span><span class="n">psd_mtm_signif</span> <span class="o">=</span> <span class="n">psd_mtm</span><span class="o">.</span><span class="n">signif_test</span><span class="p">(</span><span class="n">number</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> <span class="c1">#in practice, need more AR1 simulations</span>

<span class="gp">In [41]: </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">psd_mtm_signif</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;PSD using MTM method&#39;</span><span class="p">)</span>
<span class="go">&lt;Figure size 1000x400 with 1 Axes&gt;</span>

<span class="gp">In [42]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">closefig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/spec_mtm.png" src="../_images/spec_mtm.png" />
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.Series.ssa">
<span class="sig-name descname"><span class="pre">ssa</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">M</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nMC</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trunc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">80</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#Series.ssa"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.Series.ssa" title="Permalink to this definition"></a></dt>
<dd><p>Singular Spectrum Analysis</p>
<p>Nonparametric, orthogonal decomposition of timeseries into constituent oscillations.
This implementation  uses the method of [1], with applications presented in [2].
Optionally (MC&gt;0), the significance of eigenvalues is assessed by Monte-Carlo simulations of an AR(1) model fit to X, using [3].
The method expects regular spacing, but is tolerant to missing values, up to a fraction 0&lt;f&lt;1 (see [4]).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>M</strong> (<em>int</em><em>, </em><em>optional</em>) – window size. The default is None (10% of the length of the series).</p></li>
<li><p><strong>MC</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of iteration in the Monte-Carlo process. The default is 0.</p></li>
<li><p><strong>f</strong> (<em>float</em><em>, </em><em>optional</em>) – maximum allowable fraction of missing values. The default is 0.3.</p></li>
<li><p><strong>trunc</strong> (<em>str</em>) – <dl class="simple">
<dt>if present, truncates the expansion to a level K &lt; M owing to one of 3 criteria:</dt><dd><ol class="arabic simple">
<li><p>’kaiser’: variant of the Kaiser-Guttman rule, retaining eigenvalues larger than the median</p></li>
<li><p>’mc-ssa’: Monte-Carlo SSA (use modes above the 95% threshold)</p></li>
<li><p>’var’: first K modes that explain at least var_thresh % of the variance.</p></li>
</ol>
</dd>
</dl>
<p>Default is None, which bypasses truncation (K = M)</p>
</p></li>
<li><p><strong>var_thresh</strong> (<em>float</em>) – variance threshold for reconstruction (only impactful if trunc is set to ‘var’)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>res</strong> (<em>object of the SsaRes class containing:</em>)</p></li>
<li><p><strong>- eigvals</strong> (<em>(M, ) array of eigenvalues</em>)</p></li>
<li><p><strong>- eigvecs</strong> (<em>(M, M) Matrix of temporal eigenvectors (T-EOFs)</em>)</p></li>
<li><p><strong>- PC</strong> (<em>(N - M + 1, M) array of principal components (T-PCs)</em>)</p></li>
<li><p><strong>- RCmat</strong> (<em>(N,  M) array of reconstructed components</em>)</p></li>
<li><p><strong>- RCseries</strong> (<em>(N,) reconstructed series, with mean and variance restored</em>)</p></li>
<li><p><strong>- pctvar</strong> (<em>(M, ) array of the fraction of variance (%) associated with each mode</em>)</p></li>
<li><p><strong>- eigvals_q</strong> (<em>(M, 2) array contaitning the 5% and 95% quantiles of the Monte-Carlo eigenvalue spectrum [ if nMC &gt;0 ]</em>)</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>SSA with SOI</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">pyleoclim</span> <span class="k">as</span> <span class="nn">pyleo</span>

<span class="gp">In [2]: </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="gp">In [3]: </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/LinkedEarth/Pyleoclim_util/Development/example_data/soi_data.csv&#39;</span><span class="p">,</span><span class="n">skiprows</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">time</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>

<span class="gp">In [5]: </span><span class="n">value</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>

<span class="gp">In [6]: </span><span class="n">ts</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">,</span> <span class="n">time_name</span><span class="o">=</span><span class="s1">&#39;Year C.E&#39;</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s1">&#39;SOI&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;SOI&#39;</span><span class="p">)</span>

<span class="go"># plot</span>
<span class="gp">In [7]: </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="go">&lt;Figure size 1000x400 with 1 Axes&gt;</span>

<span class="gp">In [8]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">closefig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>

<span class="go"># SSA</span>
<span class="gp">In [9]: </span><span class="n">nino_ssa</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">ssa</span><span class="p">(</span><span class="n">M</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/ts_plot4.png" src="../_images/ts_plot4.png" />
<p>Let us now see how to make use of all these arrays. The first step is too inspect the eigenvalue spectrum (“scree plot”) to identify remarkable modes. Let us restrict ourselves to the first 40, so we can see something:</p>
<dl class="simple">
<dt>This highlights a few common phenomena with SSA:</dt><dd><ul class="simple">
<li><p>the eigenvalues are in descending order</p></li>
<li><p>their uncertainties are proportional to the eigenvalues themselves</p></li>
<li><p>the eigenvalues tend to come in pairs : (1,2) (3,4), are all clustered within uncertainties . (5,6) looks like another doublet</p></li>
<li><p>around i=15, the eigenvalues appear to reach a floor, and all subsequent eigenvalues explain a very small amount of variance.</p></li>
</ul>
</dd>
</dl>
<p>So, summing the variance of all modes higher than 19, we get:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [10]: </span><span class="nb">print</span><span class="p">(</span><span class="n">nino_ssa</span><span class="o">.</span><span class="n">pctvar</span><span class="p">[</span><span class="mi">15</span><span class="p">:]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>
<span class="go">282.3019309505681</span>
</pre></div>
</div>
<p>That is, over 95% of the variance is in the first 15 modes. That is a typical result for a (paleo)climate timeseries; a few modes do the vast majority of the work. That means we can focus our attention on these modes and capture most of the interesting behavior. To see this, let’s use the reconstructed components (RCs), and sum the RC matrix over the first 15 columns:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [11]: </span><span class="n">RCk</span> <span class="o">=</span> <span class="n">nino_ssa</span><span class="o">.</span><span class="n">RCmat</span><span class="p">[:,:</span><span class="mi">14</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="gp">In [12]: </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;ONI&#39;</span><span class="p">,</span><span class="n">mute</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># we mute the first call to only get the plot with 2 lines</span>

<span class="gp">In [13]: </span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="n">RCk</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;SSA reconstruction, 14 modes&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="gh">Out[13]: </span><span class="go">[&lt;matplotlib.lines.Line2D at 0x1b424e790&gt;]</span>

<span class="gp">In [14]: </span><span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="gh">Out[14]: </span><span class="go">&lt;matplotlib.legend.Legend at 0x1b4c170d0&gt;</span>

<span class="gp">In [15]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">showfig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
<span class="go">&lt;Figure size 1000x400 with 1 Axes&gt;</span>

<span class="gp">In [16]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">closefig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/ssa_recon.png" src="../_images/ssa_recon.png" />
<dl class="simple">
<dt>Indeed, these first few modes capture the vast majority of the low-frequency behavior, including all the El Niño/La Niña events. What is left (the blue wiggles not captured in the orange curve) are high-frequency oscillations that might be considered “noise” from the standpoint of ENSO dynamics. This illustrates how SSA might be used for filtering a timeseries. One must be careful however:</dt><dd><ul class="simple">
<li><p>there was not much rhyme or reason for picking 15 modes. Why not 5, or 39? All we have seen so far is that they gather &gt;95% of the variance, which is by no means a magic number.</p></li>
<li><p>there is no guarantee that the first few modes will filter out high-frequency behavior, or at what frequency cutoff they will do so. If you need to cut out specific frequencies, you are better off doing it with a classical filter, like the butterworth filter implemented in Pyleoclim. However, in many instances the choice of a cutoff frequency is itself rather arbitrary. In such cases, SSA provides a principled alternative for generating a version of a timeseries that preserves features and excludes others (i.e, a filter).</p></li>
<li><p>as with all orthgonal decompositions, summing over all RCs will recover the original signal within numerical precision.</p></li>
</ul>
</dd>
</dl>
<p>Monte-Carlo SSA</p>
<p>Selecting meaningful modes in eigenproblems (e.g. EOF analysis) is more art than science. However, one technique stands out: Monte Carlo SSA, introduced by Allen &amp; Smith, (1996) to identiy SSA modes that rise above what one would expect from “red noise”, specifically an AR(1) process_process). To run it, simply provide the parameter MC, ideally with a number of iterations sufficient to get decent statistics. Here’s let’s use MC = 1000. The result will be stored in the eigval_q array, which has the same length as eigval, and its two columns contain the 5% and 95% quantiles of the ensemble of MC-SSA eigenvalues.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [17]: </span><span class="n">nino_mcssa</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">ssa</span><span class="p">(</span><span class="n">M</span> <span class="o">=</span> <span class="mi">60</span><span class="p">,</span> <span class="n">nMC</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
<p>Now let’s look at the result:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [18]: </span><span class="n">nino_mcssa</span><span class="o">.</span><span class="n">screeplot</span><span class="p">()</span>
<span class="go">&lt;Figure size 600x400 with 1 Axes&gt;</span>
<span class="gh">Out[18]: </span><span class="go"></span>
<span class="go">(&lt;Figure size 600x400 with 1 Axes&gt;,</span>
<span class="go"> &lt;AxesSubplot:title={&#39;center&#39;:&#39;SSA scree plot&#39;}, xlabel=&#39;Mode index $i$&#39;, ylabel=&#39;$\\lambda_i$&#39;&gt;)</span>

<span class="gp">In [19]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">showfig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
<span class="go">&lt;Figure size 1000x400 with 1 Axes&gt;</span>

<span class="gp">In [20]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">closefig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/scree_nmc.png" src="../_images/scree_nmc.png" />
<p>This suggests that modes 1-5 fall above the red noise benchmark.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.Series.standardize">
<span class="sig-name descname"><span class="pre">standardize</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#Series.standardize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.Series.standardize" title="Permalink to this definition"></a></dt>
<dd><p>Standardizes the time series</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>new</strong> – The standardized series object</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>pyleoclim.Series</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.Series.stats">
<span class="sig-name descname"><span class="pre">stats</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#Series.stats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.Series.stats" title="Permalink to this definition"></a></dt>
<dd><p>Compute basic statistics for the time series</p>
<p>Computes the mean, median, min, max, standard deviation, and interquartile range of a numpy array y, ignoring NaNs.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>res</strong> – Contains the mean, median, minimum value, maximum value, standard
deviation, and interquartile range for the Series.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dictionary</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Compute basic statistics for the SOI series</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">pyleoclim</span> <span class="k">as</span> <span class="nn">pyleo</span>

<span class="gp">In [2]: </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="gp">In [3]: </span><span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/LinkedEarth/Pyleoclim_util/Development/example_data/soi_data.csv&#39;</span><span class="p">,</span><span class="n">skiprows</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">time</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>

<span class="gp">In [5]: </span><span class="n">value</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>

<span class="gp">In [6]: </span><span class="n">ts</span><span class="o">=</span><span class="n">pyleo</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">,</span><span class="n">time_name</span><span class="o">=</span><span class="s1">&#39;Year C.E&#39;</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s1">&#39;SOI&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;SOI&#39;</span><span class="p">)</span>

<span class="gp">In [7]: </span><span class="n">ts</span><span class="o">.</span><span class="n">stats</span><span class="p">()</span>
<span class="gh">Out[7]: </span><span class="go"></span>
<span class="go">{&#39;mean&#39;: 0.11992753623188407,</span>
<span class="go"> &#39;median&#39;: 0.1,</span>
<span class="go"> &#39;min&#39;: -3.6,</span>
<span class="go"> &#39;max&#39;: 2.9,</span>
<span class="go"> &#39;std&#39;: 0.9380195472790024,</span>
<span class="go"> &#39;IQR&#39;: 1.3}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.Series.summary_plot">
<span class="sig-name descname"><span class="pre">summary_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">psd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scalogram</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[8,</span> <span class="pre">10]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">period_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psd_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_signif_test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">period_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psd_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'PSD'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavelet_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psd_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ts_plot_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavelet_plot_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psd_plot_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trunc_series</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savefig_settings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#Series.summary_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.Series.summary_plot" title="Permalink to this definition"></a></dt>
<dd><p>Generate a plot of the timeseries and its frequency content through spectral and wavelet analyses.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>psd</strong> (<a class="reference internal" href="#pyleoclim.core.ui.PSD" title="pyleoclim.core.ui.PSD"><em>PSD</em></a>) – the PSD object of a Series. If None, will be calculated. This process can be slow as it will be using the WWZ method.</p></li>
<li><p><strong>scalogram</strong> (<a class="reference internal" href="#pyleoclim.core.ui.Scalogram" title="pyleoclim.core.ui.Scalogram"><em>Scalogram</em></a>) – the Scalogram object of a Series. If None, will be calculated. This process can be slow as it will be using the WWZ method.</p></li>
<li><p><strong>figsize</strong> (<em>list</em>) – a list of two integers indicating the figure size</p></li>
<li><p><strong>title</strong> (<em>str</em>) – the title for the figure</p></li>
<li><p><strong>time_lim</strong> (<em>list</em><em> or </em><em>tuple</em>) – the limitation of the time axis. This is for display purposes only, the scalogram and psd will still be calculated using the full time series.</p></li>
<li><p><strong>value_lim</strong> (<em>list</em><em> or </em><em>tuple</em>) – the limitation of the value axis of the timeseries. This is for display purposes only, the scalogram and psd will still be calculated using the full time series.</p></li>
<li><p><strong>period_lim</strong> (<em>list</em><em> or </em><em>tuple</em>) – the limitation of the period axis</p></li>
<li><p><strong>psd_lim</strong> (<em>list</em><em> or </em><em>tuple</em>) – the limitation of the psd axis</p></li>
<li><p><strong>n_signif_test=100</strong> (<em>int</em>) – Number of Monte-Carlo simulations to perform for significance testing. Used when psd=None or scalogram=None</p></li>
<li><p><strong>time_label</strong> (<em>str</em>) – the label for the time axis</p></li>
<li><p><strong>value_label</strong> (<em>str</em>) – the label for the value axis of the timeseries</p></li>
<li><p><strong>period_label</strong> (<em>str</em>) – the label for the period axis</p></li>
<li><p><strong>psd_label</strong> (<em>str</em>) – the label for the amplitude axis of PDS</p></li>
<li><p><strong>wavelet_kwargs</strong> (<em>dict</em>) – arguments to be passed to the wavelet function, see pyleoclim.core.ui.Series.wavelet for details</p></li>
<li><p><strong>psd_kwargs</strong> (<em>dict</em>) – arguments to be passed to the spectral function, see pyleoclim.core.ui.Series.spectral for details</p></li>
<li><p><strong>ts_plot_kwargs</strong> (<em>dict</em>) – arguments to be passed to the timeseries subplot, see pyleoclim.core.ui.Series.plot for details</p></li>
<li><p><strong>wavelet_plot_kwargs</strong> (<em>dict</em>) – arguments to be passed to the scalogram plot, see pyleoclim.core.ui.Scalogram.plot for details</p></li>
<li><p><strong>psd_plot_kwargs</strong> (<em>dict</em>) – <dl>
<dt>arguments to be passed to the psd plot, see pyleoclim.core.ui.PSD.plot for details</dt><dd><dl class="simple">
<dt>Certain psd plot settings are required by summary plot formatting. These include:</dt><dd><ul>
<li><p>ylabel</p></li>
<li><p>legend</p></li>
<li><p>tick parameters</p></li>
</ul>
</dd>
</dl>
<p>These will be overriden by summary plot to prevent formatting errors</p>
</dd>
</dl>
</p></li>
<li><p><strong>trunc_series</strong> (<em>list</em><em> or </em><em>tuple</em>) – the limitation of the time axis. This will slice the actual time series into one contained within the passed boundaries and as such effect the resulting scalogram and psd objects (assuming said objects are to be generated by summary_plot).</p></li>
<li><p><strong>savefig_settings</strong> (<em>dict</em>) – <p>the dictionary of arguments for plt.savefig(); some notes below:
- “path” must be specified; it can be any existed or non-existed path,</p>
<blockquote>
<div><p>with or without a suffix; if the suffix is not given in “path”, it will follow “format”</p>
</div></blockquote>
<ul>
<li><p>”format” can be one of {“pdf”, “eps”, “png”, “ps”}</p></li>
</ul>
</p></li>
<li><p><strong>mute</strong> (<em>{True</em><em>,</em><em>False}</em>) – if True, the plot will not show;
recommend to turn on when more modifications are going to be made on ax</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#pyleoclim.core.ui.Series.spectral" title="pyleoclim.core.ui.Series.spectral"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.core.ui.Series.spectral</span></code></a></dt><dd><p>Spectral analysis for a timeseries</p>
</dd>
<dt><a class="reference internal" href="#pyleoclim.core.ui.Series.wavelet" title="pyleoclim.core.ui.Series.wavelet"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.core.ui.Series.wavelet</span></code></a></dt><dd><p>Wavelet analysis for a timeseries</p>
</dd>
<dt><a class="reference internal" href="../utils/plotting/savefig.html#pyleoclim.utils.plotting.savefig" title="pyleoclim.utils.plotting.savefig"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.plotting.savefig</span></code></a></dt><dd><p>saving figure in Pyleoclim</p>
</dd>
<dt><a class="reference internal" href="#pyleoclim.core.ui.PSD" title="pyleoclim.core.ui.PSD"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.core.ui.PSD</span></code></a></dt><dd><p>PSD object</p>
</dd>
<dt><a class="reference internal" href="#pyleoclim.core.ui.MultiplePSD" title="pyleoclim.core.ui.MultiplePSD"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.core.ui.MultiplePSD</span></code></a></dt><dd><p>Multiple PSD object</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p>Simple summary_plot with n_signif_test = 1 for computational ease, defaults otherwise.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">pyleoclim</span> <span class="k">as</span> <span class="nn">pyleo</span>

<span class="gp">In [2]: </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="gp">In [3]: </span><span class="n">ts</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/LinkedEarth/Pyleoclim_util/master/example_data/soi_data.csv&#39;</span><span class="p">,</span><span class="n">skiprows</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">series</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">time</span> <span class="o">=</span> <span class="n">ts</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">],</span><span class="n">value</span> <span class="o">=</span> <span class="n">ts</span><span class="p">[</span><span class="s1">&#39;Value&#39;</span><span class="p">],</span> <span class="n">time_name</span> <span class="o">=</span> <span class="s1">&#39;Years&#39;</span><span class="p">,</span> <span class="n">time_unit</span> <span class="o">=</span> <span class="s1">&#39;AD&#39;</span><span class="p">)</span>

<span class="gp">In [5]: </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">summary_plot</span><span class="p">(</span><span class="n">n_signif_test</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">&lt;Figure size 800x1000 with 4 Axes&gt;</span>

<span class="gp">In [6]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">closefig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<p>Summary_plot with pre-generated psd and scalogram objects.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [7]: </span><span class="kn">import</span> <span class="nn">pyleoclim</span> <span class="k">as</span> <span class="nn">pyleo</span>

<span class="gp">In [8]: </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="gp">In [9]: </span><span class="n">ts</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/LinkedEarth/Pyleoclim_util/master/example_data/soi_data.csv&#39;</span><span class="p">,</span><span class="n">skiprows</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

<span class="gp">In [10]: </span><span class="n">series</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">time</span> <span class="o">=</span> <span class="n">ts</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">],</span><span class="n">value</span> <span class="o">=</span> <span class="n">ts</span><span class="p">[</span><span class="s1">&#39;Value&#39;</span><span class="p">],</span> <span class="n">time_name</span> <span class="o">=</span> <span class="s1">&#39;Years&#39;</span><span class="p">,</span> <span class="n">time_unit</span> <span class="o">=</span> <span class="s1">&#39;AD&#39;</span><span class="p">)</span>

<span class="gp">In [11]: </span><span class="n">psd</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">spectral</span><span class="p">(</span><span class="n">freq_method</span> <span class="o">=</span> <span class="s1">&#39;welch&#39;</span><span class="p">)</span>

<span class="gp">In [12]: </span><span class="n">scalogram</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">wavelet</span><span class="p">(</span><span class="n">freq_method</span> <span class="o">=</span> <span class="s1">&#39;welch&#39;</span><span class="p">)</span>

<span class="gp">In [13]: </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">summary_plot</span><span class="p">(</span><span class="n">psd</span> <span class="o">=</span> <span class="n">psd</span><span class="p">,</span><span class="n">scalogram</span> <span class="o">=</span> <span class="n">scalogram</span><span class="p">)</span>
<span class="go">&lt;Figure size 800x1000 with 4 Axes&gt;</span>

<span class="gp">In [14]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">closefig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<p>Summary_plot with pre-generated psd and scalogram objects from before and some plot modification arguments passed.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [15]: </span><span class="kn">import</span> <span class="nn">pyleoclim</span> <span class="k">as</span> <span class="nn">pyleo</span>

<span class="gp">In [16]: </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="gp">In [17]: </span><span class="n">ts</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/LinkedEarth/Pyleoclim_util/master/example_data/soi_data.csv&#39;</span><span class="p">,</span><span class="n">skiprows</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

<span class="gp">In [18]: </span><span class="n">series</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">time</span> <span class="o">=</span> <span class="n">ts</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">],</span><span class="n">value</span> <span class="o">=</span> <span class="n">ts</span><span class="p">[</span><span class="s1">&#39;Value&#39;</span><span class="p">],</span> <span class="n">time_name</span> <span class="o">=</span> <span class="s1">&#39;Years&#39;</span><span class="p">,</span> <span class="n">time_unit</span> <span class="o">=</span> <span class="s1">&#39;AD&#39;</span><span class="p">)</span>

<span class="gp">In [19]: </span><span class="n">psd</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">spectral</span><span class="p">(</span><span class="n">freq_method</span> <span class="o">=</span> <span class="s1">&#39;welch&#39;</span><span class="p">)</span>

<span class="gp">In [20]: </span><span class="n">scalogram</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">wavelet</span><span class="p">(</span><span class="n">freq_method</span> <span class="o">=</span> <span class="s1">&#39;welch&#39;</span><span class="p">)</span>

<span class="gp">In [21]: </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">summary_plot</span><span class="p">(</span><span class="n">psd</span> <span class="o">=</span> <span class="n">psd</span><span class="p">,</span><span class="n">scalogram</span> <span class="o">=</span> <span class="n">scalogram</span><span class="p">,</span> <span class="n">period_lim</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">ts_plot_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="s1">&#39;linewidth&#39;</span><span class="p">:</span><span class="mf">.5</span><span class="p">},</span> <span class="n">psd_plot_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="s1">&#39;linewidth&#39;</span><span class="p">:</span><span class="mf">.5</span><span class="p">})</span>
<span class="go">&lt;Figure size 800x1000 with 4 Axes&gt;</span>

<span class="gp">In [22]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">closefig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.Series.surrogates">
<span class="sig-name descname"><span class="pre">surrogates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ar1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">settings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#Series.surrogates"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.Series.surrogates" title="Permalink to this definition"></a></dt>
<dd><p>Generate surrogates with increasing time axis</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method</strong> (<em>{ar1}</em>) – Uses an AR1 model to generate surrogates of the timeseries</p></li>
<li><p><strong>number</strong> (<em>int</em>) – The number of surrogates to generate</p></li>
<li><p><strong>length</strong> (<em>int</em>) – Lenght of the series</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Control seed option for reproducibility</p></li>
<li><p><strong>settings</strong> (<em>dict</em>) – Parameters for surogate generator. See individual methods for details.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>surr</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pyleoclim SurrogateSeries</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="../utils/tsmodel/ar1_sim.html#pyleoclim.utils.tsmodel.ar1_sim" title="pyleoclim.utils.tsmodel.ar1_sim"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.tsmodel.ar1_sim</span></code></a></dt><dd><p>AR1 simulator</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.Series.wavelet">
<span class="sig-name descname"><span class="pre">wavelet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'wwz'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">settings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'log'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ntau</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#Series.wavelet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.Series.wavelet" title="Permalink to this definition"></a></dt>
<dd><p>Perform wavelet analysis on the timeseries</p>
<p>cwt wavelets documented on <a class="reference external" href="https://pywavelets.readthedocs.io/en/latest/ref/cwt.html">https://pywavelets.readthedocs.io/en/latest/ref/cwt.html</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method</strong> (<em>{wwz</em><em>, </em><em>cwt}</em>) – Whether to use the wwz method for unevenly spaced timeseries or traditional cwt (from pywavelets)</p></li>
<li><p><strong>freq_method</strong> (<em>str</em>) – {‘log’, ‘scale’, ‘nfft’, ‘lomb_scargle’, ‘welch’}</p></li>
<li><p><strong>freq_kwargs</strong> (<em>dict</em>) – Arguments for frequency vector</p></li>
<li><p><strong>ntau</strong> (<em>int</em>) – The length of the time shift points that determins the temporal resolution of the result.
If None, it will be either the length of the input time axis, or at most 50.</p></li>
<li><p><strong>settings</strong> (<em>dict</em>) – Arguments for the specific spectral method</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – If True, will print warning messages if there is any</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>scal</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Series.Scalogram</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="../utils/wavelet/wwz.html#pyleoclim.utils.wavelet.wwz" title="pyleoclim.utils.wavelet.wwz"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.wavelet.wwz</span></code></a></dt><dd><p>wwz function</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.wavelet.cwt</span></code></dt><dd><p>cwt function</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.wavelet.make_freq</span></code></dt><dd><p>Functions to create the frequency vector</p>
</dd>
<dt><a class="reference internal" href="../utils/tsutils/detrend.html#pyleoclim.utils.tsutils.detrend" title="pyleoclim.utils.tsutils.detrend"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.tsutils.detrend</span></code></a></dt><dd><p>Detrending function</p>
</dd>
<dt><a class="reference internal" href="#pyleoclim.core.ui.Scalogram" title="pyleoclim.core.ui.Scalogram"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.core.ui.Scalogram</span></code></a></dt><dd><p>Scalogram object</p>
</dd>
<dt><a class="reference internal" href="#pyleoclim.core.ui.MultipleScalogram" title="pyleoclim.core.ui.MultipleScalogram"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.core.ui.MultipleScalogram</span></code></a></dt><dd><p>Multiple Scalogram object</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p>Wavelet analysis on the SOI record.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">pyleoclim</span> <span class="k">as</span> <span class="nn">pyleo</span>

<span class="gp">In [2]: </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="gp">In [3]: </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/LinkedEarth/Pyleoclim_util/Development/example_data/soi_data.csv&#39;</span><span class="p">,</span><span class="n">skiprows</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">time</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>

<span class="gp">In [5]: </span><span class="n">value</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>

<span class="gp">In [6]: </span><span class="n">ts</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">,</span><span class="n">time_name</span><span class="o">=</span><span class="s1">&#39;Year C.E&#39;</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s1">&#39;SOI&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;SOI&#39;</span><span class="p">)</span>

<span class="go"># WWZ</span>
<span class="gp">In [7]: </span><span class="n">scal</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">wavelet</span><span class="p">()</span>

<span class="gp">In [8]: </span><span class="n">scal_signif</span> <span class="o">=</span> <span class="n">scal</span><span class="o">.</span><span class="n">signif_test</span><span class="p">(</span><span class="n">number</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># for real work, should use number=200 or even larger</span>

<span class="gp">In [9]: </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">scal_signif</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="go">&lt;Figure size 1000x800 with 2 Axes&gt;</span>

<span class="gp">In [10]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">closefig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/spec_mtm.png" src="../_images/spec_mtm.png" />
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.Series.wavelet_coherence">
<span class="sig-name descname"><span class="pre">wavelet_coherence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'wwz'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">settings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'log'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ntau</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#Series.wavelet_coherence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.Series.wavelet_coherence" title="Permalink to this definition"></a></dt>
<dd><p>Perform wavelet coherence analysis with the target timeseries</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target_series</strong> (<em>pyleoclim.Series</em>) – A pyleoclim Series object on which to perform the coherence analysis</p></li>
<li><p><strong>method</strong> (<em>{'wwz'}</em>) – </p></li>
<li><p><strong>freq_method</strong> (<em>str</em>) – {‘log’,’scale’, ‘nfft’, ‘lomb_scargle’, ‘welch’}</p></li>
<li><p><strong>freq_kwargs</strong> (<em>dict</em>) – Arguments for frequency vector</p></li>
<li><p><strong>tau</strong> (<em>array</em>) – The time shift points that determins the temporal resolution of the result.
If None, it will be calculated using ntau.</p></li>
<li><p><strong>ntau</strong> (<em>int</em>) – The length of the time shift points that determins the temporal resolution of the result.
If None, it will be either the length of the input time axis, or at most 50.</p></li>
<li><p><strong>settings</strong> (<em>dict</em>) – Arguments for the specific spectral method</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – If True, will print warning messages if there is any</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>coh</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pyleoclim.Coherence</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.wavelet.xwt</span></code></dt><dd><p>Cross-wavelet analysis based on WWZ method</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.wavelet.make_freq</span></code></dt><dd><p>Functions to create the frequency vector</p>
</dd>
<dt><a class="reference internal" href="../utils/tsutils/detrend.html#pyleoclim.utils.tsutils.detrend" title="pyleoclim.utils.tsutils.detrend"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.tsutils.detrend</span></code></a></dt><dd><p>Detrending function</p>
</dd>
<dt><a class="reference internal" href="#pyleoclim.core.ui.Coherence" title="pyleoclim.core.ui.Coherence"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.core.ui.Coherence</span></code></a></dt><dd><p>Coherence object</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p>Wavelet coherence with the default arguments:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">pyleoclim</span> <span class="k">as</span> <span class="nn">pyleo</span>

<span class="gp">In [2]: </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="gp">In [3]: </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/LinkedEarth/Pyleoclim_util/Development/example_data/wtc_test_data_nino.csv&#39;</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">time</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="gp">In [5]: </span><span class="n">air</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;air&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="gp">In [6]: </span><span class="n">nino</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;nino&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="gp">In [7]: </span><span class="n">ts_air</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">air</span><span class="p">,</span> <span class="n">time_name</span><span class="o">=</span><span class="s1">&#39;Year (CE)&#39;</span><span class="p">)</span>

<span class="gp">In [8]: </span><span class="n">ts_nino</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">nino</span><span class="p">,</span> <span class="n">time_name</span><span class="o">=</span><span class="s1">&#39;Year (CE)&#39;</span><span class="p">)</span>

<span class="go"># without any arguments, the `tau` will be determined automatically</span>
<span class="gp">In [9]: </span><span class="n">coh</span> <span class="o">=</span> <span class="n">ts_air</span><span class="o">.</span><span class="n">wavelet_coherence</span><span class="p">(</span><span class="n">ts_nino</span><span class="p">)</span>

<span class="gp">In [10]: </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">coh</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="go">&lt;Figure size 1000x800 with 2 Axes&gt;</span>

<span class="gp">In [11]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">closefig</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../_images/coh.png" src="../_images/coh.png" />
<p>We may specify <cite>ntau</cite> to adjust the temporal resolution of the scalogram, which will affect the time consumption of calculation and the result itself:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [12]: </span><span class="n">coh_ntau</span> <span class="o">=</span> <span class="n">ts_air</span><span class="o">.</span><span class="n">wavelet_coherence</span><span class="p">(</span><span class="n">ts_nino</span><span class="p">,</span> <span class="n">ntau</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>

<span class="gp">In [13]: </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">coh_ntau</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="go">&lt;Figure size 1000x800 with 2 Axes&gt;</span>

<span class="gp">In [14]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">closefig</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../_images/coh_ntau.png" src="../_images/coh_ntau.png" />
<p>We may also specify the <cite>tau</cite> vector explicitly:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [15]: </span><span class="n">coh_tau</span> <span class="o">=</span> <span class="n">ts_air</span><span class="o">.</span><span class="n">wavelet_coherence</span><span class="p">(</span><span class="n">ts_nino</span><span class="p">,</span> <span class="n">tau</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1880</span><span class="p">,</span> <span class="mi">2001</span><span class="p">))</span>

<span class="gp">In [16]: </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">coh_tau</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="go">&lt;Figure size 1000x800 with 2 Axes&gt;</span>

<span class="gp">In [17]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">closefig</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../_images/coh_tau.png" src="../_images/coh_tau.png" />
</dd></dl>

</dd></dl>

</section>
<section id="multipleseries-pyleoclim-multipleseries">
<h2>MultipleSeries (pyleoclim.MultipleSeries)<a class="headerlink" href="#multipleseries-pyleoclim-multipleseries" title="Permalink to this headline"></a></h2>
<p>As the name implies, a MultipleSeries object is a collection (more precisely, a <a class="reference external" href="https://docs.python.org/3/tutorial/introduction.html#lists">list</a>) of multiple Series objects. This is handy in case you want to apply the same method to such a collection at once (e.g. process a bunch of series in a consistent fashion).</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyleoclim.core.ui.MultipleSeries">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pyleoclim.core.ui.</span></span><span class="sig-name descname"><span class="pre">MultipleSeries</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">series_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#MultipleSeries"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.MultipleSeries" title="Permalink to this definition"></a></dt>
<dd><p>MultipleSeries object.</p>
<blockquote>
<div><p>This object handles a collection of the type Series and can be created from a list of such objects.
MultipleSeries should be used when the need to run analysis on multiple records arises, such as running principal component analysis.
Some of the methods automatically refocus the time axis prior to analysis to ensure that the analysis is run over the same time period.</p>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>series_list</strong><span class="classifier">list</span></dt><dd><blockquote>
<div><p>a list of pyleoclim.Series objects</p>
</div></blockquote>
<dl class="simple">
<dt>time_unit<span class="classifier">str</span></dt><dd><p>The target time unit for every series in the list.
If None, then no conversion will be applied;
Otherwise, the time unit of every series in the list will be converted to the target.</p>
</dd>
</dl>
</dd>
<dt><strong>name</strong><span class="classifier">str</span></dt><dd><p>name of the collection of timeseries (e.g. ‘PAGES 2k ice cores’)</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">pyleoclim</span> <span class="k">as</span> <span class="nn">pyleo</span>

<span class="gp">In [2]: </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="gp">In [3]: </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
<span class="gp">   ...: </span>    <span class="s1">&#39;https://raw.githubusercontent.com/LinkedEarth/Pyleoclim_util/Development/example_data/soi_data.csv&#39;</span><span class="p">,</span>
<span class="gp">   ...: </span>    <span class="n">skiprows</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">1</span>
<span class="gp">   ...: </span><span class="p">)</span>
<span class="gp">   ...: </span>

<span class="gp">In [4]: </span><span class="n">time</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>

<span class="gp">In [5]: </span><span class="n">value</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>

<span class="gp">In [6]: </span><span class="n">ts1</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">,</span> <span class="n">time_unit</span><span class="o">=</span><span class="s1">&#39;years&#39;</span><span class="p">)</span>

<span class="gp">In [7]: </span><span class="n">ts2</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">,</span> <span class="n">time_unit</span><span class="o">=</span><span class="s1">&#39;years&#39;</span><span class="p">)</span>

<span class="gp">In [8]: </span><span class="n">ms</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">MultipleSeries</span><span class="p">([</span><span class="n">ts1</span><span class="p">,</span> <span class="n">ts2</span><span class="p">],</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;SOI x2&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyleoclim.core.ui.MultipleSeries.append" title="pyleoclim.core.ui.MultipleSeries.append"><code class="xref py py-obj docutils literal notranslate"><span class="pre">append</span></code></a>(ts)</p></td>
<td><p>Append timeseries ts to MultipleSeries object</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyleoclim.core.ui.MultipleSeries.bin" title="pyleoclim.core.ui.MultipleSeries.bin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bin</span></code></a>(**kwargs)</p></td>
<td><p>Aligns the time axes of a MultipleSeries object, via binning.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyleoclim.core.ui.MultipleSeries.common_time" title="pyleoclim.core.ui.MultipleSeries.common_time"><code class="xref py py-obj docutils literal notranslate"><span class="pre">common_time</span></code></a>([method, common_step, start, ...])</p></td>
<td><p>Aligns the time axes of a MultipleSeries object, via binning interpolation., or Gaussian kernel.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyleoclim.core.ui.MultipleSeries.convert_time_unit" title="pyleoclim.core.ui.MultipleSeries.convert_time_unit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">convert_time_unit</span></code></a>([time_unit])</p></td>
<td><p>Convert the time unit of the timeseries</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyleoclim.core.ui.MultipleSeries.copy" title="pyleoclim.core.ui.MultipleSeries.copy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy</span></code></a>()</p></td>
<td><p>Copy the object</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyleoclim.core.ui.MultipleSeries.correlation" title="pyleoclim.core.ui.MultipleSeries.correlation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">correlation</span></code></a>([target, timespan, alpha, ...])</p></td>
<td><p>Calculate the correlation between a MultipleSeries and a target Series</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyleoclim.core.ui.MultipleSeries.detrend" title="pyleoclim.core.ui.MultipleSeries.detrend"><code class="xref py py-obj docutils literal notranslate"><span class="pre">detrend</span></code></a>([method])</p></td>
<td><p>Detrend timeseries</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyleoclim.core.ui.MultipleSeries.equal_lengths" title="pyleoclim.core.ui.MultipleSeries.equal_lengths"><code class="xref py py-obj docutils literal notranslate"><span class="pre">equal_lengths</span></code></a>()</p></td>
<td><p>Test whether all series in object have equal length</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyleoclim.core.ui.MultipleSeries.filter" title="pyleoclim.core.ui.MultipleSeries.filter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter</span></code></a>([cutoff_freq, cutoff_scale, method])</p></td>
<td><p>Filtering the timeseries in the MultipleSeries object</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyleoclim.core.ui.MultipleSeries.gkernel" title="pyleoclim.core.ui.MultipleSeries.gkernel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">gkernel</span></code></a>(**kwargs)</p></td>
<td><p>Aligns the time axes of a MultipleSeries object, via Gaussian kernel.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyleoclim.core.ui.MultipleSeries.grid_properties" title="pyleoclim.core.ui.MultipleSeries.grid_properties"><code class="xref py py-obj docutils literal notranslate"><span class="pre">grid_properties</span></code></a>([step_style])</p></td>
<td><p>Extract grid properties (start, stop, step) of all the Series objects in a collection.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyleoclim.core.ui.MultipleSeries.interp" title="pyleoclim.core.ui.MultipleSeries.interp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">interp</span></code></a>(**kwargs)</p></td>
<td><p>Aligns the time axes of a MultipleSeries object, via interpolation.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyleoclim.core.ui.MultipleSeries.pca" title="pyleoclim.core.ui.MultipleSeries.pca"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pca</span></code></a>([weights, missing, tol_em, max_em_iter])</p></td>
<td><p>Principal Component Analysis (Empirical Orthogonal Functions)</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyleoclim.core.ui.MultipleSeries.plot" title="pyleoclim.core.ui.MultipleSeries.plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot</span></code></a>([figsize, marker, markersize, ...])</p></td>
<td><p>Plot multiple timeseries on the same axis</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyleoclim.core.ui.MultipleSeries.spectral" title="pyleoclim.core.ui.MultipleSeries.spectral"><code class="xref py py-obj docutils literal notranslate"><span class="pre">spectral</span></code></a>([method, settings, mute_pbar, ...])</p></td>
<td><p>Perform spectral analysis on the timeseries</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyleoclim.core.ui.MultipleSeries.stackplot" title="pyleoclim.core.ui.MultipleSeries.stackplot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">stackplot</span></code></a>([figsize, savefig_settings, xlim, ...])</p></td>
<td><p>Stack plot of multiple series</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyleoclim.core.ui.MultipleSeries.standardize" title="pyleoclim.core.ui.MultipleSeries.standardize"><code class="xref py py-obj docutils literal notranslate"><span class="pre">standardize</span></code></a>()</p></td>
<td><p>Standardize each series object in a collection</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyleoclim.core.ui.MultipleSeries.wavelet" title="pyleoclim.core.ui.MultipleSeries.wavelet"><code class="xref py py-obj docutils literal notranslate"><span class="pre">wavelet</span></code></a>([method, settings, freq_method, ...])</p></td>
<td><p>Wavelet analysis</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.MultipleSeries.append">
<span class="sig-name descname"><span class="pre">append</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#MultipleSeries.append"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.MultipleSeries.append" title="Permalink to this definition"></a></dt>
<dd><p>Append timeseries ts to MultipleSeries object</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>ms</strong> – The augmented object, comprising the old one plus <cite>ts</cite></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>pyleoclim.MultipleSeries</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.MultipleSeries.bin">
<span class="sig-name descname"><span class="pre">bin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#MultipleSeries.bin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.MultipleSeries.bin" title="Permalink to this definition"></a></dt>
<dd><p>Aligns the time axes of a MultipleSeries object, via binning.</p>
<p>This is critical for workflows that need to assume a common time axis
for the group of series under consideration.</p>
<p>The common time axis is characterized by the following parameters:</p>
<p>start : the latest start date of the bunch (maximin of the minima)
stop  : the earliest stop date of the bunch (minimum of the maxima)
step  : The representative spacing between consecutive values (mean of the median spacings)</p>
<p>This is a special case of the common_time function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kwargs</strong> (<em>dict</em>) – Arguments for the binning function. See pyleoclim.utils.tsutils.bin</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>ms</strong> – The MultipleSeries objects with all series aligned to the same time axis.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pyleoclim.MultipleSeries</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#pyleoclim.core.ui.MultipleSeries.common_time" title="pyleoclim.core.ui.MultipleSeries.common_time"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.core.ui.MultipleSeries.common_time</span></code></a></dt><dd><p>Base function on which this operates</p>
</dd>
<dt><a class="reference internal" href="../utils/tsutils/bin_values.html#pyleoclim.utils.tsutils.bin" title="pyleoclim.utils.tsutils.bin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.tsutils.bin</span></code></a></dt><dd><p>Underlying binning function</p>
</dd>
<dt><a class="reference internal" href="#pyleoclim.core.ui.Series.bin" title="pyleoclim.core.ui.Series.bin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.core.ui.Series.bin</span></code></a></dt><dd><p>Bin function for Series object</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">pyleoclim</span> <span class="k">as</span> <span class="nn">pyleo</span>

<span class="gp">In [2]: </span><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://wiki.linked.earth/wiki/index.php/Special:WTLiPD?op=export&amp;lipdid=MD982176.Stott.2004&#39;</span>

<span class="gp">In [3]: </span><span class="n">data</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">Lipd</span><span class="p">(</span><span class="n">usr_path</span> <span class="o">=</span> <span class="n">url</span><span class="p">)</span>
<span class="go">Disclaimer: LiPD files may be updated and modified to adhere to standards</span>

<span class="go">reading: MD982176.Stott.2004.lpd</span>
<span class="go">Finished read: 1 record</span>

<span class="gp">In [4]: </span><span class="n">tslist</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">to_LipdSeriesList</span><span class="p">()</span>
<span class="go">extracting paleoData...</span>
<span class="go">extracting: MD982176.Stott.2004</span>
<span class="go">Created time series: 6 entries</span>

<span class="gp">In [5]: </span><span class="n">tslist</span> <span class="o">=</span> <span class="n">tslist</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span> <span class="c1"># drop the first two series which only concerns age and depth</span>

<span class="gp">In [6]: </span><span class="n">ms</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">MultipleSeries</span><span class="p">(</span><span class="n">tslist</span><span class="p">)</span>

<span class="gp">In [7]: </span><span class="n">msbin</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">bin</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.MultipleSeries.common_time">
<span class="sig-name descname"><span class="pre">common_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'interp'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">common_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'max'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_style</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#MultipleSeries.common_time"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.MultipleSeries.common_time" title="Permalink to this definition"></a></dt>
<dd><p>Aligns the time axes of a MultipleSeries object, via binning
interpolation., or Gaussian kernel. Alignmentis critical for workflows
that need to assume a common time axis for the group of series under consideration.</p>
<p>The common time axis is characterized by the following parameters:</p>
<p>start : the latest start date of the bunch (maximun of the minima)
stop  : the earliest stop date of the bunch (minimum of the maxima)
step  : The representative spacing between consecutive values</p>
<p>Optional arguments for binning or interpolation are those of the underling functions.</p>
<p>If the time axis are retrograde, this step makes them prograde.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method</strong> (<em>string</em>) – either ‘bin’, ‘interp’ [default] or ‘gkernel’</p></li>
<li><p><strong>common_step</strong> (<em>string</em>) – Method to obtain a representative step among all Series
Valid entries: ‘median’ [default], ‘mean’, ‘mode’ or ‘max’</p></li>
<li><p><strong>start</strong> (<em>float</em>) – starting point of the common time axis [default = None]</p></li>
<li><p><strong>stop</strong> (<em>float</em>) – end point of the common time axis [default = None]</p></li>
<li><p><strong>step</strong> (<em>float</em>) – increment the common time axis  [default = None]</p></li>
<li><p><strong>provided</strong> (<em>if not</em>) – </p></li>
<li><p><strong>parameters</strong> (<em>pyleoclim will use grid_properties</em><em>(</em><em>) </em><em>to determine these</em>) – </p></li>
<li><p><strong>step_style</strong> (<em>'string'</em>) – step style to be applied from <cite>grid_properties</cite> [default = None]</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>kwargs: dict</dt><dd><p>keyword arguments (dictionary) of the various methods</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>ms</strong> – The MultipleSeries objects with all series aligned to the same time axis.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>pyleoclim.MultipleSeries</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="../utils/tsutils/bin_values.html#pyleoclim.utils.tsutils.bin" title="pyleoclim.utils.tsutils.bin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.tsutils.bin</span></code></a></dt><dd><p>put timeseries values into bins of equal size (possibly leaving NaNs in).</p>
</dd>
<dt><a class="reference internal" href="../utils/tsutils/gkernel.html#pyleoclim.utils.tsutils.gkernel" title="pyleoclim.utils.tsutils.gkernel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.tsutils.gkernel</span></code></a></dt><dd><p>coarse-graining using a Gaussian kernel</p>
</dd>
<dt><a class="reference internal" href="../utils/tsutils/interp.html#pyleoclim.utils.tsutils.interp" title="pyleoclim.utils.tsutils.interp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.tsutils.interp</span></code></a></dt><dd><p>interpolation onto a regular grid (default = linear interpolation)</p>
</dd>
<dt><a class="reference internal" href="../utils/tsutils/grid_properties.html#pyleoclim.utils.tsutils.grid_properties" title="pyleoclim.utils.tsutils.grid_properties"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.tsutils.grid_properties</span></code></a></dt><dd><p>infer grid properties</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="gp">In [2]: </span><span class="kn">import</span> <span class="nn">pyleoclim</span> <span class="k">as</span> <span class="nn">pyleo</span>

<span class="gp">In [3]: </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="gp">In [4]: </span><span class="kn">from</span> <span class="nn">pyleoclim.utils.tsmodel</span> <span class="kn">import</span> <span class="n">colored_noise</span>

<span class="go"># create 2 incompletely sampled series</span>
<span class="gp">In [5]: </span><span class="n">ns</span> <span class="o">=</span> <span class="mi">2</span> <span class="p">;</span> <span class="n">nt</span> <span class="o">=</span> <span class="mi">200</span><span class="p">;</span> <span class="n">n_del</span> <span class="o">=</span> <span class="mi">20</span>

<span class="gp">In [6]: </span><span class="n">serieslist</span> <span class="o">=</span> <span class="p">[]</span>

<span class="gp">In [7]: </span><span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ns</span><span class="p">):</span>
<span class="gp">   ...: </span>    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nt</span><span class="p">)</span>
<span class="gp">   ...: </span>    <span class="n">v</span> <span class="o">=</span> <span class="n">colored_noise</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>
<span class="gp">   ...: </span>    <span class="n">deleted_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">t</span><span class="p">)),</span> <span class="n">n_del</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">   ...: </span>    <span class="n">tu</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">deleted_idx</span><span class="p">)</span>
<span class="gp">   ...: </span>    <span class="n">vu</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">deleted_idx</span><span class="p">)</span>
<span class="gp">   ...: </span>    <span class="n">ts</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">time</span> <span class="o">=</span> <span class="n">tu</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">vu</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;series &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">   ...: </span>    <span class="n">serieslist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span>
<span class="gp">   ...: </span>

<span class="go"># create MS object from the list</span>
<span class="gp">In [8]: </span><span class="n">ms</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">MultipleSeries</span><span class="p">(</span><span class="n">serieslist</span><span class="p">)</span>

<span class="gp">In [9]: </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>

<span class="gp">In [10]: </span><span class="n">ax</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

<span class="go"># apply common_time with default parameters</span>
<span class="gp">In [11]: </span><span class="n">msc</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">common_time</span><span class="p">()</span>

<span class="gp">In [12]: </span><span class="n">msc</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;linear interpolation&#39;</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gh">Out[12]: </span><span class="go">&lt;AxesSubplot:title={&#39;center&#39;:&#39;linear interpolation&#39;}, xlabel=&#39;time&#39;, ylabel=&#39;value&#39;&gt;</span>

<span class="go"># apply common_time with binning</span>
<span class="gp">In [13]: </span><span class="n">msc</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">common_time</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;bin&#39;</span><span class="p">)</span>

<span class="gp">In [14]: </span><span class="n">msc</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Binning&#39;</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gh">Out[14]: </span><span class="go">&lt;AxesSubplot:title={&#39;center&#39;:&#39;Binning&#39;}, xlabel=&#39;time&#39;, ylabel=&#39;value&#39;&gt;</span>

<span class="go"># apply common_time with gkernel</span>
<span class="gp">In [15]: </span><span class="n">msc</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">common_time</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;gkernel&#39;</span><span class="p">)</span>

<span class="gp">In [16]: </span><span class="n">msc</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Gaussian kernel ($h=3$)&#39;</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gh">Out[16]: </span><span class="go">&lt;AxesSubplot:title={&#39;center&#39;:&#39;Gaussian kernel ($h=3$)&#39;}, xlabel=&#39;time&#39;, ylabel=&#39;value&#39;&gt;</span>

<span class="go"># apply common_time with gkernel and a large bandwidth</span>
<span class="gp">In [17]: </span><span class="n">msc</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">common_time</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;gkernel&#39;</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span>

<span class="gp">In [18]: </span><span class="n">msc</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Gaussian kernel ($h=11$)&#39;</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gh">Out[18]: </span><span class="go">&lt;AxesSubplot:title={&#39;center&#39;:&#39;Gaussian kernel ($h=11$)&#39;}, xlabel=&#39;time&#39;, ylabel=&#39;value&#39;&gt;</span>

<span class="go"># display, save and close figure</span>
<span class="gp">In [19]: </span><span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="gp">In [20]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">showfig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
<span class="go">&lt;Figure size 640x480 with 4 Axes&gt;</span>

<span class="gp">In [21]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">closefig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/ms_ct.png" src="../_images/ms_ct.png" />
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.MultipleSeries.convert_time_unit">
<span class="sig-name descname"><span class="pre">convert_time_unit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'years'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#MultipleSeries.convert_time_unit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.MultipleSeries.convert_time_unit" title="Permalink to this definition"></a></dt>
<dd><p>Convert the time unit of the timeseries</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>time_unit</strong> (<em>str</em>) – <p>the target time unit, possible input:
{</p>
<blockquote>
<div><p>’year’, ‘years’, ‘yr’, ‘yrs’,
‘y BP’, ‘yr BP’, ‘yrs BP’, ‘year BP’, ‘years BP’,
‘ky BP’, ‘kyr BP’, ‘kyrs BP’, ‘ka BP’, ‘ka’,
‘my BP’, ‘myr BP’, ‘myrs BP’, ‘ma BP’, ‘ma’,</p>
</div></blockquote>
<p>}</p>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">pyleoclim</span> <span class="k">as</span> <span class="nn">pyleo</span>

<span class="gp">In [2]: </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="gp">In [3]: </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
<span class="gp">   ...: </span>    <span class="s1">&#39;https://raw.githubusercontent.com/LinkedEarth/Pyleoclim_util/Development/example_data/soi_data.csv&#39;</span><span class="p">,</span>
<span class="gp">   ...: </span>    <span class="n">skiprows</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">1</span>
<span class="gp">   ...: </span><span class="p">)</span>
<span class="gp">   ...: </span>

<span class="gp">In [4]: </span><span class="n">time</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>

<span class="gp">In [5]: </span><span class="n">value</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>

<span class="gp">In [6]: </span><span class="n">ts1</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">,</span> <span class="n">time_unit</span><span class="o">=</span><span class="s1">&#39;years&#39;</span><span class="p">)</span>

<span class="gp">In [7]: </span><span class="n">ts2</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">,</span> <span class="n">time_unit</span><span class="o">=</span><span class="s1">&#39;years&#39;</span><span class="p">)</span>

<span class="gp">In [8]: </span><span class="n">ms</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">MultipleSeries</span><span class="p">([</span><span class="n">ts1</span><span class="p">,</span> <span class="n">ts2</span><span class="p">])</span>

<span class="gp">In [9]: </span><span class="n">new_ms</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">convert_time_unit</span><span class="p">(</span><span class="s1">&#39;yr BP&#39;</span><span class="p">)</span>

<span class="gp">In [10]: </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Original timeseries:&#39;</span><span class="p">)</span>
<span class="go">Original timeseries:</span>

<span class="gp">In [11]: </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;time unit:&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">.</span><span class="n">time_unit</span><span class="p">)</span>
<span class="go">time unit: None</span>

<span class="gp">In [12]: </span><span class="nb">print</span><span class="p">()</span>


<span class="gp">In [13]: </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Converted timeseries:&#39;</span><span class="p">)</span>
<span class="go">Converted timeseries:</span>

<span class="gp">In [14]: </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;time unit:&#39;</span><span class="p">,</span> <span class="n">new_ms</span><span class="o">.</span><span class="n">time_unit</span><span class="p">)</span>
<span class="go">time unit: yr BP</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.MultipleSeries.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#MultipleSeries.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.MultipleSeries.copy" title="Permalink to this definition"></a></dt>
<dd><p>Copy the object</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.MultipleSeries.correlation">
<span class="sig-name descname"><span class="pre">correlation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timespan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">settings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fdr_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">common_time_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mute_pbar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#MultipleSeries.correlation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.MultipleSeries.correlation" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the correlation between a MultipleSeries and a target Series</p>
<p>If the target Series is not specified, then the 1st member of MultipleSeries will be the target</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target</strong> (<em>pyleoclim.Series</em><em>, </em><em>optional</em>) – A pyleoclim Series object.</p></li>
<li><p><strong>timespan</strong> (<em>tuple</em>) – The time interval over which to perform the calculation</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) – The significance level (0.05 by default)</p></li>
<li><p><strong>fdr_kwargs</strong> (<em>dict</em>) – Parameters for the FDR function</p></li>
<li><p><strong>settings</strong> (<em>dict</em>) – <p>Parameters for the correlation function, including:</p>
<dl class="simple">
<dt>nsim<span class="classifier">int</span></dt><dd><p>the number of simulations (default: 1000)</p>
</dd>
<dt>method<span class="classifier">str, {‘ttest’,’isopersistent’,’isospectral’ (default)}</span></dt><dd><p>method for significance testing</p>
</dd>
</dl>
</p></li>
<li><p><strong>common_time_kwargs</strong> (<em>dict</em>) – Parameters for the method MultipleSeries.common_time()</p></li>
<li><p><strong>seed</strong> (<em>float</em><em> or </em><em>int</em>) – random seed for isopersistent and isospectral methods</p></li>
<li><p><strong>mute_pbar</strong> (<em>bool</em>) – If True, the progressbar will be muted. Default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>corr</strong> – the result object, see <cite>pyleoclim.ui.CorrEns</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pyleoclim.ui.CorrEns</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="../utils/correlation/corr_sig.html#pyleoclim.utils.correlation.corr_sig" title="pyleoclim.utils.correlation.corr_sig"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.correlation.corr_sig</span></code></a></dt><dd><p>Correlation function</p>
</dd>
<dt><a class="reference internal" href="../utils/correlation/fdr.html#pyleoclim.utils.correlation.fdr" title="pyleoclim.utils.correlation.fdr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.correlation.fdr</span></code></a></dt><dd><p>FDR function</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.ui.CorrEns</span></code></dt><dd><p>the correlation ensemble object</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">pyleoclim</span> <span class="k">as</span> <span class="nn">pyleo</span>

<span class="gp">In [2]: </span><span class="kn">from</span> <span class="nn">pyleoclim.utils.tsmodel</span> <span class="kn">import</span> <span class="n">colored_noise</span>

<span class="gp">In [3]: </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="gp">In [4]: </span><span class="n">nt</span> <span class="o">=</span> <span class="mi">100</span>

<span class="gp">In [5]: </span><span class="n">t0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nt</span><span class="p">)</span>

<span class="gp">In [6]: </span><span class="n">v0</span> <span class="o">=</span> <span class="n">colored_noise</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">t0</span><span class="p">)</span>

<span class="gp">In [7]: </span><span class="n">noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">nt</span><span class="p">)</span>

<span class="gp">In [8]: </span><span class="n">ts0</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">t0</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">v0</span><span class="p">)</span>

<span class="gp">In [9]: </span><span class="n">ts1</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">t0</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">v0</span><span class="o">+</span><span class="n">noise</span><span class="p">)</span>

<span class="gp">In [10]: </span><span class="n">ts2</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">t0</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">v0</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">noise</span><span class="p">)</span>

<span class="gp">In [11]: </span><span class="n">ts3</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">t0</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">v0</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">noise</span><span class="p">)</span>

<span class="gp">In [12]: </span><span class="n">ts_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">ts1</span><span class="p">,</span> <span class="n">ts2</span><span class="p">,</span> <span class="n">ts3</span><span class="p">]</span>

<span class="gp">In [13]: </span><span class="n">ms</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">MultipleSeries</span><span class="p">(</span><span class="n">ts_list</span><span class="p">)</span>

<span class="gp">In [14]: </span><span class="n">ts_target</span> <span class="o">=</span> <span class="n">ts0</span>

<span class="go"># set an arbitrary randome seed to fix the result</span>
<span class="gp">In [15]: </span><span class="n">corr_res</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">correlation</span><span class="p">(</span><span class="n">ts_target</span><span class="p">,</span> <span class="n">settings</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;nsim&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">},</span> <span class="n">seed</span><span class="o">=</span><span class="mi">2333</span><span class="p">)</span>

<span class="gp">In [16]: </span><span class="nb">print</span><span class="p">(</span><span class="n">corr_res</span><span class="p">)</span>
<span class="go">  correlation  p-value    signif. w/o FDR (α: 0.05)    signif. w/ FDR (α: 0.05)</span>
<span class="go">-------------  ---------  ---------------------------  --------------------------</span>
<span class="go">     0.998192  &lt; 1e-6     True                         True</span>
<span class="go">     0.992961  &lt; 1e-6     True                         True</span>
<span class="go">     0.999543  &lt; 1e-6     True                         True</span>
<span class="go">Ensemble size: 3</span>

<span class="go"># set an arbitrary randome seed to fix the result</span>
<span class="gp">In [17]: </span><span class="n">corr_res</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">correlation</span><span class="p">(</span><span class="n">settings</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;nsim&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">},</span> <span class="n">seed</span><span class="o">=</span><span class="mi">2333</span><span class="p">)</span>

<span class="gp">In [18]: </span><span class="nb">print</span><span class="p">(</span><span class="n">corr_res</span><span class="p">)</span>
<span class="go">  correlation  p-value    signif. w/o FDR (α: 0.05)    signif. w/ FDR (α: 0.05)</span>
<span class="go">-------------  ---------  ---------------------------  --------------------------</span>
<span class="go">     1         &lt; 1e-6     True                         True</span>
<span class="go">     0.998285  &lt; 1e-6     True                         True</span>
<span class="go">     0.999553  &lt; 1e-6     True                         True</span>
<span class="go">Ensemble size: 3</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.MultipleSeries.detrend">
<span class="sig-name descname"><span class="pre">detrend</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'emd'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#MultipleSeries.detrend"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.MultipleSeries.detrend" title="Permalink to this definition"></a></dt>
<dd><p>Detrend timeseries</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method</strong> (<em>str</em><em>, </em><em>optional</em>) – <p>The method for detrending. The default is ‘emd’.
Options include:</p>
<blockquote>
<div><ul>
<li><p>linear: the result of a linear least-squares fit to y is subtracted from y.</p></li>
<li><p>constant: only the mean of data is subtrated.</p></li>
<li><p>”savitzky-golay”, y is filtered using the Savitzky-Golay filters and the resulting filtered series is subtracted from y.</p></li>
<li><p>”emd” (default): Empirical mode decomposition. The last mode is assumed to be the trend and removed from the series</p></li>
</ul>
</div></blockquote>
</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>) – Relevant arguments for each of the methods.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>ms</strong> – The detrended timeseries</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pyleoclim.MultipleSeries</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#pyleoclim.core.ui.Series.detrend" title="pyleoclim.core.ui.Series.detrend"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.core.ui.Series.detrend</span></code></a></dt><dd><p>Detrending for a single series</p>
</dd>
<dt><a class="reference internal" href="../utils/tsutils/detrend.html#pyleoclim.utils.tsutils.detrend" title="pyleoclim.utils.tsutils.detrend"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.tsutils.detrend</span></code></a></dt><dd><p>Detrending function</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.MultipleSeries.equal_lengths">
<span class="sig-name descname"><span class="pre">equal_lengths</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#MultipleSeries.equal_lengths"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.MultipleSeries.equal_lengths" title="Permalink to this definition"></a></dt>
<dd><p>Test whether all series in object have equal length</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>None</strong> – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>flag</strong> (<em>boolean</em>)</p></li>
<li><p><strong>lengths</strong> (<em>list containing the lengths of the series in object</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.MultipleSeries.filter">
<span class="sig-name descname"><span class="pre">filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cutoff_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'butterworth'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#MultipleSeries.filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.MultipleSeries.filter" title="Permalink to this definition"></a></dt>
<dd><p>Filtering the timeseries in the MultipleSeries object</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method</strong> (<em>str</em><em>, </em><em>{'savitzky-golay'</em><em>, </em><em>'butterworth'</em><em>, </em><em>'firwin'}</em>) – the filtering method
- ‘butterworth’: the Butterworth method (default)
- ‘savitzky-golay’: the Savitzky-Golay method
- ‘firwin’: FIR filter design using the window method, with default window as Hamming
- ‘lanczos’: lowpass filter via Lanczos resampling</p></li>
<li><p><strong>cutoff_freq</strong> (<em>float</em><em> or </em><em>list</em>) – The cutoff frequency only works with the Butterworth method.
If a float, it is interpreted as a low-frequency cutoff (lowpass).
If a list,  it is interpreted as a frequency band (f1, f2), with f1 &lt; f2 (bandpass).</p></li>
<li><p><strong>cutoff_scale</strong> (<em>float</em><em> or </em><em>list</em>) – cutoff_freq = 1 / cutoff_scale
The cutoff scale only works with the Butterworth method and when cutoff_freq is None.
If a float, it is interpreted as a low-frequency (high-scale) cutoff (lowpass).
If a list,  it is interpreted as a frequency band (f1, f2), with f1 &lt; f2 (bandpass).</p></li>
<li><p><strong>kwargs</strong> (<em>dict</em>) – a dictionary of the keyword arguments for the filtering method,
see <cite>pyleoclim.utils.filter.savitzky_golay</cite>, <cite>pyleoclim.utils.filter.butterworth</cite>, and <cite>pyleoclim.utils.filter.firwin</cite> for the details</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>ms</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pyleoclim.MultipleSeries</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="../utils/filter/butterworth.html#pyleoclim.utils.filter.butterworth" title="pyleoclim.utils.filter.butterworth"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.filter.butterworth</span></code></a></dt><dd><p>Butterworth method</p>
</dd>
<dt><a class="reference internal" href="../utils/filter/savitzky_golay.html#pyleoclim.utils.filter.savitzky_golay" title="pyleoclim.utils.filter.savitzky_golay"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.filter.savitzky_golay</span></code></a></dt><dd><p>Savitzky-Golay method</p>
</dd>
<dt><a class="reference internal" href="../utils/filter/firwin.html#pyleoclim.utils.filter.firwin" title="pyleoclim.utils.filter.firwin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.filter.firwin</span></code></a></dt><dd><p>FIR filter design using the window method</p>
</dd>
<dt><a class="reference internal" href="../utils/filter/lanczos.html#pyleoclim.utils.filter.lanczos" title="pyleoclim.utils.filter.lanczos"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.filter.lanczos</span></code></a></dt><dd><p>lowpass filter via Lanczos resampling</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.MultipleSeries.gkernel">
<span class="sig-name descname"><span class="pre">gkernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#MultipleSeries.gkernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.MultipleSeries.gkernel" title="Permalink to this definition"></a></dt>
<dd><p>Aligns the time axes of a MultipleSeries object, via Gaussian kernel.
This is critical for workflows that need to assume a common time axis
for the group of series under consideration.</p>
<p>The common time axis is characterized by the following parameters:</p>
<p>start : the latest start date of the bunch (maximin of the minima)
stop  : the earliest stop date of the bunch (minimum of the maxima)
step  : The representative spacing between consecutive values (mean of the median spacings)</p>
<p>This is a special case of the common_time function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kwargs</strong> (<em>dict</em>) – Arguments for gkernel. See pyleoclim.utils.tsutils.gkernel for details.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>ms</strong> – The MultipleSeries objects with all series aligned to the same time axis.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pyleoclim.MultipleSeries</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#pyleoclim.core.ui.MultipleSeries.common_time" title="pyleoclim.core.ui.MultipleSeries.common_time"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.core.ui.MultipleSeries.common_time</span></code></a></dt><dd><p>Base function on which this operates</p>
</dd>
<dt><a class="reference internal" href="../utils/tsutils/gkernel.html#pyleoclim.utils.tsutils.gkernel" title="pyleoclim.utils.tsutils.gkernel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.tsutils.gkernel</span></code></a></dt><dd><p>Underlying kernel module</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">pyleoclim</span> <span class="k">as</span> <span class="nn">pyleo</span>

<span class="gp">In [2]: </span><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://wiki.linked.earth/wiki/index.php/Special:WTLiPD?op=export&amp;lipdid=MD982176.Stott.2004&#39;</span>

<span class="gp">In [3]: </span><span class="n">data</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">Lipd</span><span class="p">(</span><span class="n">usr_path</span> <span class="o">=</span> <span class="n">url</span><span class="p">)</span>
<span class="go">Disclaimer: LiPD files may be updated and modified to adhere to standards</span>

<span class="go">reading: MD982176.Stott.2004.lpd</span>
<span class="go">Finished read: 1 record</span>

<span class="gp">In [4]: </span><span class="n">tslist</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">to_LipdSeriesList</span><span class="p">()</span>
<span class="go">extracting paleoData...</span>
<span class="go">extracting: MD982176.Stott.2004</span>
<span class="go">Created time series: 6 entries</span>

<span class="gp">In [5]: </span><span class="n">tslist</span> <span class="o">=</span> <span class="n">tslist</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span> <span class="c1"># drop the first two series which only concerns age and depth</span>

<span class="gp">In [6]: </span><span class="n">ms</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">MultipleSeries</span><span class="p">(</span><span class="n">tslist</span><span class="p">)</span>

<span class="gp">In [7]: </span><span class="n">msk</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">gkernel</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.MultipleSeries.grid_properties">
<span class="sig-name descname"><span class="pre">grid_properties</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step_style</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'median'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#MultipleSeries.grid_properties"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.MultipleSeries.grid_properties" title="Permalink to this definition"></a></dt>
<dd><p>Extract grid properties (start, stop, step) of all the Series objects in
a collection.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>step_style</strong> (<em>str</em>) – <p>Method to obtain a representative step if x is not evenly spaced.
Valid entries: ‘median’ [default], ‘mean’, ‘mode’ or ‘max’
The mode is the most frequent entry in a dataset, and may be a good choice if the timeseries
is nearly equally spaced but for a few gaps.</p>
<p>Max is a conservative choice, appropriate for binning methods and Gaussian kernel coarse-graining</p>
</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>grid_properties</strong> – n x 3 array, where n is the number of series</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.MultipleSeries.interp">
<span class="sig-name descname"><span class="pre">interp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#MultipleSeries.interp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.MultipleSeries.interp" title="Permalink to this definition"></a></dt>
<dd><p>Aligns the time axes of a MultipleSeries object, via interpolation.
This is critical for workflows that need to assume a common time axis
for the group of series under consideration.</p>
<p>The common time axis is characterized by the following parameters:</p>
<p>start : the latest start date of the bunch (maximin of the minima)
stop  : the earliest stop date of the bunch (minimum of the maxima)
step  : The representative spacing between consecutive values (mean of the median spacings)</p>
<p>This is a special case of the common_time function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kwargs</strong> (<em>keyword arguments</em><em> (</em><em>dictionary</em><em>) </em><em>for the interpolation method</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>ms</strong> – The MultipleSeries objects with all series aligned to the same time axis.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pyleoclim.MultipleSeries</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#pyleoclim.core.ui.MultipleSeries.common_time" title="pyleoclim.core.ui.MultipleSeries.common_time"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.core.ui.MultipleSeries.common_time</span></code></a></dt><dd><p>Base function on which this operates</p>
</dd>
<dt><a class="reference internal" href="../utils/tsutils/interp.html#pyleoclim.utils.tsutils.interp" title="pyleoclim.utils.tsutils.interp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.tsutils.interp</span></code></a></dt><dd><p>Underlying interpolation function</p>
</dd>
<dt><a class="reference internal" href="#pyleoclim.core.ui.Series.interp" title="pyleoclim.core.ui.Series.interp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.core.ui.Series.interp</span></code></a></dt><dd><p>Interpolation function for Series object</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">pyleoclim</span> <span class="k">as</span> <span class="nn">pyleo</span>

<span class="gp">In [2]: </span><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://wiki.linked.earth/wiki/index.php/Special:WTLiPD?op=export&amp;lipdid=MD982176.Stott.2004&#39;</span>

<span class="gp">In [3]: </span><span class="n">data</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">Lipd</span><span class="p">(</span><span class="n">usr_path</span> <span class="o">=</span> <span class="n">url</span><span class="p">)</span>
<span class="go">Disclaimer: LiPD files may be updated and modified to adhere to standards</span>

<span class="go">reading: MD982176.Stott.2004.lpd</span>
<span class="go">Finished read: 1 record</span>

<span class="gp">In [4]: </span><span class="n">tslist</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">to_LipdSeriesList</span><span class="p">()</span>
<span class="go">extracting paleoData...</span>
<span class="go">extracting: MD982176.Stott.2004</span>
<span class="go">Created time series: 6 entries</span>

<span class="gp">In [5]: </span><span class="n">tslist</span> <span class="o">=</span> <span class="n">tslist</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span> <span class="c1"># drop the first two series which only concerns age and depth</span>

<span class="gp">In [6]: </span><span class="n">ms</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">MultipleSeries</span><span class="p">(</span><span class="n">tslist</span><span class="p">)</span>

<span class="gp">In [7]: </span><span class="n">msinterp</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">interp</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.MultipleSeries.pca">
<span class="sig-name descname"><span class="pre">pca</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">missing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fill-em'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol_em</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.005</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_em_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">pca_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#MultipleSeries.pca"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.MultipleSeries.pca" title="Permalink to this definition"></a></dt>
<dd><p>Principal Component Analysis (Empirical Orthogonal Functions)</p>
<p>Decomposition of dataset ys in terms of orthogonal basis functions.
Tolerant to missing values, infilled by an EM algorithm.
Requires ncomp to be less than the number of missing values.</p>
<p>Do make sure the time axes are aligned, however! (e.g. use <cite>common_time()</cite>)</p>
<p>Algorithm from statsmodels: <a class="reference external" href="https://www.statsmodels.org/stable/generated/statsmodels.multivariate.pca.PCA.html">https://www.statsmodels.org/stable/generated/statsmodels.multivariate.pca.PCA.html</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>weights</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – Series weights to use after transforming data according to standardize
or demean when computing the principal components.</p></li>
<li><p><strong>missing</strong> (<em>{str</em><em>, </em><em>None}</em>) – <p>Method for missing data.  Choices are:</p>
<ul>
<li><p>’drop-row’ - drop rows with missing values.</p></li>
<li><p>’drop-col’ - drop columns with missing values.</p></li>
<li><p>’drop-min’ - drop either rows or columns, choosing by data retention.</p></li>
<li><p>’fill-em’ - use EM algorithm to fill missing value.  ncomp should be
set to the number of factors required.</p></li>
<li><p><cite>None</cite> raises if data contains NaN values.</p></li>
</ul>
</p></li>
<li><p><strong>tol_em</strong> (<em>float</em>) – Tolerance to use when checking for convergence of the EM algorithm.</p></li>
<li><p><strong>max_em_iter</strong> (<em>int</em>) – Maximum iterations for the EM algorithm.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyleoclim.core.ui.MultipleSeries.res">
<span class="sig-name descname"><span class="pre">res</span></span><a class="headerlink" href="#pyleoclim.core.ui.MultipleSeries.res" title="Permalink to this definition"></a></dt>
<dd><p>the result object, see <cite>pyleoclim.ui.SpatialDecomp</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>pyleoclim.ui.SpatialDecomp</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">pyleoclim</span> <span class="k">as</span> <span class="nn">pyleo</span>

<span class="gp">In [2]: </span><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://wiki.linked.earth/wiki/index.php/Special:WTLiPD?op=export&amp;lipdid=MD982176.Stott.2004&#39;</span>

<span class="gp">In [3]: </span><span class="n">data</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">Lipd</span><span class="p">(</span><span class="n">usr_path</span> <span class="o">=</span> <span class="n">url</span><span class="p">)</span>
<span class="go">Disclaimer: LiPD files may be updated and modified to adhere to standards</span>

<span class="go">reading: MD982176.Stott.2004.lpd</span>
<span class="go">Finished read: 1 record</span>

<span class="gp">In [4]: </span><span class="n">tslist</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">to_LipdSeriesList</span><span class="p">()</span>
<span class="go">extracting paleoData...</span>
<span class="go">extracting: MD982176.Stott.2004</span>
<span class="go">Created time series: 6 entries</span>

<span class="gp">In [5]: </span><span class="n">tslist</span> <span class="o">=</span> <span class="n">tslist</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span> <span class="c1"># drop the first two series which only concerns age and depth</span>

<span class="gp">In [6]: </span><span class="n">ms</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">MultipleSeries</span><span class="p">(</span><span class="n">tslist</span><span class="p">)</span><span class="o">.</span><span class="n">common_time</span><span class="p">()</span>

<span class="gp">In [7]: </span><span class="n">res</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">pca</span><span class="p">()</span> <span class="c1"># carry out PCA</span>

<span class="gp">In [8]: </span><span class="n">res</span><span class="o">.</span><span class="n">screeplot</span><span class="p">()</span> <span class="c1"># plot the eigenvalue spectrum</span>
<span class="go">&lt;Figure size 600x400 with 1 Axes&gt;</span>
<span class="gh">Out[8]: </span><span class="go"></span>
<span class="go">(&lt;Figure size 600x400 with 1 Axes&gt;,</span>
<span class="go"> &lt;AxesSubplot:title={&#39;center&#39;:&#39;scree plot&#39;}, xlabel=&#39;Mode index $i$&#39;, ylabel=&#39;$\\lambda_i$&#39;&gt;)</span>

<span class="gp">In [9]: </span><span class="n">res</span><span class="o">.</span><span class="n">modeplot</span><span class="p">()</span> <span class="c1"># plot the first mode</span>
<span class="go">&lt;Figure size 1000x500 with 3 Axes&gt;</span>
<span class="gh">Out[9]: </span><span class="go">(&lt;Figure size 1000x500 with 3 Axes&gt;, GridSpec(2, 2))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.MultipleSeries.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[10,</span> <span class="pre">4]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marker</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">markersize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linestyle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tab10'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lgd_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savefig_settings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">invert_xaxis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#MultipleSeries.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.MultipleSeries.plot" title="Permalink to this definition"></a></dt>
<dd><p>Plot multiple timeseries on the same axis</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>list</em><em>, </em><em>optional</em>) – Size of the figure. The default is [10, 4].</p></li>
<li><p><strong>marker</strong> (<em>str</em><em>, </em><em>optional</em>) – marker type. The default is None.</p></li>
<li><p><strong>markersize</strong> (<em>float</em><em>, </em><em>optional</em>) – marker size. The default is None.</p></li>
<li><p><strong>colors</strong> (<em>a list of</em><em>, or </em><em>one</em><em>, </em><em>Python supported color code</em><em> (</em><em>a string of hex code</em><em> or </em><em>a tuple of rgba values</em><em>)</em>) – Colors for plotting.
If None, the plotting will cycle the ‘tab10’ colormap;
if only one color is specified, then all curves will be plotted with that single color;
if a list of colors are specified, then the plotting will cycle that color list.</p></li>
<li><p><strong>cmap</strong> (<em>str</em>) – The colormap to use when “colors” is None.</p></li>
<li><p><strong>norm</strong> (<em>matplotlib.colors.Normalize like</em>) – The nomorlization for the colormap.
If None, a linear normalization will be used.</p></li>
<li><p><strong>linestyle</strong> (<em>str</em><em>, </em><em>optional</em>) – Line style. The default is None.</p></li>
<li><p><strong>linewidth</strong> (<em>float</em><em>, </em><em>optional</em>) – The width of the line. The default is None.</p></li>
<li><p><strong>xlabel</strong> (<em>str</em><em>, </em><em>optional</em>) – x-axis label. The default is None.</p></li>
<li><p><strong>ylabel</strong> (<em>str</em><em>, </em><em>optional</em>) – y-axis label. The default is None.</p></li>
<li><p><strong>title</strong> (<em>str</em><em>, </em><em>optional</em>) – Title. The default is None.</p></li>
<li><p><strong>legend</strong> (<em>bool</em><em>, </em><em>optional</em>) – Wether the show the legend. The default is True.</p></li>
<li><p><strong>plot_kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Plot parameters. The default is None.</p></li>
<li><p><strong>lgd_kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Legend parameters. The default is None.</p></li>
<li><p><strong>savefig_settings</strong> (<em>dictionary</em><em>, </em><em>optional</em>) – <p>the dictionary of arguments for plt.savefig(); some notes below:
- “path” must be specified; it can be any existed or non-existed path,</p>
<blockquote>
<div><p>with or without a suffix; if the suffix is not given in “path”, it will follow “format”</p>
</div></blockquote>
<ul>
<li><p>”format” can be one of {“pdf”, “eps”, “png”, “ps”} The default is None.</p></li>
</ul>
</p></li>
<li><p><strong>ax</strong> (<em>matplotlib.ax</em><em>, </em><em>optional</em>) – The matplotlib axis onto which to return the figure. The default is None.</p></li>
<li><p><strong>mute</strong> (<em>bool</em><em>, </em><em>optional</em>) – if True, the plot will not show;
recommend to turn on when more modifications are going to be made on ax</p></li>
<li><p><strong>invert_xaxis</strong> (<em>bool</em><em>, </em><em>optional</em>) – if True, the x-axis of the plot will be inverted</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>fig, ax</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.MultipleSeries.spectral">
<span class="sig-name descname"><span class="pre">spectral</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'lomb_scargle'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">settings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mute_pbar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'log'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#MultipleSeries.spectral"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.MultipleSeries.spectral" title="Permalink to this definition"></a></dt>
<dd><p>Perform spectral analysis on the timeseries</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method</strong> (<em>str</em>) – {‘wwz’, ‘mtm’, ‘lomb_scargle’, ‘welch’, ‘periodogram’}</p></li>
<li><p><strong>freq_method</strong> (<em>str</em>) – {‘log’,’scale’, ‘nfft’, ‘lomb_scargle’, ‘welch’}</p></li>
<li><p><strong>freq_kwargs</strong> (<em>dict</em>) – Arguments for frequency vector</p></li>
<li><p><strong>settings</strong> (<em>dict</em>) – Arguments for the specific spectral method</p></li>
<li><p><strong>label</strong> (<em>str</em>) – Label for the PSD object</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – If True, will print warning messages if there is any</p></li>
<li><p><strong>mute_pbar</strong> (<em>{True</em><em>, </em><em>False}</em>) – Mute the progress bar. Default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>psd</strong> – A Multiple PSD object</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pyleoclim.MultiplePSD</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="../utils/spectral/mtm.html#pyleoclim.utils.spectral.mtm" title="pyleoclim.utils.spectral.mtm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.spectral.mtm</span></code></a></dt><dd><p>Spectral analysis using the Multitaper approach</p>
</dd>
<dt><a class="reference internal" href="../utils/spectral/lombscargle.html#pyleoclim.utils.spectral.lomb_scargle" title="pyleoclim.utils.spectral.lomb_scargle"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.spectral.lomb_scargle</span></code></a></dt><dd><p>Spectral analysis using the Lomb-Scargle method</p>
</dd>
<dt><a class="reference internal" href="../utils/spectral/welch.html#pyleoclim.utils.spectral.welch" title="pyleoclim.utils.spectral.welch"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.spectral.welch</span></code></a></dt><dd><p>Spectral analysis using the Welch segement approach</p>
</dd>
<dt><a class="reference internal" href="../utils/spectral/periodogram.html#pyleoclim.utils.spectral.periodogram" title="pyleoclim.utils.spectral.periodogram"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.spectral.periodogram</span></code></a></dt><dd><p>Spectral anaysis using the basic Fourier transform</p>
</dd>
<dt><a class="reference internal" href="../utils/spectral/wwz_psd.html#pyleoclim.utils.spectral.wwz_psd" title="pyleoclim.utils.spectral.wwz_psd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.spectral.wwz_psd</span></code></a></dt><dd><p>Spectral analysis using the Wavelet Weighted Z transform</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.wavelet.make_freq</span></code></dt><dd><p>Functions to create the frequency vector</p>
</dd>
<dt><a class="reference internal" href="../utils/tsutils/detrend.html#pyleoclim.utils.tsutils.detrend" title="pyleoclim.utils.tsutils.detrend"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.tsutils.detrend</span></code></a></dt><dd><p>Detrending function</p>
</dd>
<dt><a class="reference internal" href="#pyleoclim.core.ui.Series.spectral" title="pyleoclim.core.ui.Series.spectral"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.core.ui.Series.spectral</span></code></a></dt><dd><p>Spectral analysis for a single timeseries</p>
</dd>
<dt><a class="reference internal" href="#pyleoclim.core.ui.PSD" title="pyleoclim.core.ui.PSD"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.core.ui.PSD</span></code></a></dt><dd><p>PSD object</p>
</dd>
<dt><a class="reference internal" href="#pyleoclim.core.ui.MultiplePSD" title="pyleoclim.core.ui.MultiplePSD"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.core.ui.MultiplePSD</span></code></a></dt><dd><p>Multiple PSD object</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.MultipleSeries.stackplot">
<span class="sig-name descname"><span class="pre">stackplot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savefig_settings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_between_alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tab10'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spine_lw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_lw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">font_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_x_loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">0.15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_shift_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.75</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#MultipleSeries.stackplot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.MultipleSeries.stackplot" title="Permalink to this definition"></a></dt>
<dd><p>Stack plot of multiple series</p>
<p>Note that the plotting style is uniquely designed for this one and cannot be properly reset with <cite>pyleoclim.set_style()</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>list</em>) – Size of the figure.</p></li>
<li><p><strong>colors</strong> (<em>a list of</em><em>, or </em><em>one</em><em>, </em><em>Python supported color code</em><em> (</em><em>a string of hex code</em><em> or </em><em>a tuple of rgba values</em><em>)</em>) – Colors for plotting.
If None, the plotting will cycle the ‘tab10’ colormap;
if only one color is specified, then all curves will be plotted with that single color;
if a list of colors are specified, then the plotting will cycle that color list.</p></li>
<li><p><strong>cmap</strong> (<em>str</em>) – The colormap to use when “colors” is None.</p></li>
<li><p><strong>norm</strong> (<em>matplotlib.colors.Normalize like</em>) – The nomorlization for the colormap.
If None, a linear normalization will be used.</p></li>
<li><p><strong>savefig_settings</strong> (<em>dictionary</em>) – <p>the dictionary of arguments for plt.savefig(); some notes below:
- “path” must be specified; it can be any existed or non-existed path,</p>
<blockquote>
<div><p>with or without a suffix; if the suffix is not given in “path”, it will follow “format”</p>
</div></blockquote>
<ul>
<li><p>”format” can be one of {“pdf”, “eps”, “png”, “ps”} The default is None.</p></li>
</ul>
</p></li>
<li><p><strong>xlim</strong> (<em>list</em>) – The x-axis limit.</p></li>
<li><p><strong>fill_between_alpha</strong> (<em>float</em>) – The transparency for the fill_between shades.</p></li>
<li><p><strong>spine_lw</strong> (<em>float</em>) – The linewidth for the spines of the axes.</p></li>
<li><p><strong>grid_lw</strong> (<em>float</em>) – The linewidth for the gridlines.</p></li>
<li><p><strong>linewidth</strong> (<em>float</em>) – The linewidth for the curves.</p></li>
<li><p><strong>font_scale</strong> (<em>float</em>) – The scale for the font sizes. Default is 0.8.</p></li>
<li><p><strong>label_x_loc</strong> (<em>float</em>) – The x location for the label of each curve.</p></li>
<li><p><strong>v_shift_factor</strong> (<em>float</em>) – The factor for the vertical shift of each axis.
The default value 3/4 means the top of the next axis will be located at 3/4 of the height of the previous one.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>fig, ax</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">pyleoclim</span> <span class="k">as</span> <span class="nn">pyleo</span>

<span class="gp">In [2]: </span><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://wiki.linked.earth/wiki/index.php/Special:WTLiPD?op=export&amp;lipdid=MD982176.Stott.2004&#39;</span>

<span class="gp">In [3]: </span><span class="n">data</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">Lipd</span><span class="p">(</span><span class="n">usr_path</span> <span class="o">=</span> <span class="n">url</span><span class="p">)</span>
<span class="go">Disclaimer: LiPD files may be updated and modified to adhere to standards</span>

<span class="go">reading: MD982176.Stott.2004.lpd</span>
<span class="go">Finished read: 1 record</span>

<span class="gp">In [4]: </span><span class="n">tslist</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">to_LipdSeriesList</span><span class="p">()</span>
<span class="go">extracting paleoData...</span>
<span class="go">extracting: MD982176.Stott.2004</span>
<span class="go">Created time series: 6 entries</span>

<span class="gp">In [5]: </span><span class="n">tslist</span> <span class="o">=</span> <span class="n">tslist</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span> <span class="c1"># drop the first two series which only concerns age and depth</span>

<span class="gp">In [6]: </span><span class="n">ms</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">MultipleSeries</span><span class="p">(</span><span class="n">tslist</span><span class="p">)</span>

<span class="gp">In [7]: </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">stackplot</span><span class="p">()</span>
<span class="go">&lt;Figure size 640x480 with 5 Axes&gt;</span>

<span class="gp">In [8]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">closefig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/mts_stackplot.png" src="../_images/mts_stackplot.png" />
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.MultipleSeries.standardize">
<span class="sig-name descname"><span class="pre">standardize</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#MultipleSeries.standardize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.MultipleSeries.standardize" title="Permalink to this definition"></a></dt>
<dd><p>Standardize each series object in a collection</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>ms</strong> – The standardized Series</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>pyleoclim.MultipleSeries</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.MultipleSeries.wavelet">
<span class="sig-name descname"><span class="pre">wavelet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'wwz'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">settings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'log'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ntau</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mute_pbar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#MultipleSeries.wavelet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.MultipleSeries.wavelet" title="Permalink to this definition"></a></dt>
<dd><p>Wavelet analysis</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method</strong> (<em>{wwz</em><em>, </em><em>cwt}</em>) – Whether to use the wwz method for unevenly spaced timeseries or traditional cwt (from pywavelets)</p></li>
<li><p><strong>settings</strong> (<em>dict</em>) – Settings for the particular method. The default is {}.</p></li>
<li><p><strong>freq_method</strong> (<em>str</em>) – {‘log’, ‘scale’, ‘nfft’, ‘lomb_scargle’, ‘welch’}</p></li>
<li><p><strong>freq_kwargs</strong> (<em>dict</em>) – Arguments for frequency vector</p></li>
<li><p><strong>ntau</strong> (<em>int</em>) – The length of the time shift points that determins the temporal resolution of the result.
If None, it will be either the length of the input time axis, or at most 100.</p></li>
<li><p><strong>settings</strong> – Arguments for the specific spectral method</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – If True, will print warning messages if there is any</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>mute_pbar<span class="classifier">bool, optional</span></dt><dd><p>Whether to mute the progress bar. The default is False.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>scals</strong></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>pyleoclim.MultipleScalograms</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="../utils/wavelet/wwz.html#pyleoclim.utils.wavelet.wwz" title="pyleoclim.utils.wavelet.wwz"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.wavelet.wwz</span></code></a></dt><dd><p>wwz function</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.wavelet.make_freq</span></code></dt><dd><p>Functions to create the frequency vector</p>
</dd>
<dt><a class="reference internal" href="../utils/tsutils/detrend.html#pyleoclim.utils.tsutils.detrend" title="pyleoclim.utils.tsutils.detrend"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.tsutils.detrend</span></code></a></dt><dd><p>Detrending function</p>
</dd>
<dt><a class="reference internal" href="#pyleoclim.core.ui.Series.wavelet" title="pyleoclim.core.ui.Series.wavelet"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.core.ui.Series.wavelet</span></code></a></dt><dd><p>wavelet analysis on single object</p>
</dd>
<dt><a class="reference internal" href="#pyleoclim.core.ui.MultipleScalogram" title="pyleoclim.core.ui.MultipleScalogram"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.core.ui.MultipleScalogram</span></code></a></dt><dd><p>Multiple Scalogram object</p>
</dd>
</dl>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="ensembleseries-pyleoclim-ensembleseries">
<h2>EnsembleSeries (pyleoclim.EnsembleSeries)<a class="headerlink" href="#ensembleseries-pyleoclim-ensembleseries" title="Permalink to this headline"></a></h2>
<p>The EnsembleSeries class is a child of MultipleSeries, designed for ensemble applications (e.g. draws from a posterior distribution of ages, model ensembles with randomized initial conditions, or some other stochastic ensemble).
Compared to a MultipleSeries object, an EnsembleSeries object has the following properties:  [TO BE COMPLETED]</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyleoclim.core.ui.EnsembleSeries">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pyleoclim.core.ui.</span></span><span class="sig-name descname"><span class="pre">EnsembleSeries</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">series_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#EnsembleSeries"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.EnsembleSeries" title="Permalink to this definition"></a></dt>
<dd><p>EnsembleSeries object</p>
<p>The EnsembleSeries object is a child of the MultipleSeries object, that is, a special case of MultipleSeries, aiming for ensembles of similar series.
Ensembles usually arise from age modeling or Bayesian calibrations. All members of an EnsembleSeries object are assumed to share identical labels and units.</p>
<p>All methods available for MultipleSeries are available for EnsembleSeries. Some functions were modified for the special case of ensembles.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">append</span></code>(ts)</p></td>
<td><p>Append timeseries ts to MultipleSeries object</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">bin</span></code>(**kwargs)</p></td>
<td><p>Aligns the time axes of a MultipleSeries object, via binning.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">common_time</span></code>([method, common_step, start, ...])</p></td>
<td><p>Aligns the time axes of a MultipleSeries object, via binning interpolation., or Gaussian kernel.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">convert_time_unit</span></code>([time_unit])</p></td>
<td><p>Convert the time unit of the timeseries</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy</span></code>()</p></td>
<td><p>Copy the object</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyleoclim.core.ui.EnsembleSeries.correlation" title="pyleoclim.core.ui.EnsembleSeries.correlation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">correlation</span></code></a>([target, timespan, alpha, ...])</p></td>
<td><p>Calculate the correlation between an EnsembleSeries object to a target.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">detrend</span></code>([method])</p></td>
<td><p>Detrend timeseries</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyleoclim.core.ui.EnsembleSeries.distplot" title="pyleoclim.core.ui.EnsembleSeries.distplot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">distplot</span></code></a>([figsize, title, savefig_settings, ...])</p></td>
<td><p>Plots the distribution of the timeseries across ensembles</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">equal_lengths</span></code>()</p></td>
<td><p>Test whether all series in object have equal length</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter</span></code>([cutoff_freq, cutoff_scale, method])</p></td>
<td><p>Filtering the timeseries in the MultipleSeries object</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">gkernel</span></code>(**kwargs)</p></td>
<td><p>Aligns the time axes of a MultipleSeries object, via Gaussian kernel.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">grid_properties</span></code>([step_style])</p></td>
<td><p>Extract grid properties (start, stop, step) of all the Series objects in a collection.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">interp</span></code>(**kwargs)</p></td>
<td><p>Aligns the time axes of a MultipleSeries object, via interpolation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyleoclim.core.ui.EnsembleSeries.make_labels" title="pyleoclim.core.ui.EnsembleSeries.make_labels"><code class="xref py py-obj docutils literal notranslate"><span class="pre">make_labels</span></code></a>()</p></td>
<td><p>Initialization of labels</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">pca</span></code>([weights, missing, tol_em, max_em_iter])</p></td>
<td><p>Principal Component Analysis (Empirical Orthogonal Functions)</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot</span></code>([figsize, marker, markersize, ...])</p></td>
<td><p>Plot multiple timeseries on the same axis</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyleoclim.core.ui.EnsembleSeries.plot_envelope" title="pyleoclim.core.ui.EnsembleSeries.plot_envelope"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_envelope</span></code></a>([figsize, qs, xlabel, ylabel, ...])</p></td>
<td><p>Plot EnsembleSeries as an envelope.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyleoclim.core.ui.EnsembleSeries.plot_traces" title="pyleoclim.core.ui.EnsembleSeries.plot_traces"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_traces</span></code></a>([figsize, xlabel, ylabel, ...])</p></td>
<td><p>Plot EnsembleSeries as a subset of traces.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyleoclim.core.ui.EnsembleSeries.quantiles" title="pyleoclim.core.ui.EnsembleSeries.quantiles"><code class="xref py py-obj docutils literal notranslate"><span class="pre">quantiles</span></code></a>([qs])</p></td>
<td><p>Calculate quantiles of an EnsembleSeries object</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">spectral</span></code>([method, settings, mute_pbar, ...])</p></td>
<td><p>Perform spectral analysis on the timeseries</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyleoclim.core.ui.EnsembleSeries.stackplot" title="pyleoclim.core.ui.EnsembleSeries.stackplot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">stackplot</span></code></a>([figsize, savefig_settings, xlim, ...])</p></td>
<td><p>Stack plot of multiple series</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">standardize</span></code>()</p></td>
<td><p>Standardize each series object in a collection</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">wavelet</span></code>([method, settings, freq_method, ...])</p></td>
<td><p>Wavelet analysis</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.EnsembleSeries.correlation">
<span class="sig-name descname"><span class="pre">correlation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timespan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">settings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fdr_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">common_time_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mute_pbar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#EnsembleSeries.correlation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.EnsembleSeries.correlation" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the correlation between an EnsembleSeries object to a target.</p>
<p>If the target is not specified, then the 1st member of the ensemble will be the target
Note that the FDR approach is applied by default to determine the significance of the p-values (more information in See Also below).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target</strong> (<em>pyleoclim.Series</em><em> or </em><em>pyleoclim.EnsembleSeries</em><em>, </em><em>optional</em>) – A pyleoclim Series object or EnsembleSeries object.
When the target is also an EnsembleSeries object, then the calculation of correlation is performed in a one-to-one sense,
and the ourput list of correlation values and p-values will be the size of the series_list of the self object.
That is, if the self object contains n Series, and the target contains n+m Series,
then only the first n Series from the object will be used for the calculation;
otherwise, if the target contains only n-m Series, then the first m Series in the target will be used twice in sequence.</p></li>
<li><p><strong>timespan</strong> (<em>tuple</em>) – The time interval over which to perform the calculation</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) – The significance level (0.05 by default)</p></li>
<li><p><strong>settings</strong> (<em>dict</em>) – <p>Parameters for the correlation function, including:</p>
<dl class="simple">
<dt>nsim<span class="classifier">int</span></dt><dd><p>the number of simulations (default: 1000)</p>
</dd>
<dt>method<span class="classifier">str, {‘ttest’,’isopersistent’,’isospectral’ (default)}</span></dt><dd><p>method for significance testing</p>
</dd>
</dl>
</p></li>
<li><p><strong>fdr_kwargs</strong> (<em>dict</em>) – Parameters for the FDR function</p></li>
<li><p><strong>common_time_kwargs</strong> (<em>dict</em>) – Parameters for the method MultipleSeries.common_time()</p></li>
<li><p><strong>mute_pbar</strong> (<em>bool</em>) – If True, the progressbar will be muted. Default is False.</p></li>
<li><p><strong>seed</strong> (<em>float</em><em> or </em><em>int</em>) – random seed for isopersistent and isospectral methods</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>corr</strong> – the result object, see <cite>pyleoclim.ui.CorrEns</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pyleoclim.ui.CorrEns</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="../utils/correlation/corr_sig.html#pyleoclim.utils.correlation.corr_sig" title="pyleoclim.utils.correlation.corr_sig"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.correlation.corr_sig</span></code></a></dt><dd><p>Correlation function</p>
</dd>
<dt><a class="reference internal" href="../utils/correlation/fdr.html#pyleoclim.utils.correlation.fdr" title="pyleoclim.utils.correlation.fdr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.correlation.fdr</span></code></a></dt><dd><p>FDR function</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.ui.CorrEns</span></code></dt><dd><p>the correlation ensemble object</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">pyleoclim</span> <span class="k">as</span> <span class="nn">pyleo</span>

<span class="gp">In [2]: </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="gp">In [3]: </span><span class="kn">from</span> <span class="nn">pyleoclim.utils.tsmodel</span> <span class="kn">import</span> <span class="n">colored_noise</span>

<span class="gp">In [4]: </span><span class="n">nt</span> <span class="o">=</span> <span class="mi">100</span>

<span class="gp">In [5]: </span><span class="n">t0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nt</span><span class="p">)</span>

<span class="gp">In [6]: </span><span class="n">v0</span> <span class="o">=</span> <span class="n">colored_noise</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">t0</span><span class="p">)</span>

<span class="gp">In [7]: </span><span class="n">noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">nt</span><span class="p">)</span>

<span class="gp">In [8]: </span><span class="n">ts0</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">t0</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">v0</span><span class="p">)</span>

<span class="gp">In [9]: </span><span class="n">ts1</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">t0</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">v0</span><span class="o">+</span><span class="n">noise</span><span class="p">)</span>

<span class="gp">In [10]: </span><span class="n">ts2</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">t0</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">v0</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">noise</span><span class="p">)</span>

<span class="gp">In [11]: </span><span class="n">ts3</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">t0</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">v0</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">noise</span><span class="p">)</span>

<span class="gp">In [12]: </span><span class="n">ts_list1</span> <span class="o">=</span> <span class="p">[</span><span class="n">ts0</span><span class="p">,</span> <span class="n">ts1</span><span class="p">]</span>

<span class="gp">In [13]: </span><span class="n">ts_list2</span> <span class="o">=</span> <span class="p">[</span><span class="n">ts2</span><span class="p">,</span> <span class="n">ts3</span><span class="p">]</span>

<span class="gp">In [14]: </span><span class="n">ts_ens</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">EnsembleSeries</span><span class="p">(</span><span class="n">ts_list1</span><span class="p">)</span>

<span class="gp">In [15]: </span><span class="n">ts_target</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">EnsembleSeries</span><span class="p">(</span><span class="n">ts_list2</span><span class="p">)</span>

<span class="go"># set an arbitrary randome seed to fix the result</span>
<span class="gp">In [16]: </span><span class="n">corr_res</span> <span class="o">=</span> <span class="n">ts_ens</span><span class="o">.</span><span class="n">correlation</span><span class="p">(</span><span class="n">ts_target</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">2333</span><span class="p">)</span>

<span class="gp">In [17]: </span><span class="nb">print</span><span class="p">(</span><span class="n">corr_res</span><span class="p">)</span>
<span class="go">  correlation  p-value    signif. w/o FDR (α: 0.05)    signif. w/ FDR (α: 0.05)</span>
<span class="go">-------------  ---------  ---------------------------  --------------------------</span>
<span class="go">     0.991122  &lt; 1e-6     True                         True</span>
<span class="go">     0.999445  &lt; 1e-6     True                         True</span>
<span class="go">Ensemble size: 2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.EnsembleSeries.distplot">
<span class="sig-name descname"><span class="pre">distplot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[10,</span> <span class="pre">4]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savefig_settings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'KDE'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vertical</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edgecolor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'w'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">plot_kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#EnsembleSeries.distplot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.EnsembleSeries.distplot" title="Permalink to this definition"></a></dt>
<dd><p>Plots the distribution of the timeseries across ensembles</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>list</em><em>, </em><em>optional</em>) – The size of the figure. The default is [10, 4].</p></li>
<li><p><strong>title</strong> (<em>str</em><em>, </em><em>optional</em>) – Title for the figure. The default is None.</p></li>
<li><p><strong>savefig_settings</strong> (<em>dict</em><em>, </em><em>optional</em>) – <dl class="simple">
<dt>the dictionary of arguments for plt.savefig(); some notes below:</dt><dd><ul>
<li><p>”path” must be specified; it can be any existed or non-existed path,
with or without a suffix; if the suffix is not given in “path”, it will follow “format”</p></li>
<li><p>”format” can be one of {“pdf”, “eps”, “png”, “ps”}.</p></li>
</ul>
</dd>
</dl>
<p>The default is None.</p>
</p></li>
<li><p><strong>ax</strong> (<em>matplotlib.axis</em><em>, </em><em>optional</em>) – A matplotlib axis. The default is None.</p></li>
<li><p><strong>ylabel</strong> (<em>str</em><em>, </em><em>optional</em>) – Label for the count axis. The default is ‘KDE’.</p></li>
<li><p><strong>vertical</strong> (<em>{True</em><em>,</em><em>False}</em><em>, </em><em>optional</em>) – Whether to flip the plot vertically. The default is False.</p></li>
<li><p><strong>edgecolor</strong> (<em>matplotlib.color</em><em>, </em><em>optional</em>) – The color of the edges of the bar. The default is ‘w’.</p></li>
<li><p><strong>mute</strong> (<em>{True</em><em>,</em><em>False}</em><em>, </em><em>optional</em>) – <dl class="simple">
<dt>if True, the plot will not show;</dt><dd><p>recommend to turn on when more modifications are going to be made on ax. The default is False.</p>
</dd>
</dl>
</p></li>
<li><p><strong>**plot_kwargs</strong> (<em>dict</em>) – Plotting arguments for seaborn histplot: <a class="reference external" href="https://seaborn.pydata.org/generated/seaborn.histplot.html">https://seaborn.pydata.org/generated/seaborn.histplot.html</a>.</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="../utils/plotting/savefig.html#pyleoclim.utils.plotting.savefig" title="pyleoclim.utils.plotting.savefig"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.plotting.savefig</span></code></a></dt><dd><p>saving figure in Pyleoclim</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.EnsembleSeries.make_labels">
<span class="sig-name descname"><span class="pre">make_labels</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#EnsembleSeries.make_labels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.EnsembleSeries.make_labels" title="Permalink to this definition"></a></dt>
<dd><p>Initialization of labels</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>time_header</strong> (<em>str</em>) – Label for the time axis</p></li>
<li><p><strong>value_header</strong> (<em>str</em>) – Label for the value axis</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.EnsembleSeries.plot_envelope">
<span class="sig-name descname"><span class="pre">plot_envelope</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[10,</span> <span class="pre">4]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.025,</span> <span class="pre">0.25,</span> <span class="pre">0.5,</span> <span class="pre">0.75,</span> <span class="pre">0.975]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savefig_settings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">curve_clr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'#d9544d'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">curve_lw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shade_clr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'#d9544d'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shade_alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inner_shade_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'IQR'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outer_shade_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'95%</span> <span class="pre">CI'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lgd_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#EnsembleSeries.plot_envelope"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.EnsembleSeries.plot_envelope" title="Permalink to this definition"></a></dt>
<dd><p>Plot EnsembleSeries as an envelope.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>list</em><em>, </em><em>optional</em>) – The figure size. The default is [10, 4].</p></li>
<li><p><strong>qs</strong> (<em>list</em><em>, </em><em>optional</em>) – The significance levels to consider. The default is [0.025, 0.25, 0.5, 0.75, 0.975] (median, interquartile range, and central 95% region)</p></li>
<li><p><strong>xlabel</strong> (<em>str</em><em>, </em><em>optional</em>) – x-axis label. The default is None.</p></li>
<li><p><strong>ylabel</strong> (<em>str</em><em>, </em><em>optional</em>) – y-axis label. The default is None.</p></li>
<li><p><strong>title</strong> (<em>str</em><em>, </em><em>optional</em>) – Plot title. The default is None.</p></li>
<li><p><strong>xlim</strong> (<em>list</em><em>, </em><em>optional</em>) – x-axis limits. The default is None.</p></li>
<li><p><strong>ylim</strong> (<em>list</em><em>, </em><em>optional</em>) – y-axis limits. The default is None.</p></li>
<li><p><strong>savefig_settings</strong> (<em>dict</em><em>, </em><em>optional</em>) – <p>the dictionary of arguments for plt.savefig(); some notes below:
- “path” must be specified; it can be any existed or non-existed path,</p>
<blockquote>
<div><p>with or without a suffix; if the suffix is not given in “path”, it will follow “format”</p>
</div></blockquote>
<ul>
<li><p>”format” can be one of {“pdf”, “eps”, “png”, “ps”} The default is None.</p></li>
</ul>
</p></li>
<li><p><strong>ax</strong> (<em>matplotlib.ax</em><em>, </em><em>optional</em>) – Matplotlib axis on which to return the plot. The default is None.</p></li>
<li><p><strong>plot_legend</strong> (<em>bool</em><em>, </em><em>optional</em>) – Wether to plot the legend. The default is True.</p></li>
<li><p><strong>curve_clr</strong> (<em>str</em><em>, </em><em>optional</em>) – Color of the main line (median). The default is sns.xkcd_rgb[‘pale red’].</p></li>
<li><p><strong>curve_lw</strong> (<em>str</em><em>, </em><em>optional</em>) – Width of the main line (median). The default is 2.</p></li>
<li><p><strong>shade_clr</strong> (<em>str</em><em>, </em><em>optional</em>) – Color of the shaded envelope. The default is sns.xkcd_rgb[‘pale red’].</p></li>
<li><p><strong>shade_alpha</strong> (<em>float</em><em>, </em><em>optional</em>) – Transparency on the envelope. The default is 0.2.</p></li>
<li><p><strong>inner_shade_label</strong> (<em>str</em><em>, </em><em>optional</em>) – Label for the envelope. The default is ‘IQR’.</p></li>
<li><p><strong>outer_shade_label</strong> (<em>str</em><em>, </em><em>optional</em>) – Label for the envelope. The default is ‘95% CI’.</p></li>
<li><p><strong>lgd_kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Parameters for the legend. The default is None.</p></li>
<li><p><strong>mute</strong> (<em>bool</em><em>, </em><em>optional</em>) – if True, the plot will not show;
recommend to turn on when more modifications are going to be made on ax. The default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>fig, ax</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="n">nn</span> <span class="o">=</span> <span class="mi">30</span> <span class="c1"># number of noise realizations</span>

<span class="gp">In [2]: </span><span class="n">nt</span> <span class="o">=</span> <span class="mi">500</span>

<span class="gp">In [3]: </span><span class="n">series_list</span> <span class="o">=</span> <span class="p">[]</span>

<span class="gp">In [4]: </span><span class="n">signal</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">gen_ts</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s1">&#39;colored_noise&#39;</span><span class="p">,</span><span class="n">nt</span><span class="o">=</span><span class="n">nt</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span><span class="o">.</span><span class="n">standardize</span><span class="p">()</span>

<span class="gp">In [5]: </span><span class="n">noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">nt</span><span class="p">,</span><span class="n">nn</span><span class="p">)</span>

<span class="gp">In [6]: </span><span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nn</span><span class="p">):</span>  <span class="c1"># noise</span>
<span class="gp">   ...: </span>    <span class="n">ts</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">signal</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">signal</span><span class="o">.</span><span class="n">value</span><span class="o">+</span><span class="n">noise</span><span class="p">[:,</span><span class="n">idx</span><span class="p">])</span>
<span class="gp">   ...: </span>    <span class="n">series_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span>
<span class="gp">   ...: </span>

<span class="gp">In [7]: </span><span class="n">ts_ens</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">EnsembleSeries</span><span class="p">(</span><span class="n">series_list</span><span class="p">)</span>

<span class="gp">In [8]: </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ts_ens</span><span class="o">.</span><span class="n">plot_envelope</span><span class="p">(</span><span class="n">curve_lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="go">&lt;Figure size 1000x400 with 1 Axes&gt;</span>

<span class="gp">In [9]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">closefig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.EnsembleSeries.plot_traces">
<span class="sig-name descname"><span class="pre">plot_traces</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[10,</span> <span class="pre">4]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_traces</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linestyle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'-'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savefig_settings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'#d9544d'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lgd_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#EnsembleSeries.plot_traces"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.EnsembleSeries.plot_traces" title="Permalink to this definition"></a></dt>
<dd><p>Plot EnsembleSeries as a subset of traces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>list</em><em>, </em><em>optional</em>) – The figure size. The default is [10, 4].</p></li>
<li><p><strong>xlabel</strong> (<em>str</em><em>, </em><em>optional</em>) – x-axis label. The default is None.</p></li>
<li><p><strong>ylabel</strong> (<em>str</em><em>, </em><em>optional</em>) – y-axis label. The default is None.</p></li>
<li><p><strong>title</strong> (<em>str</em><em>, </em><em>optional</em>) – Plot title. The default is None.</p></li>
<li><p><strong>xlim</strong> (<em>list</em><em>, </em><em>optional</em>) – x-axis limits. The default is None.</p></li>
<li><p><strong>ylim</strong> (<em>list</em><em>, </em><em>optional</em>) – y-axis limits. The default is None.</p></li>
<li><p><strong>color</strong> (<em>str</em><em>, </em><em>optional</em>) – Color of the traces. The default is sns.xkcd_rgb[‘pale red’].</p></li>
<li><p><strong>alpha</strong> (<em>float</em><em>, </em><em>optional</em>) – Transparency of the lines representing the multiple members. The default is 0.3.</p></li>
<li><p><strong>linestyle</strong> (<em>{'-'</em><em>, </em><em>'--'</em><em>, </em><em>'-.'</em><em>, </em><em>':'</em><em>, </em><em>''</em><em>, </em><em>(</em><em>offset</em><em>, </em><em>on-off-seq</em><em>)</em><em>, </em><em>...</em><em>}</em>) – Set the linestyle of the line</p></li>
<li><p><strong>lw</strong> (<em>float</em><em>, </em><em>optional</em>) – Width of the lines representing the multiple members. The default is 0.5.</p></li>
<li><p><strong>num_traces</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of traces to plot. The default is 10.</p></li>
<li><p><strong>savefig_settings</strong> (<em>dict</em><em>, </em><em>optional</em>) – <p>the dictionary of arguments for plt.savefig(); some notes below:
- “path” must be specified; it can be any existed or non-existed path,</p>
<blockquote>
<div><p>with or without a suffix; if the suffix is not given in “path”, it will follow “format”</p>
</div></blockquote>
<ul>
<li><p>”format” can be one of {“pdf”, “eps”, “png”, “ps”} The default is None.</p></li>
</ul>
</p></li>
<li><p><strong>ax</strong> (<em>matplotlib.ax</em><em>, </em><em>optional</em>) – Matplotlib axis on which to return the plot. The default is None.</p></li>
<li><p><strong>plot_legend</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to plot the legend. The default is True.</p></li>
<li><p><strong>lgd_kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Parameters for the legend. The default is None.</p></li>
<li><p><strong>mute</strong> (<em>bool</em><em>, </em><em>optional</em>) – if True, the plot will not show;
recommend to turn on when more modifications are going to be made on ax. The default is False.</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) – Set the seed for the random number generator. Useful for reproducibility. The default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>fig, ax</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="n">nn</span> <span class="o">=</span> <span class="mi">30</span> <span class="c1"># number of noise realizations</span>

<span class="gp">In [2]: </span><span class="n">nt</span> <span class="o">=</span> <span class="mi">500</span>

<span class="gp">In [3]: </span><span class="n">series_list</span> <span class="o">=</span> <span class="p">[]</span>

<span class="gp">In [4]: </span><span class="n">signal</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">gen_ts</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s1">&#39;colored_noise&#39;</span><span class="p">,</span><span class="n">nt</span><span class="o">=</span><span class="n">nt</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span><span class="o">.</span><span class="n">standardize</span><span class="p">()</span>

<span class="gp">In [5]: </span><span class="n">noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">nt</span><span class="p">,</span><span class="n">nn</span><span class="p">)</span>

<span class="gp">In [6]: </span><span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nn</span><span class="p">):</span>  <span class="c1"># noise</span>
<span class="gp">   ...: </span>    <span class="n">ts</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">signal</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">signal</span><span class="o">.</span><span class="n">value</span><span class="o">+</span><span class="n">noise</span><span class="p">[:,</span><span class="n">idx</span><span class="p">])</span>
<span class="gp">   ...: </span>    <span class="n">series_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span>
<span class="gp">   ...: </span>

<span class="gp">In [7]: </span><span class="n">ts_ens</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">EnsembleSeries</span><span class="p">(</span><span class="n">series_list</span><span class="p">)</span>

<span class="gp">In [8]: </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ts_ens</span><span class="o">.</span><span class="n">plot_traces</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span><span class="n">num_traces</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="go">&lt;Figure size 1000x400 with 1 Axes&gt;</span>

<span class="gp">In [9]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">closefig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.EnsembleSeries.quantiles">
<span class="sig-name descname"><span class="pre">quantiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.05,</span> <span class="pre">0.5,</span> <span class="pre">0.95]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#EnsembleSeries.quantiles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.EnsembleSeries.quantiles" title="Permalink to this definition"></a></dt>
<dd><p>Calculate quantiles of an EnsembleSeries object</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>qs</strong> (<em>list</em><em>, </em><em>optional</em>) – List of quantiles to consider for the calculation. The default is [0.05, 0.5, 0.95].</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>ens_qs</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pyleoclim.EnsembleSeries</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.EnsembleSeries.stackplot">
<span class="sig-name descname"><span class="pre">stackplot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[5,</span> <span class="pre">15]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savefig_settings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_between_alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tab10'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spine_lw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_lw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">font_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_x_loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">0.15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_shift_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.75</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#EnsembleSeries.stackplot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.EnsembleSeries.stackplot" title="Permalink to this definition"></a></dt>
<dd><p>Stack plot of multiple series</p>
<dl class="simple">
<dt>Note that the plotting style is uniquely designed for this one and cannot be properly reset with <cite>pyleoclim.set_style()</cite>.</dt><dd><p>Parameters</p>
</dd>
</dl>
<dl>
<dt>figsize<span class="classifier">list</span></dt><dd><p>Size of the figure.</p>
</dd>
<dt>colors<span class="classifier">a list of, or one, Python supported color code (a string of hex code or a tuple of rgba values)</span></dt><dd><p>Colors for plotting.
If None, the plotting will cycle the ‘tab10’ colormap;
if only one color is specified, then all curves will be plotted with that single color;
if a list of colors are specified, then the plotting will cycle that color list.</p>
</dd>
<dt>cmap<span class="classifier">str</span></dt><dd><p>The colormap to use when “colors” is None.</p>
</dd>
<dt>norm<span class="classifier">matplotlib.colors.Normalize like</span></dt><dd><p>The nomorlization for the colormap.
If None, a linear normalization will be used.</p>
</dd>
<dt>savefig_settings<span class="classifier">dictionary</span></dt><dd><p>the dictionary of arguments for plt.savefig(); some notes below:
- “path” must be specified; it can be any existed or non-existed path,</p>
<blockquote>
<div><p>with or without a suffix; if the suffix is not given in “path”, it will follow “format”</p>
</div></blockquote>
<ul class="simple">
<li><p>“format” can be one of {“pdf”, “eps”, “png”, “ps”} The default is None.</p></li>
</ul>
</dd>
<dt>xlim<span class="classifier">list</span></dt><dd><p>The x-axis limit.</p>
</dd>
<dt>fill_between_alpha<span class="classifier">float</span></dt><dd><p>The transparency for the fill_between shades.</p>
</dd>
<dt>spine_lw<span class="classifier">float</span></dt><dd><p>The linewidth for the spines of the axes.</p>
</dd>
<dt>grid_lw<span class="classifier">float</span></dt><dd><p>The linewidth for the gridlines.</p>
</dd>
<dt>linewidth<span class="classifier">float</span></dt><dd><p>The linewidth for the curves.</p>
</dd>
<dt>font_scale<span class="classifier">float</span></dt><dd><p>The scale for the font sizes. Default is 0.8.</p>
</dd>
<dt>label_x_loc<span class="classifier">float</span></dt><dd><p>The x location for the label of each curve.</p>
</dd>
<dt>v_shift_factor<span class="classifier">float</span></dt><dd><p>The factor for the vertical shift of each axis.
The default value 3/4 means the top of the next axis will be located at 3/4 of the height of the previous one.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>fig, ax</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="surrogateseries-pyleoclim-surrogateseries">
<h2>SurrogateSeries (pyleoclim.SurrogateSeries)<a class="headerlink" href="#surrogateseries-pyleoclim-surrogateseries" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyleoclim.core.ui.SurrogateSeries">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pyleoclim.core.ui.</span></span><span class="sig-name descname"><span class="pre">SurrogateSeries</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">series_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surrogate_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surrogate_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#SurrogateSeries"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.SurrogateSeries" title="Permalink to this definition"></a></dt>
<dd><p>Object containing surrogate timeseries, usually obtained through recursive modeling (e.g., AR1)</p>
<p>Surrogate Series is a child of MultipleSeries. All methods available for MultipleSeries are available for surrogate series.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">append</span></code>(ts)</p></td>
<td><p>Append timeseries ts to MultipleSeries object</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">bin</span></code>(**kwargs)</p></td>
<td><p>Aligns the time axes of a MultipleSeries object, via binning.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">common_time</span></code>([method, common_step, start, ...])</p></td>
<td><p>Aligns the time axes of a MultipleSeries object, via binning interpolation., or Gaussian kernel.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">convert_time_unit</span></code>([time_unit])</p></td>
<td><p>Convert the time unit of the timeseries</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy</span></code>()</p></td>
<td><p>Copy the object</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">correlation</span></code>([target, timespan, alpha, ...])</p></td>
<td><p>Calculate the correlation between a MultipleSeries and a target Series</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">detrend</span></code>([method])</p></td>
<td><p>Detrend timeseries</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">equal_lengths</span></code>()</p></td>
<td><p>Test whether all series in object have equal length</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter</span></code>([cutoff_freq, cutoff_scale, method])</p></td>
<td><p>Filtering the timeseries in the MultipleSeries object</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">gkernel</span></code>(**kwargs)</p></td>
<td><p>Aligns the time axes of a MultipleSeries object, via Gaussian kernel.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">grid_properties</span></code>([step_style])</p></td>
<td><p>Extract grid properties (start, stop, step) of all the Series objects in a collection.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">interp</span></code>(**kwargs)</p></td>
<td><p>Aligns the time axes of a MultipleSeries object, via interpolation.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">pca</span></code>([weights, missing, tol_em, max_em_iter])</p></td>
<td><p>Principal Component Analysis (Empirical Orthogonal Functions)</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot</span></code>([figsize, marker, markersize, ...])</p></td>
<td><p>Plot multiple timeseries on the same axis</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">spectral</span></code>([method, settings, mute_pbar, ...])</p></td>
<td><p>Perform spectral analysis on the timeseries</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">stackplot</span></code>([figsize, savefig_settings, xlim, ...])</p></td>
<td><p>Stack plot of multiple series</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">standardize</span></code>()</p></td>
<td><p>Standardize each series object in a collection</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">wavelet</span></code>([method, settings, freq_method, ...])</p></td>
<td><p>Wavelet analysis</p></td>
</tr>
</tbody>
</table>
</dd></dl>

</section>
<section id="lipd-pyleoclim-lipd">
<h2>Lipd (pyleoclim.Lipd)<a class="headerlink" href="#lipd-pyleoclim-lipd" title="Permalink to this headline"></a></h2>
<p>This class allows to manipulate LiPD objects.</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyleoclim.core.ui.Lipd">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pyleoclim.core.ui.</span></span><span class="sig-name descname"><span class="pre">Lipd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">usr_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lipd_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#Lipd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.Lipd" title="Permalink to this definition"></a></dt>
<dd><p>Create a Lipd object from Lipd Files</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>usr_path</strong> (<em>str</em>) – path to the Lipd file(s). Can be URL (LiPD utilities only support loading one file at a time from a URL)
If it’s a URL, it must start with “http”, “https”, or “ftp”.</p></li>
<li><p><strong>lidp_dict</strong> (<em>dict</em>) – LiPD files already loaded into Python through the LiPD utilities</p></li>
<li><p><strong>validate</strong> (<em>bool</em>) – Validate the LiPD files upon loading. Note that for a large library this can take up to half an hour.</p></li>
<li><p><strong>remove</strong> (<em>bool</em>) – If validate is True and remove is True, ignores non-valid Lipd files. Note that loading unvalidated Lipd files may result in errors for some functionalities but not all.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">pyleoclim</span> <span class="k">as</span> <span class="nn">pyleo</span>

<span class="gp">In [2]: </span><span class="n">url</span><span class="o">=</span><span class="s1">&#39;http://wiki.linked.earth/wiki/index.php/Special:WTLiPD?op=export&amp;lipdid=MD982176.Stott.2004&#39;</span>

<span class="gp">In [3]: </span><span class="n">d</span><span class="o">=</span><span class="n">pyleo</span><span class="o">.</span><span class="n">Lipd</span><span class="p">(</span><span class="n">usr_path</span><span class="o">=</span><span class="n">url</span><span class="p">)</span>
<span class="go">Disclaimer: LiPD files may be updated and modified to adhere to standards</span>

<span class="go">reading: MD982176.Stott.2004.lpd</span>
<span class="go">Finished read: 1 record</span>
</pre></div>
</div>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyleoclim.core.ui.Lipd.copy" title="pyleoclim.core.ui.Lipd.copy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy</span></code></a>()</p></td>
<td><p>Copy the object</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyleoclim.core.ui.Lipd.extract" title="pyleoclim.core.ui.Lipd.extract"><code class="xref py py-obj docutils literal notranslate"><span class="pre">extract</span></code></a>(dataSetName)</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">param dataSetName</dt>
<dd class="field-odd"><p>Extract a particular dataset</p>
</dd>
</dl>
</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyleoclim.core.ui.Lipd.mapAllArchive" title="pyleoclim.core.ui.Lipd.mapAllArchive"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mapAllArchive</span></code></a>([projection, proj_default, ...])</p></td>
<td><p>Map the records contained in LiPD files by archive type</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyleoclim.core.ui.Lipd.to_LipdSeries" title="pyleoclim.core.ui.Lipd.to_LipdSeries"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_LipdSeries</span></code></a>([number, mode])</p></td>
<td><p>Extracts one timeseries from the Lipd object</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyleoclim.core.ui.Lipd.to_LipdSeriesList" title="pyleoclim.core.ui.Lipd.to_LipdSeriesList"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_LipdSeriesList</span></code></a>([mode])</p></td>
<td><p>Extracts all LiPD timeseries objects to a list of LipdSeries objects</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyleoclim.core.ui.Lipd.to_tso" title="pyleoclim.core.ui.Lipd.to_tso"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_tso</span></code></a>()</p></td>
<td><p>Extracts all the timeseries objects to a list of LiPD tso</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.Lipd.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#Lipd.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.Lipd.copy" title="Permalink to this definition"></a></dt>
<dd><p>Copy the object</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.Lipd.extract">
<span class="sig-name descname"><span class="pre">extract</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataSetName</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#Lipd.extract"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.Lipd.extract" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataSetName</strong> (<em>str</em>) – Extract a particular dataset</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>new</strong> – A new object corresponding to a particular dataset</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pyleoclim.Lipd</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.Lipd.mapAllArchive">
<span class="sig-name descname"><span class="pre">mapAllArchive</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">projection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Robinson'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proj_default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">background</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">borders</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rivers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lakes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marker</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">markersize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scatter_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lgd_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savefig_settings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#Lipd.mapAllArchive"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.Lipd.mapAllArchive" title="Permalink to this definition"></a></dt>
<dd><p>Map the records contained in LiPD files by archive type</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>projection</strong> (<em>str</em><em>, </em><em>optional</em>) – The projection to use. The default is ‘Robinson’.</p></li>
<li><p><strong>proj_default</strong> (<em>bool</em><em>, </em><em>optional</em>) – Wether to use the Pyleoclim defaults for each projection type. The default is True.</p></li>
<li><p><strong>background</strong> (<em>bool</em><em>, </em><em>optional</em>) – Wether to use a backgound. The default is True.</p></li>
<li><p><strong>borders</strong> (<em>bool</em><em>, </em><em>optional</em>) – Draw borders. The default is False.</p></li>
<li><p><strong>rivers</strong> (<em>bool</em><em>, </em><em>optional</em>) – Draw rivers. The default is False.</p></li>
<li><p><strong>lakes</strong> (<em>bool</em><em>, </em><em>optional</em>) – Draw lakes. The default is False.</p></li>
<li><p><strong>figsize</strong> (<em>list</em><em>, </em><em>optional</em>) – The size of the figure. The default is None.</p></li>
<li><p><strong>ax</strong> (<em>matplotlib.ax</em><em>, </em><em>optional</em>) – The matplotlib axis onto which to return the map. The default is None.</p></li>
<li><p><strong>marker</strong> (<em>str</em><em>, </em><em>optional</em>) – The marker type for each archive. The default is None. Uses plot_default</p></li>
<li><p><strong>color</strong> (<em>str</em><em>, </em><em>optional</em>) – Color for each acrhive. The default is None. Uses plot_default</p></li>
<li><p><strong>markersize</strong> (<em>float</em><em>, </em><em>optional</em>) – Size of the marker. The default is None.</p></li>
<li><p><strong>scatter_kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Parameters for the scatter plot. The default is None.</p></li>
<li><p><strong>legend</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to plot the legend. The default is True.</p></li>
<li><p><strong>lgd_kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Arguments for the legend. The default is None.</p></li>
<li><p><strong>savefig_settings</strong> (<em>dictionary</em><em>, </em><em>optional</em>) – <p>the dictionary of arguments for plt.savefig(); some notes below:
- “path” must be specified; it can be any existed or non-existed path,</p>
<blockquote>
<div><p>with or without a suffix; if the suffix is not given in “path”, it will follow “format”</p>
</div></blockquote>
<ul>
<li><p>”format” can be one of {“pdf”, “eps”, “png”, “ps”}. The default is None.</p></li>
</ul>
</p></li>
<li><p><strong>mute</strong> (<em>bool</em><em>, </em><em>optional</em>) – if True, the plot will not show;
recommend to turn on when more modifications are going to be made on ax. The default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>res</strong> – The figure</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>figure</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="../utils/mapping/map_all.html#pyleoclim.utils.mapping.map_all" title="pyleoclim.utils.mapping.map_all"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.mapping.map_all</span></code></a></dt><dd><p>Underlying mapping function for Pyleoclim</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p>For speed, we are only using one LiPD file. But these functions can load and map multiple.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">pyleoclim</span> <span class="k">as</span> <span class="nn">pyleo</span>

<span class="gp">In [2]: </span><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://wiki.linked.earth/wiki/index.php/Special:WTLiPD?op=export&amp;lipdid=MD982176.Stott.2004&#39;</span>

<span class="gp">In [3]: </span><span class="n">data</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">Lipd</span><span class="p">(</span><span class="n">usr_path</span> <span class="o">=</span> <span class="n">url</span><span class="p">)</span>
<span class="go">Disclaimer: LiPD files may be updated and modified to adhere to standards</span>

<span class="go">reading: MD982176.Stott.2004.lpd</span>
<span class="go">Finished read: 1 record</span>

<span class="gp">In [4]: </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">mapAllArchive</span><span class="p">()</span>
<span class="go">&lt;Figure size 640x480 with 1 Axes&gt;</span>

<span class="gp">In [5]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">closefig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/mapallarchive.png" src="../_images/mapallarchive.png" />
<p>Change the markersize</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [6]: </span><span class="kn">import</span> <span class="nn">pyleoclim</span> <span class="k">as</span> <span class="nn">pyleo</span>

<span class="gp">In [7]: </span><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://wiki.linked.earth/wiki/index.php/Special:WTLiPD?op=export&amp;lipdid=MD982176.Stott.2004&#39;</span>

<span class="gp">In [8]: </span><span class="n">data</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">Lipd</span><span class="p">(</span><span class="n">usr_path</span> <span class="o">=</span> <span class="n">url</span><span class="p">)</span>
<span class="go">Disclaimer: LiPD files may be updated and modified to adhere to standards</span>

<span class="go">reading: MD982176.Stott.2004.lpd</span>
<span class="go">Finished read: 1 record</span>

<span class="gp">In [9]: </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">mapAllArchive</span><span class="p">(</span><span class="n">markersize</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="go">&lt;Figure size 640x480 with 1 Axes&gt;</span>

<span class="gp">In [10]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">closefig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/mapallarchive_marker.png" src="../_images/mapallarchive_marker.png" />
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.Lipd.to_LipdSeries">
<span class="sig-name descname"><span class="pre">to_LipdSeries</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">number</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'paleo'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#Lipd.to_LipdSeries"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.Lipd.to_LipdSeries" title="Permalink to this definition"></a></dt>
<dd><p>Extracts one timeseries from the Lipd object</p>
<p>Note that this function may require user interaction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>number</strong> (<em>int</em>) – the number of the timeseries object</p></li>
<li><p><strong>mode</strong> (<em>{'paleo'</em><em>,</em><em>'chron'}</em>) – whether to extract the paleo or chron series.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>ts</strong> – A LipdSeries object</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pyleoclim.LipdSeries</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.ui.LipdSeries</span></code></dt><dd><p>LipdSeries object</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.Lipd.to_LipdSeriesList">
<span class="sig-name descname"><span class="pre">to_LipdSeriesList</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'paleo'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#Lipd.to_LipdSeriesList"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.Lipd.to_LipdSeriesList" title="Permalink to this definition"></a></dt>
<dd><p>Extracts all LiPD timeseries objects to a list of LipdSeries objects</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mode</strong> (<em>{'paleo'</em><em>,</em><em>'chron'}</em>) – Whether to extract the timeseries information from the paleo tables or chron tables</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>res</strong> – A list of LiPDSeries objects</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.ui.LipdSeries</span></code></dt><dd><p>LipdSeries object</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.Lipd.to_tso">
<span class="sig-name descname"><span class="pre">to_tso</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#Lipd.to_tso"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.Lipd.to_tso" title="Permalink to this definition"></a></dt>
<dd><p>Extracts all the timeseries objects to a list of LiPD tso</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>ts_list</strong> – List of Lipd timeseries objects as defined by LiPD utilities</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.ui.LipdSeries</span></code></dt><dd><p>LiPD Series object.</p>
</dd>
</dl>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="lipdseries-pyleoclim-lipdseries">
<h2>LipdSeries (pyleoclim.LipdSeries)<a class="headerlink" href="#lipdseries-pyleoclim-lipdseries" title="Permalink to this headline"></a></h2>
<p>LipdSeries are (you guessed it), Series objects that are created from LiPD objects. As a subclass of Series, they inherit all its methods.
When created, LiPDSeries automatically instantiates the time, value and other parameters from what’s in the lipd file.</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyleoclim.core.ui.LipdSeries">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pyleoclim.core.ui.</span></span><span class="sig-name descname"><span class="pre">LipdSeries</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tso</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clean_ts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#LipdSeries"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.LipdSeries" title="Permalink to this definition"></a></dt>
<dd><p>Lipd time series object</p>
<p>These objects can be obtained from a LiPD file/object either through Pyleoclim or the LiPD utilities.
If multiple objects (i.e., a list) is given, then the user will be prompted to choose one timeseries.</p>
<p>LipdSeries is a child of Series, therefore all the methods available for Series apply to LipdSeries in addition to some specific methods.</p>
<p class="rubric">Examples</p>
<p>In this example, we will import a LiPD file and explore the various options to create a series object.</p>
<p>First, let’s look at the Lipd.to_tso option. This method is attractive because the object is a list of dictionaries that are easily explored in Python.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">pyleoclim</span> <span class="k">as</span> <span class="nn">pyleo</span>

<span class="gp">In [2]: </span><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://wiki.linked.earth/wiki/index.php/Special:WTLiPD?op=export&amp;lipdid=MD982176.Stott.2004&#39;</span>

<span class="gp">In [3]: </span><span class="n">data</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">Lipd</span><span class="p">(</span><span class="n">usr_path</span> <span class="o">=</span> <span class="n">url</span><span class="p">)</span>
<span class="go">Disclaimer: LiPD files may be updated and modified to adhere to standards</span>

<span class="go">reading: MD982176.Stott.2004.lpd</span>
<span class="go">Finished read: 1 record</span>

<span class="gp">In [4]: </span><span class="n">ts_list</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">to_tso</span><span class="p">()</span>
<span class="go">extracting paleoData...</span>
<span class="go">extracting: MD982176.Stott.2004</span>
<span class="go">Created time series: 6 entries</span>

<span class="go"># Print out the dataset name and the variable name</span>
<span class="gp">In [5]: </span><span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">ts_list</span><span class="p">:</span>
<span class="gp">   ...: </span>    <span class="nb">print</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;dataSetName&#39;</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;: &#39;</span><span class="o">+</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;paleoData_variableName&#39;</span><span class="p">])</span>
<span class="gp">   ...: </span>
<span class="go">MD982176.Stott.2004: depth</span>
<span class="go">MD982176.Stott.2004: yrbp</span>
<span class="go">MD982176.Stott.2004: d18og.rub</span>
<span class="go">MD982176.Stott.2004: d18ow-s</span>
<span class="go">MD982176.Stott.2004: mg/ca-g.rub</span>
<span class="go">MD982176.Stott.2004: sst</span>

<span class="go"># Load the sst data into a LipdSeries. Since Python indexing starts at zero, sst has index 5.</span>
<span class="gp">In [6]: </span><span class="n">ts</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">LipdSeries</span><span class="p">(</span><span class="n">ts_list</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
<p>If you attempt to pass the full list of series, Pyleoclim will prompt you to choose a series by printing out something similar as above.
If you already now the number of the timeseries object you’re interested in, then you should use the following:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [7]: </span><span class="n">ts1</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">to_LipdSeries</span><span class="p">(</span><span class="n">number</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="go">extracting paleoData...</span>
<span class="go">extracting: MD982176.Stott.2004</span>
<span class="go">Created time series: 6 entries</span>
</pre></div>
</div>
<p>If number is not specified, Pyleoclim will prompt you for the number automatically.</p>
<p>Sometimes, one may want to create a MultipleSeries object from a collection of LiPD files. In this case, we recommend using the following:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [8]: </span><span class="n">ts_list</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">to_LipdSeriesList</span><span class="p">()</span>
<span class="go">extracting paleoData...</span>
<span class="go">extracting: MD982176.Stott.2004</span>
<span class="go">Created time series: 6 entries</span>

<span class="go"># only keep the Mg/Ca and SST</span>
<span class="gp">In [9]: </span><span class="n">ts_list</span><span class="o">=</span><span class="n">ts_list</span><span class="p">[</span><span class="mi">4</span><span class="p">:]</span>

<span class="go">#create a MultipleSeries object</span>
<span class="gp">In [10]: </span><span class="n">ms</span><span class="o">=</span><span class="n">pyleo</span><span class="o">.</span><span class="n">MultipleSeries</span><span class="p">(</span><span class="n">ts_list</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">anomaly</span></code>([timespan])</p></td>
<td><p>Calculate the anomaly of the series</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">bin</span></code>(**kwargs)</p></td>
<td><p>Bin values in a time series</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">causality</span></code>(target_series[, method, settings])</p></td>
<td><p>Perform causality analysis with the target timeseries</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyleoclim.core.ui.LipdSeries.chronEnsembleToPaleo" title="pyleoclim.core.ui.LipdSeries.chronEnsembleToPaleo"><code class="xref py py-obj docutils literal notranslate"><span class="pre">chronEnsembleToPaleo</span></code></a>(D[, modelNumber, ...])</p></td>
<td><p>Fetch chron ensembles from a lipd object and return the ensemble as MultipleSeries</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">clean</span></code>([verbose])</p></td>
<td><p>Clean up the timeseries by removing NaNs and sort with increasing time points</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">convert_time_unit</span></code>([time_unit])</p></td>
<td><p>Convert the time unit of the Series object</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyleoclim.core.ui.LipdSeries.copy" title="pyleoclim.core.ui.LipdSeries.copy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy</span></code></a>()</p></td>
<td><p>Copy the object</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">correlation</span></code>(target_series[, timespan, ...])</p></td>
<td><p>Estimates the Pearson's correlation and associated significance between two non IID time series</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyleoclim.core.ui.LipdSeries.dashboard" title="pyleoclim.core.ui.LipdSeries.dashboard"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dashboard</span></code></a>([figsize, plt_kwargs, ...])</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">param figsize</dt>
<dd class="field-odd"><p>Figure size. The default is [11,8].</p>
</dd>
</dl>
</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">detrend</span></code>([method])</p></td>
<td><p>Detrend Series object</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">distplot</span></code>([figsize, title, savefig_settings, ...])</p></td>
<td><p>Plot the distribution of the timeseries values</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">fill_na</span></code>([timespan, dt])</p></td>
<td><p>Fill NaNs into the timespan</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter</span></code>([cutoff_freq, cutoff_scale, method])</p></td>
<td><p>Filtering methods for Series objects using four possible methods:</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">gaussianize</span></code>()</p></td>
<td><p>Gaussianizes the timeseries</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyleoclim.core.ui.LipdSeries.getMetadata" title="pyleoclim.core.ui.LipdSeries.getMetadata"><code class="xref py py-obj docutils literal notranslate"><span class="pre">getMetadata</span></code></a>()</p></td>
<td><p>Get the necessary metadata for the ensemble plots</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">gkernel</span></code>([step_type])</p></td>
<td><p>Coarse-grain a Series object via a Gaussian kernel.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">interp</span></code>([method])</p></td>
<td><p>Interpolate a Series object onto a new time axis</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_evenly_spaced</span></code>([tol])</p></td>
<td><p>Check if the Series time axis is evenly-spaced, within tolerance</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">make_labels</span></code>()</p></td>
<td><p>Initialization of labels</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyleoclim.core.ui.LipdSeries.map" title="pyleoclim.core.ui.LipdSeries.map"><code class="xref py py-obj docutils literal notranslate"><span class="pre">map</span></code></a>([projection, proj_default, background, ...])</p></td>
<td><p>Map the location of the record</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyleoclim.core.ui.LipdSeries.mapNearRecord" title="pyleoclim.core.ui.LipdSeries.mapNearRecord"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mapNearRecord</span></code></a>(D[, n, radius, sameArchive, ...])</p></td>
<td><p>Map records that are near the timeseries of interest</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">outliers</span></code>([auto, remove, fig_outliers, ...])</p></td>
<td><p>Detects outliers in a timeseries and removes if specified</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot</span></code>([figsize, marker, markersize, color, ...])</p></td>
<td><p>Plot the timeseries</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyleoclim.core.ui.LipdSeries.plot_age_depth" title="pyleoclim.core.ui.LipdSeries.plot_age_depth"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_age_depth</span></code></a>([figsize, plt_kwargs, ...])</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">param figsize</dt>
<dd class="field-odd"><p>Size of the figure. The default is [10,4].</p>
</dd>
</dl>
</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">segment</span></code>([factor])</p></td>
<td><p>Gap detection</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">slice</span></code>(timespan)</p></td>
<td><p>Slicing the timeseries with a timespan (tuple or list)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">sort</span></code>([verbose])</p></td>
<td><p>Ensure timeseries is aligned to a prograde axis.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">spectral</span></code>([method, freq_method, freq_kwargs, ...])</p></td>
<td><p>Perform spectral analysis on the timeseries</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">ssa</span></code>([M, nMC, f, trunc, var_thresh])</p></td>
<td><p>Singular Spectrum Analysis</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">standardize</span></code>()</p></td>
<td><p>Standardizes the time series</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">stats</span></code>()</p></td>
<td><p>Compute basic statistics for the time series</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">summary_plot</span></code>([psd, scalogram, figsize, ...])</p></td>
<td><p>Generate a plot of the timeseries and its frequency content through spectral and wavelet analyses.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">surrogates</span></code>([method, number, length, seed, ...])</p></td>
<td><p>Generate surrogates with increasing time axis</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">wavelet</span></code>([method, settings, freq_method, ...])</p></td>
<td><p>Perform wavelet analysis on the timeseries</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">wavelet_coherence</span></code>(target_series[, method, ...])</p></td>
<td><p>Perform wavelet coherence analysis with the target timeseries</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.LipdSeries.chronEnsembleToPaleo">
<span class="sig-name descname"><span class="pre">chronEnsembleToPaleo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modelNumber</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tableNumber</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#LipdSeries.chronEnsembleToPaleo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.LipdSeries.chronEnsembleToPaleo" title="Permalink to this definition"></a></dt>
<dd><p>Fetch chron ensembles from a lipd object and return the ensemble as MultipleSeries</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>D</strong> (<em>a LiPD object</em>) – </p></li>
<li><p><strong>modelNumber</strong> (<em>int</em><em>, </em><em>optional</em>) – Age model number. The default is None.</p></li>
<li><p><strong>tableNumber</strong> (<em>int</em><em>, </em><em>optional</em>) – Table Number. The default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – DESCRIPTION.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>ms</strong> – An EnsembleSeries object with each series representing a possible realization of the age model</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>pyleoclim.EnsembleSeries</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.LipdSeries.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#LipdSeries.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.LipdSeries.copy" title="Permalink to this definition"></a></dt>
<dd><p>Copy the object</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.LipdSeries.dashboard">
<span class="sig-name descname"><span class="pre">dashboard</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[11,</span> <span class="pre">8]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plt_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distplt_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spectral_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spectralsignif_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spectralfig_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">map_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savefig_settings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ensemble</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#LipdSeries.dashboard"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.LipdSeries.dashboard" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>list</em><em>, </em><em>optional</em>) – Figure size. The default is [11,8].</p></li>
<li><p><strong>plt_kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Optional arguments for the timeseries plot. See Series.plot() or EnsembleSeries.plot_envelope(). The default is None.</p></li>
<li><p><strong>distplt_kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Optional arguments for the distribution plot. See Series.distplot() or EnsembleSeries.plot_displot(). The default is None.</p></li>
<li><p><strong>spectral_kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Optional arguments for the spectral method. Default is to use Lomb-Scargle method. See Series.spectral() or EnsembleSeries.spectral(). The default is None.</p></li>
<li><p><strong>spectralsignif_kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Optional arguments to estimate the significance of the power spectrum. See PSD.signif_test. Note that we currently do not support significance testing for ensembles. The default is None.</p></li>
<li><p><strong>spectralfig_kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Optional arguments for the power spectrum figure. See PSD.plot() or MultiplePSD.plot_envelope(). The default is None.</p></li>
<li><p><strong>map_kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Optional arguments for the map. See LipdSeries.map(). The default is None.</p></li>
<li><p><strong>metadata</strong> (<em>{True</em><em>,</em><em>False}</em><em>, </em><em>optional</em>) – Whether or not to produce a dashboard with printed metadata. The default is True.</p></li>
<li><p><strong>savefig_settings</strong> (<em>dict</em><em>, </em><em>optional</em>) – <p>the dictionary of arguments for plt.savefig(); some notes below:
- “path” must be specified; it can be any existed or non-existed path,</p>
<blockquote>
<div><p>with or without a suffix; if the suffix is not given in “path”, it will follow “format”</p>
</div></blockquote>
<ul>
<li><p>”format” can be one of {“pdf”, “eps”, “png”, “ps”}.</p></li>
</ul>
<p>The default is None.</p>
</p></li>
<li><p><strong>mute</strong> (<em>{True</em><em>,</em><em>False}</em><em>, </em><em>optional</em>) – if True, the plot will not show;
recommend to turn on when more modifications are going to be made on ax. The default is False.</p></li>
<li><p><strong>ensemble</strong> (<em>{True</em><em>, </em><em>False}</em><em>, </em><em>optional</em>) – If True, will return the dashboard in ensemble modes if ensembles are available</p></li>
<li><p><strong>D</strong> (<em>pyleoclim.Lipd</em>) – If asking for an ensemble plot, a pyleoclim.Lipd object must be provided</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>fig</strong> (<em>matplotlib.figure</em>) – The figure</p></li>
<li><p><strong>ax</strong> (<em>matplolib.axis</em>) – The axis.</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.Series.plot</span></code></dt><dd><p>plot a timeseries</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.EnsembleSeries.plot_envelope</span></code></dt><dd><p>Envelope plots for an ensemble</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.Series.distplot</span></code></dt><dd><p>plot a distribution of the timeseries</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.EnsembleSeries.distplot</span></code></dt><dd><p>plot a distribution of the timeseries across ensembles</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.Series.spectral</span></code></dt><dd><p>spectral analysis method.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.MultipleSeries.spectral</span></code></dt><dd><p>spectral analysis method for multiple series.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.PSD.signif_test</span></code></dt><dd><p>significance test for timeseries analysis</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.PSD.plot</span></code></dt><dd><p>plot power spectrum</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.MulitplePSD.plot</span></code></dt><dd><p>plot envelope of power spectrum</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.LipdSeries.map</span></code></dt><dd><p>map location of dataset</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleolim.LipdSeries.getMetadata</span></code></dt><dd><p>get relevant metadata from the timeseries object</p>
</dd>
<dt><a class="reference internal" href="../utils/mapping/map_all.html#pyleoclim.utils.mapping.map_all" title="pyleoclim.utils.mapping.map_all"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.mapping.map_all</span></code></a></dt><dd><p>Underlying mapping function for Pyleoclim</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">pyleoclim</span> <span class="k">as</span> <span class="nn">pyleo</span>

<span class="gp">In [2]: </span><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://wiki.linked.earth/wiki/index.php/Special:WTLiPD?op=export&amp;lipdid=MD982176.Stott.2004&#39;</span>

<span class="gp">In [3]: </span><span class="n">data</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">Lipd</span><span class="p">(</span><span class="n">usr_path</span> <span class="o">=</span> <span class="n">url</span><span class="p">)</span>
<span class="go">Disclaimer: LiPD files may be updated and modified to adhere to standards</span>

<span class="go">reading: MD982176.Stott.2004.lpd</span>
<span class="go">Finished read: 1 record</span>

<span class="gp">In [4]: </span><span class="n">ts</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">to_LipdSeries</span><span class="p">(</span><span class="n">number</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="go">extracting paleoData...</span>
<span class="go">extracting: MD982176.Stott.2004</span>
<span class="go">Created time series: 6 entries</span>

<span class="gp">In [5]: </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">dashboard</span><span class="p">()</span>
<span class="go">&lt;Figure size 1100x800 with 4 Axes&gt;</span>

<span class="gp">In [6]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">closefig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/ts_dashboard.png" src="../_images/ts_dashboard.png" />
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.LipdSeries.getMetadata">
<span class="sig-name descname"><span class="pre">getMetadata</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#LipdSeries.getMetadata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.LipdSeries.getMetadata" title="Permalink to this definition"></a></dt>
<dd><p>Get the necessary metadata for the ensemble plots</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>timeseries</strong> (<em>object</em>) – a specific timeseries object.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><strong>res</strong> –</p>
<dl class="simple">
<dt>A dictionary containing the following metadata:</dt><dd><p>archiveType
Authors (if more than 2, replace by et al)
PublicationYear
Publication DOI
Variable Name
Units
Climate Interpretation
Calibration Equation
Calibration References
Calibration Notes</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.LipdSeries.map">
<span class="sig-name descname"><span class="pre">map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">projection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Orthographic'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proj_default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">background</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">borders</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rivers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lakes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marker</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">markersize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scatter_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lgd_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savefig_settings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#LipdSeries.map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.LipdSeries.map" title="Permalink to this definition"></a></dt>
<dd><p>Map the location of the record</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>projection</strong> (<em>str</em><em>, </em><em>optional</em>) – The projection to use. The default is ‘Robinson’.</p></li>
<li><p><strong>proj_default</strong> (<em>bool</em><em>, </em><em>optional</em>) – Wether to use the Pyleoclim defaults for each projection type. The default is True.</p></li>
<li><p><strong>background</strong> (<em>bool</em><em>, </em><em>optional</em>) – Wether to use a backgound. The default is True.</p></li>
<li><p><strong>borders</strong> (<em>bool</em><em>, </em><em>optional</em>) – Draw borders. The default is False.</p></li>
<li><p><strong>rivers</strong> (<em>bool</em><em>, </em><em>optional</em>) – Draw rivers. The default is False.</p></li>
<li><p><strong>lakes</strong> (<em>bool</em><em>, </em><em>optional</em>) – Draw lakes. The default is False.</p></li>
<li><p><strong>figsize</strong> (<em>list</em><em>, </em><em>optional</em>) – The size of the figure. The default is None.</p></li>
<li><p><strong>ax</strong> (<em>matplotlib.ax</em><em>, </em><em>optional</em>) – The matplotlib axis onto which to return the map. The default is None.</p></li>
<li><p><strong>marker</strong> (<em>str</em><em>, </em><em>optional</em>) – The marker type for each archive. The default is None. Uses plot_default</p></li>
<li><p><strong>color</strong> (<em>str</em><em>, </em><em>optional</em>) – Color for each acrhive. The default is None. Uses plot_default</p></li>
<li><p><strong>markersize</strong> (<em>float</em><em>, </em><em>optional</em>) – Size of the marker. The default is None.</p></li>
<li><p><strong>scatter_kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Parameters for the scatter plot. The default is None.</p></li>
<li><p><strong>legend</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to plot the legend. The default is True.</p></li>
<li><p><strong>lgd_kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Arguments for the legend. The default is None.</p></li>
<li><p><strong>savefig_settings</strong> (<em>dictionary</em><em>, </em><em>optional</em>) – <p>the dictionary of arguments for plt.savefig(); some notes below:
- “path” must be specified; it can be any existed or non-existed path,</p>
<blockquote>
<div><p>with or without a suffix; if the suffix is not given in “path”, it will follow “format”</p>
</div></blockquote>
<ul>
<li><p>”format” can be one of {“pdf”, “eps”, “png”, “ps”}. The default is None.</p></li>
</ul>
</p></li>
<li><p><strong>mute</strong> (<em>bool</em><em>, </em><em>optional</em>) – if True, the plot will not show;
recommend to turn on when more modifications are going to be made on ax. The default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>res</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>fig,ax</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="../utils/mapping/map_all.html#pyleoclim.utils.mapping.map_all" title="pyleoclim.utils.mapping.map_all"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.mapping.map_all</span></code></a></dt><dd><p>Underlying mapping function for Pyleoclim</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">pyleoclim</span> <span class="k">as</span> <span class="nn">pyleo</span>

<span class="gp">In [2]: </span><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://wiki.linked.earth/wiki/index.php/Special:WTLiPD?op=export&amp;lipdid=MD982176.Stott.2004&#39;</span>

<span class="gp">In [3]: </span><span class="n">data</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">Lipd</span><span class="p">(</span><span class="n">usr_path</span> <span class="o">=</span> <span class="n">url</span><span class="p">)</span>
<span class="go">Disclaimer: LiPD files may be updated and modified to adhere to standards</span>

<span class="go">reading: MD982176.Stott.2004.lpd</span>
<span class="go">Finished read: 1 record</span>

<span class="gp">In [4]: </span><span class="n">ts</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">to_LipdSeries</span><span class="p">(</span><span class="n">number</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="go">extracting paleoData...</span>
<span class="go">extracting: MD982176.Stott.2004</span>
<span class="go">Created time series: 6 entries</span>

<span class="gp">In [5]: </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">map</span><span class="p">()</span>
<span class="go">&lt;Figure size 640x480 with 1 Axes&gt;</span>

<span class="gp">In [6]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">closefig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/mapone.png" src="../_images/mapone.png" />
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.LipdSeries.mapNearRecord">
<span class="sig-name descname"><span class="pre">mapNearRecord</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sameArchive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">projection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Orthographic'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proj_default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">background</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">borders</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rivers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lakes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marker_ref</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_ref</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marker</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">markersize_adjust</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scatter_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lgd_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savefig_settings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#LipdSeries.mapNearRecord"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.LipdSeries.mapNearRecord" title="Permalink to this definition"></a></dt>
<dd><p>Map records that are near the timeseries of interest</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>D</strong> (<em>pyleoclim.Lipd</em>) – A pyleoclim LiPD object</p></li>
<li><p><strong>n</strong> (<em>int</em><em>, </em><em>optional</em>) – The n number of closest records. The default is 5.</p></li>
<li><p><strong>radius</strong> (<em>float</em><em>, </em><em>optional</em>) – The radius to take into consideration when looking for records (in km). The default is None.</p></li>
<li><p><strong>sameArchive</strong> (<em>{True</em><em>, </em><em>False}</em><em>, </em><em>optional</em>) – Whether to consider records from the same archiveType as the original record. The default is False.</p></li>
<li><p><strong>projection</strong> (<em>string</em><em>, </em><em>optional</em>) – A valid cartopy projection. The default is ‘Orthographic’.</p></li>
<li><p><strong>proj_default</strong> (<em>True</em><em> or </em><em>dict</em><em>, </em><em>optional</em>) – The projection arguments. If not True, then use a dictionary to pass the appropriate arguments depending on the projection. The default is True.</p></li>
<li><p><strong>background</strong> (<em>{True</em><em>,</em><em>False}</em><em>, </em><em>optional</em>) – Whether to use a background. The default is True.</p></li>
<li><p><strong>borders</strong> (<em>{True</em><em>, </em><em>False}</em><em>, </em><em>optional</em>) – Whether to plot country borders. The default is False.</p></li>
<li><p><strong>rivers</strong> (<em>{True</em><em>, </em><em>False}</em><em>, </em><em>optional</em>) – Whether to plot rivers. The default is False.</p></li>
<li><p><strong>lakes</strong> (<em>{True</em><em>, </em><em>False}</em><em>, </em><em>optional</em>) – Whether to plot rivers. The default is False.</p></li>
<li><p><strong>figsize</strong> (<em>list</em><em>, </em><em>optional</em>) – the size of the figure. The default is None.</p></li>
<li><p><strong>ax</strong> (<em>matplotlib.ax</em><em>, </em><em>optional</em>) – The matplotlib axis onto which to return the map. The default is None.</p></li>
<li><p><strong>marker_ref</strong> (<em>str</em><em>, </em><em>optional</em>) – Marker shape to use for the main record. The default is None, which corresponds to the default marker for the archiveType</p></li>
<li><p><strong>color_ref</strong> (<em>str</em><em>, </em><em>optional</em>) – The color for the main record. The default is None, which corresponds to the default color for the archiveType.</p></li>
<li><p><strong>marker</strong> (<em>str</em><em> or </em><em>list</em><em>, </em><em>optional</em>) – Marker shape to use for the other records. The default is None, which corresponds to the marker shape for each archiveType.</p></li>
<li><p><strong>color</strong> (<em>str</em><em> or </em><em>list</em><em>, </em><em>optional</em>) – Color for each marker. The default is None, which corresponds to the color for each archiveType</p></li>
<li><p><strong>markersize_adjust</strong> (<em>{True</em><em>, </em><em>False}</em><em>, </em><em>optional</em>) – Whether to adjust the marker size according to distance from record of interest. The default is False.</p></li>
<li><p><strong>scale_factor</strong> (<em>int</em><em>, </em><em>optional</em>) – The maximum marker size. The default is 100.</p></li>
<li><p><strong>scatter_kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Parameters for the scatter plot. The default is None.</p></li>
<li><p><strong>legend</strong> (<em>{True</em><em>, </em><em>False}</em><em>, </em><em>optional</em>) – Whether to show the legend. The default is True.</p></li>
<li><p><strong>lgd_kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Parameters for the legend. The default is None.</p></li>
<li><p><strong>savefig_settings</strong> (<em>dict</em><em>, </em><em>optional</em>) – <p>the dictionary of arguments for plt.savefig(); some notes below:
- “path” must be specified; it can be any existed or non-existed path,</p>
<blockquote>
<div><p>with or without a suffix; if the suffix is not given in “path”, it will follow “format”</p>
</div></blockquote>
<ul>
<li><p>”format” can be one of {“pdf”, “eps”, “png”, “ps”}. The default is None.</p></li>
</ul>
</p></li>
<li><p><strong>mute</strong> (<em>{True</em><em>, </em><em>False}</em><em>, </em><em>optional</em>) – if True, the plot will not show;
recommend to turn on when more modifications are going to be made on ax. The default is False.</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="../utils/mapping/map_all.html#pyleoclim.utils.mapping.map_all" title="pyleoclim.utils.mapping.map_all"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.mapping.map_all</span></code></a></dt><dd><p>Underlying mapping function for Pyleoclim</p>
</dd>
<dt><a class="reference internal" href="../utils/mapping/dist_sphere.html#pyleoclim.utils.mapping.dist_sphere" title="pyleoclim.utils.mapping.dist_sphere"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.mapping.dist_sphere</span></code></a></dt><dd><p>Calculate distance on a sphere</p>
</dd>
<dt><a class="reference internal" href="../utils/mapping/compute_dist.html#pyleoclim.utils.mapping.compute_dist" title="pyleoclim.utils.mapping.compute_dist"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.mapping.compute_dist</span></code></a></dt><dd><p>Compute the distance between a point and an array</p>
</dd>
<dt><a class="reference internal" href="../utils/mapping/within_distance.html#pyleoclim.utils.mapping.within_distance" title="pyleoclim.utils.mapping.within_distance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.mapping.within_distance</span></code></a></dt><dd><p>Returns point in an array within a certain distance</p>
</dd>
</dl>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>res</strong> – contains fig and ax</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.LipdSeries.plot_age_depth">
<span class="sig-name descname"><span class="pre">plot_age_depth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[10,</span> <span class="pre">4]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plt_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savefig_settings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ensemble</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_traces</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ensemble_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">envelope_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">traces_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#LipdSeries.plot_age_depth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.LipdSeries.plot_age_depth" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>List</em><em>, </em><em>optional</em>) – Size of the figure. The default is [10,4].</p></li>
<li><p><strong>plt_kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Arguments for basic plot. See Series.plot() for details. The default is None.</p></li>
<li><p><strong>savefig_settings</strong> (<em>dict</em><em>, </em><em>optional</em>) – <p>the dictionary of arguments for plt.savefig(); some notes below:
- “path” must be specified; it can be any existed or non-existed path,</p>
<blockquote>
<div><p>with or without a suffix; if the suffix is not given in “path”, it will follow “format”</p>
</div></blockquote>
<ul>
<li><p>”format” can be one of {“pdf”, “eps”, “png”, “ps”}. The default is None.</p></li>
</ul>
</p></li>
<li><p><strong>mute</strong> (<em>{True</em><em>,</em><em>False}</em><em>, </em><em>optional</em>) – if True, the plot will not show;
recommend to turn on when more modifications are going to be made on ax. The default is False.</p></li>
<li><p><strong>ensemble</strong> (<em>{True</em><em>,</em><em>False}</em><em>, </em><em>optional</em>) – Whether to use age model ensembles stored in the file for the plot. The default is False.
If no ensemble can be found, will error out.</p></li>
<li><p><strong>D</strong> (<em>pyleoclim.Lipd</em><em>, </em><em>optional</em>) – The pyleoclim.Lipd object from which the pyleoclim.LipdSeries is derived. The default is None.</p></li>
<li><p><strong>num_traces</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of individual age models to plot. If not interested in plotting individual traces, set this parameter to 0 or None. The default is 10.</p></li>
<li><p><strong>ensemble_kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Parameters associated with identifying the chronEnsemble tables. See pyleoclim.LipdSeries.chronEnsembleToPaleo() for details. The default is None.</p></li>
<li><p><strong>envelope_kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Parameters to control the envelope plot. See pyleoclim.EnsembleSeries.plot_envelope() for details. The default is None.</p></li>
<li><p><strong>traces_kwargs</strong> (<em>TYPE</em><em>, </em><em>optional</em>) – Parameters to control the traces plot. See pyleoclim.EnsembleSeries.plot_traces() for details. The default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – In ensemble mode, make sure that the LiPD object is given</p></li>
<li><p><strong>KeyError</strong> – Depth information needed.</p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The figure</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>fig,ax</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#pyleoclim.core.ui.Lipd" title="pyleoclim.core.ui.Lipd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.core.ui.Lipd</span></code></a></dt><dd><p>Pyleoclim internal representation of a LiPD file</p>
</dd>
<dt><a class="reference internal" href="#pyleoclim.core.ui.Series.plot" title="pyleoclim.core.ui.Series.plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.core.ui.Series.plot</span></code></a></dt><dd><p>Basic plotting in pyleoclim</p>
</dd>
<dt><a class="reference internal" href="#pyleoclim.core.ui.LipdSeries.chronEnsembleToPaleo" title="pyleoclim.core.ui.LipdSeries.chronEnsembleToPaleo"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.core.ui.LipdSeries.chronEnsembleToPaleo</span></code></a></dt><dd><p>Function to map the ensemble table to a paleo depth.</p>
</dd>
<dt><a class="reference internal" href="#pyleoclim.core.ui.EnsembleSeries.plot_envelope" title="pyleoclim.core.ui.EnsembleSeries.plot_envelope"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.core.ui.EnsembleSeries.plot_envelope</span></code></a></dt><dd><p>Create an envelope plot from an ensemble</p>
</dd>
<dt><a class="reference internal" href="#pyleoclim.core.ui.EnsembleSeries.plot_traces" title="pyleoclim.core.ui.EnsembleSeries.plot_traces"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.core.ui.EnsembleSeries.plot_traces</span></code></a></dt><dd><p>Create a trace plot from an ensemble</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="n">D</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">Lipd</span><span class="p">(</span><span class="s1">&#39;http://wiki.linked.earth/wiki/index.php/Special:WTLiPD?op=export&amp;lipdid=Crystal.McCabe-Glynn.2013&#39;</span><span class="p">)</span>
<span class="go">Disclaimer: LiPD files may be updated and modified to adhere to standards</span>

<span class="go">reading: Crystal.McCabe-Glynn.2013.lpd</span>
<span class="go">Finished read: 1 record</span>

<span class="gp">In [2]: </span><span class="n">ts</span><span class="o">=</span><span class="n">D</span><span class="o">.</span><span class="n">to_LipdSeries</span><span class="p">(</span><span class="n">number</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">extracting paleoData...</span>
<span class="go">extracting: Crystal.McCabe-Glynn.2013</span>
<span class="go">Created time series: 3 entries</span>

<span class="gp">In [3]: </span><span class="n">ts</span><span class="o">.</span><span class="n">plot_age_depth</span><span class="p">()</span>
<span class="go">&lt;Figure size 1000x400 with 1 Axes&gt;</span>
<span class="go">&lt;Figure size 1000x400 with 1 Axes&gt;</span>
<span class="gh">Out[3]: </span><span class="go"></span>
<span class="go">(&lt;Figure size 1000x400 with 1 Axes&gt;,</span>
<span class="go"> &lt;AxesSubplot:xlabel=&#39;Age [AD]&#39;, ylabel=&#39;depth [mm]&#39;&gt;)</span>

<span class="gp">In [4]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">closefig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="psd-pyleoclim-psd">
<h2>PSD (pyleoclim.PSD)<a class="headerlink" href="#psd-pyleoclim-psd" title="Permalink to this headline"></a></h2>
<p>The PSD (Power spectral density) class is intended for conveniently manipulating the result of spectral methods, including performing significance tests, estimating scaling coefficients, and plotting.
Available methods:</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyleoclim.core.ui.PSD">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pyleoclim.core.ui.</span></span><span class="sig-name descname"><span class="pre">PSD</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frequency</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amplitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeseries</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spec_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spec_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signif_qs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signif_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">period_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta_est_res</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#PSD"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.PSD" title="Permalink to this definition"></a></dt>
<dd><p>PSD object obtained from spectral analysis.</p>
<p>See examples in pyleoclim.core.ui.Series.spectral to see how to create and manipulate these objects</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#pyleoclim.core.ui.Series.spectral" title="pyleoclim.core.ui.Series.spectral"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.core.ui.Series.spectral</span></code></a></dt><dd><p>spectral analysis</p>
</dd>
</dl>
</div>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyleoclim.core.ui.PSD.beta_est" title="pyleoclim.core.ui.PSD.beta_est"><code class="xref py py-obj docutils literal notranslate"><span class="pre">beta_est</span></code></a>([fmin, fmax, logf_binning_step, ...])</p></td>
<td><p>Estimate the scaling factor beta of the PSD in a log-log space</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyleoclim.core.ui.PSD.copy" title="pyleoclim.core.ui.PSD.copy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy</span></code></a>()</p></td>
<td><p>Copy object</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyleoclim.core.ui.PSD.plot" title="pyleoclim.core.ui.PSD.plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot</span></code></a>([in_loglog, in_period, label, xlabel, ...])</p></td>
<td><p>Plots the PSD estimates and signif level if included</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyleoclim.core.ui.PSD.signif_test" title="pyleoclim.core.ui.PSD.signif_test"><code class="xref py py-obj docutils literal notranslate"><span class="pre">signif_test</span></code></a>([number, method, seed, qs, settings])</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">param number</dt>
<dd class="field-odd"><p>Number of surrogate series to generate for significance testing. The default is 200.</p>
</dd>
</dl>
</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.PSD.beta_est">
<span class="sig-name descname"><span class="pre">beta_est</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logf_binning_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'max'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#PSD.beta_est"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.PSD.beta_est" title="Permalink to this definition"></a></dt>
<dd><p>Estimate the scaling factor beta of the PSD in a log-log space</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fmin</strong> (<em>float</em>) – the minimum frequency edge for beta estimation; the default is the minimum of the frequency vector of the PSD obj</p></li>
<li><p><strong>fmax</strong> (<em>float</em>) – the maximum frequency edge for beta estimation; the default is the maximum of the frequency vector of the PSD obj</p></li>
<li><p><strong>logf_binning_step</strong> (<em>str</em><em>, </em><em>{'max'</em><em>, </em><em>'first'}</em>) – if ‘max’, then the maximum spacing of log(f) will be used as the binning step
if ‘first’, then the 1st spacing of log(f) will be used as the binning step</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – If True, will print warning messages if there is any</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><strong>res_dict</strong> –</p>
<ul class="simple">
<li><p>beta: the scaling factor</p></li>
<li><p>std_err: the one standard deviation error of the scaling factor</p></li>
<li><p>f_binned: the binned frequency series, used as X for linear regression</p></li>
<li><p>psd_binned: the binned PSD series, used as Y for linear regression</p></li>
<li><p>Y_reg: the predicted Y from linear regression, used with f_binned for the slope curve plotting</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dictionary</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.PSD.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#PSD.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.PSD.copy" title="Permalink to this definition"></a></dt>
<dd><p>Copy object</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.PSD.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_loglog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'PSD'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marker</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">markersize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linestyle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transpose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[10,</span> <span class="pre">4]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savefig_settings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lgd_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xticks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yticks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zorder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signif_clr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'red'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signif_linestyles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['--',</span> <span class="pre">'-.',</span> <span class="pre">':']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signif_linewidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#PSD.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.PSD.plot" title="Permalink to this definition"></a></dt>
<dd><p>Plots the PSD estimates and signif level if included</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_loglog</strong> (<em>bool</em><em>, </em><em>optional</em>) – Plot on loglog axis. The default is True.</p></li>
<li><p><strong>in_period</strong> (<em>bool</em><em>, </em><em>optional</em>) – Plot the x-axis as periodicity rather than frequency. The default is True.</p></li>
<li><p><strong>label</strong> (<em>str</em><em>, </em><em>optional</em>) – label for the series. The default is None.</p></li>
<li><p><strong>xlabel</strong> (<em>str</em><em>, </em><em>optional</em>) – Label for the x-axis. The default is None. Will guess based on Series</p></li>
<li><p><strong>ylabel</strong> (<em>str</em><em>, </em><em>optional</em>) – Label for the y-axis. The default is ‘PSD’.</p></li>
<li><p><strong>title</strong> (<em>str</em><em>, </em><em>optional</em>) – Plot title. The default is None.</p></li>
<li><p><strong>marker</strong> (<em>str</em><em>, </em><em>optional</em>) – marker to use. The default is None.</p></li>
<li><p><strong>markersize</strong> (<em>int</em><em>, </em><em>optional</em>) – size of the marker. The default is None.</p></li>
<li><p><strong>color</strong> (<em>str</em><em>, </em><em>optional</em>) – Line color. The default is None.</p></li>
<li><p><strong>linestyle</strong> (<em>str</em><em>, </em><em>optional</em>) – linestyle. The default is None.</p></li>
<li><p><strong>linewidth</strong> (<em>float</em><em>, </em><em>optional</em>) – Width of the line. The default is None.</p></li>
<li><p><strong>transpose</strong> (<em>bool</em><em>, </em><em>optional</em>) – Plot periodicity on y-. The default is False.</p></li>
<li><p><strong>xlim</strong> (<em>list</em><em>, </em><em>optional</em>) – x-axis limits. The default is None.</p></li>
<li><p><strong>ylim</strong> (<em>list</em><em>, </em><em>optional</em>) – y-axis limits. The default is None.</p></li>
<li><p><strong>figsize</strong> (<em>list</em><em>, </em><em>optional</em>) – Figure size. The default is [10, 4].</p></li>
<li><p><strong>savefig_settings</strong> (<em>dict</em><em>, </em><em>optional</em>) – <p>save settings options. The default is None.
the dictionary of arguments for plt.savefig(); some notes below:
- “path” must be specified; it can be any existed or non-existed path,</p>
<blockquote>
<div><p>with or without a suffix; if the suffix is not given in “path”, it will follow “format”</p>
</div></blockquote>
<ul>
<li><p>”format” can be one of {“pdf”, “eps”, “png”, “ps”}</p></li>
</ul>
</p></li>
<li><p><strong>ax</strong> (<em>ax</em><em>, </em><em>optional</em>) – The matplotlib.Axes object onto which to return the plot. The default is None.</p></li>
<li><p><strong>mute</strong> (<em>bool</em><em>, </em><em>optional</em>) – if True, the plot will not show;
recommend to turn on when more modifications are going to be made on ax The default is False.</p></li>
<li><p><strong>legend</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether to plot the legend. The default is True.</p></li>
<li><p><strong>lgd_kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Arguments for the legend. The default is None.</p></li>
<li><p><strong>xticks</strong> (<em>list</em><em>, </em><em>optional</em>) – xticks to use. The default is None.</p></li>
<li><p><strong>yticks</strong> (<em>list</em><em>, </em><em>optional</em>) – yticks to use. The default is None.</p></li>
<li><p><strong>alpha</strong> (<em>float</em><em>, </em><em>optional</em>) – Transparency setting. The default is None.</p></li>
<li><p><strong>zorder</strong> (<em>int</em><em>, </em><em>optional</em>) – Order for the plot. The default is None.</p></li>
<li><p><strong>plot_kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Other plotting argument. The default is None.</p></li>
<li><p><strong>signif_clr</strong> (<em>str</em><em>, </em><em>optional</em>) – Color for the significance line. The default is ‘red’.</p></li>
<li><p><strong>signif_linestyles</strong> (<em>list of str</em><em>, </em><em>optional</em>) – Linestyles for significance. The default is [’–’, ‘-.’, ‘:’].</p></li>
<li><p><strong>signif_linewidth</strong> (<em>float</em><em>, </em><em>optional</em>) – width of the significance line. The default is 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>fig, ax</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#pyleoclim.core.ui.Series.spectral" title="pyleoclim.core.ui.Series.spectral"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.core.ui.Series.spectral</span></code></a></dt><dd><p>spectral analysis</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.PSD.signif_test">
<span class="sig-name descname"><span class="pre">signif_test</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">number</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ar1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.95]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">settings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#PSD.signif_test"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.PSD.signif_test" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>number</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of surrogate series to generate for significance testing. The default is 200.</p></li>
<li><p><strong>method</strong> (<em>{ar1}</em><em>, </em><em>optional</em>) – Method to generate surrogates. The default is ‘ar1’.</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) – Option to set the seed for reproducibility. The default is None.</p></li>
<li><p><strong>qs</strong> (<em>list</em><em>, </em><em>optional</em>) – Singificance levels to return. The default is [0.95].</p></li>
<li><p><strong>settings</strong> (<em>dict</em><em>, </em><em>optional</em>) – Parameters. The default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>new</strong> – New PSD object with appropriate significance test</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pyleoclim.PSD</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="multiplepsd-pyleoclim-multiplepsd">
<h2>MultiplePSD (pyleoclim.MultiplePSD)<a class="headerlink" href="#multiplepsd-pyleoclim-multiplepsd" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyleoclim.core.ui.MultiplePSD">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pyleoclim.core.ui.</span></span><span class="sig-name descname"><span class="pre">MultiplePSD</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">psd_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#MultiplePSD"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.MultiplePSD" title="Permalink to this definition"></a></dt>
<dd><p>Object for multiple PSD.</p>
<p>Used for significance level</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyleoclim.core.ui.MultiplePSD.beta_est" title="pyleoclim.core.ui.MultiplePSD.beta_est"><code class="xref py py-obj docutils literal notranslate"><span class="pre">beta_est</span></code></a>([fmin, fmax, logf_binning_step, ...])</p></td>
<td><p>Estimate the scaling factor beta of the each PSD from the psd_list in a log-log space</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyleoclim.core.ui.MultiplePSD.copy" title="pyleoclim.core.ui.MultiplePSD.copy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy</span></code></a>()</p></td>
<td><p>Copy object</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyleoclim.core.ui.MultiplePSD.plot" title="pyleoclim.core.ui.MultiplePSD.plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot</span></code></a>([figsize, in_loglog, in_period, ...])</p></td>
<td><p>Plot multiple PSD on the same plot</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyleoclim.core.ui.MultiplePSD.plot_envelope" title="pyleoclim.core.ui.MultiplePSD.plot_envelope"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_envelope</span></code></a>([figsize, qs, in_loglog, ...])</p></td>
<td><p>Plot mutiple PSD as an envelope.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyleoclim.core.ui.MultiplePSD.quantiles" title="pyleoclim.core.ui.MultiplePSD.quantiles"><code class="xref py py-obj docutils literal notranslate"><span class="pre">quantiles</span></code></a>([qs, lw])</p></td>
<td><p>Calculate quantiles</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.MultiplePSD.beta_est">
<span class="sig-name descname"><span class="pre">beta_est</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logf_binning_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'max'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#MultiplePSD.beta_est"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.MultiplePSD.beta_est" title="Permalink to this definition"></a></dt>
<dd><p>Estimate the scaling factor beta of the each PSD from the psd_list in a log-log space</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fmin</strong> (<em>float</em>) – the minimum frequency edge for beta estimation; the default is the minimum of the frequency vector of the PSD obj</p></li>
<li><p><strong>fmax</strong> (<em>float</em>) – the maximum frequency edge for beta estimation; the default is the maximum of the frequency vector of the PSD obj</p></li>
<li><p><strong>logf_binning_step</strong> (<em>str</em><em>, </em><em>{'max'</em><em>, </em><em>'first'}</em>) – if ‘max’, then the maximum spacing of log(f) will be used as the binning step
if ‘first’, then the 1st spacing of log(f) will be used as the binning step</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – If True, will print warning messages if there is any</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><strong>res_dict</strong> –</p>
<ul class="simple">
<li><p>beta: list of the scaling factors</p></li>
<li><p>std_err: list of one standard deviation errors of the scaling factor</p></li>
<li><p>f_binned: list of the binned frequency series, used as X for linear regression</p></li>
<li><p>psd_binned: list of the binned PSD series, used as Y for linear regression</p></li>
<li><p>Y_reg: list of the predicted Y from linear regression, used with f_binned for the slope curve plotting</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dictionary</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#pyleoclim.core.ui.PSD.beta_est" title="pyleoclim.core.ui.PSD.beta_est"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.core.ui.PSD.beta_est</span></code></a></dt><dd><p>beta estimation for on a single PSD object</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.MultiplePSD.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#MultiplePSD.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.MultiplePSD.copy" title="Permalink to this definition"></a></dt>
<dd><p>Copy object</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.MultiplePSD.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[10,</span> <span class="pre">4]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_loglog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Amplitude'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savefig_settings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xticks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yticks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lgd_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#MultiplePSD.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.MultiplePSD.plot" title="Permalink to this definition"></a></dt>
<dd><p>Plot multiple PSD on the same plot</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>list</em><em>, </em><em>optional</em>) – Figure size. The default is [10, 4].</p></li>
<li><p><strong>in_loglog</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to plot in loglog. The default is True.</p></li>
<li><p><strong>in_period</strong> (<em>bool</em><em>, </em><em>optional</em>) – Plots against periods instead of frequencies. The default is True.</p></li>
<li><p><strong>xlabel</strong> (<em>str</em><em>, </em><em>optional</em>) – x-axis label. The default is None.</p></li>
<li><p><strong>ylabel</strong> (<em>str</em><em>, </em><em>optional</em>) – y-axis label. The default is ‘Amplitude’.</p></li>
<li><p><strong>title</strong> (<em>str</em><em>, </em><em>optional</em>) – Title for the figure. The default is None.</p></li>
<li><p><strong>xlim</strong> (<em>list</em><em>, </em><em>optional</em>) – Limits for the x-axis. The default is None.</p></li>
<li><p><strong>ylim</strong> (<em>list</em><em>, </em><em>optional</em>) – limits for the y-axis. The default is None.</p></li>
<li><p><strong>colors</strong> (<em>a list of</em><em>, or </em><em>one</em><em>, </em><em>Python supported color code</em><em> (</em><em>a string of hex code</em><em> or </em><em>a tuple of rgba values</em><em>)</em>) – Colors for plotting.
If None, the plotting will cycle the ‘tab10’ colormap;
if only one color is specified, then all curves will be plotted with that single color;
if a list of colors are specified, then the plotting will cycle that color list.</p></li>
<li><p><strong>cmap</strong> (<em>str</em>) – The colormap to use when “colors” is None.</p></li>
<li><p><strong>norm</strong> (<em>matplotlib.colors.Normalize like</em>) – The nomorlization for the colormap.
If None, a linear normalization will be used.</p></li>
<li><p><strong>savefig_settings</strong> (<em>dict</em><em>, </em><em>optional</em>) – <p>the dictionary of arguments for plt.savefig(); some notes below:
- “path” must be specified; it can be any existed or non-existed path,</p>
<blockquote>
<div><p>with or without a suffix; if the suffix is not given in “path”, it will follow “format”</p>
</div></blockquote>
<ul>
<li><p>”format” can be one of {“pdf”, “eps”, “png”, “ps”}</p></li>
</ul>
</p></li>
<li><p><strong>ax</strong> (<em>matplotlib axis</em><em>, </em><em>optional</em>) – The matplotlib axis object on which to retrun the figure. The default is None.</p></li>
<li><p><strong>xticks</strong> (<em>list</em><em>, </em><em>optional</em>) – x-ticks label. The default is None.</p></li>
<li><p><strong>yticks</strong> (<em>list</em><em>, </em><em>optional</em>) – y-ticks label. The default is None.</p></li>
<li><p><strong>legend</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to plot the legend. The default is True.</p></li>
<li><p><strong>plot_kwargs</strong> (<em>dictionary</em><em>, </em><em>optional</em>) – Parameters for plot function. The default is None.</p></li>
<li><p><strong>lgd_kwargs</strong> (<em>dictionary</em><em>, </em><em>optional</em>) – Parameters for legend. The default is None.</p></li>
<li><p><strong>mute</strong> (<em>bool</em><em>, </em><em>optional</em>) – if True, the plot will not show;
recommend to turn on when more modifications are going to be made on ax
The default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>fig, ax</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.MultiplePSD.plot_envelope">
<span class="sig-name descname"><span class="pre">plot_envelope</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[10,</span> <span class="pre">4]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.025,</span> <span class="pre">0.5,</span> <span class="pre">0.975]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_loglog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Amplitude'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savefig_settings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xticks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yticks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">curve_clr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'#d9544d'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">curve_lw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shade_clr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'#d9544d'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shade_alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shade_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lgd_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">members_plot_num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">members_alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">members_lw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#MultiplePSD.plot_envelope"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.MultiplePSD.plot_envelope" title="Permalink to this definition"></a></dt>
<dd><p>Plot mutiple PSD as an envelope.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>list</em><em>, </em><em>optional</em>) – The figure size. The default is [10, 4].</p></li>
<li><p><strong>qs</strong> (<em>list</em><em>, </em><em>optional</em>) – The significance levels to consider. The default is [0.025, 0.5, 0.975].</p></li>
<li><p><strong>in_loglog</strong> (<em>bool</em><em>, </em><em>optional</em>) – Plot in log space. The default is True.</p></li>
<li><p><strong>in_period</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to plot periodicity instead of frequency. The default is True.</p></li>
<li><p><strong>xlabel</strong> (<em>str</em><em>, </em><em>optional</em>) – x-axis label. The default is None.</p></li>
<li><p><strong>ylabel</strong> (<em>str</em><em>, </em><em>optional</em>) – y-axis label. The default is ‘Amplitude’.</p></li>
<li><p><strong>title</strong> (<em>str</em><em>, </em><em>optional</em>) – Plot title. The default is None.</p></li>
<li><p><strong>xlim</strong> (<em>list</em><em>, </em><em>optional</em>) – x-axis limits. The default is None.</p></li>
<li><p><strong>ylim</strong> (<em>list</em><em>, </em><em>optional</em>) – y-axis limits. The default is None.</p></li>
<li><p><strong>savefig_settings</strong> (<em>dict</em><em>, </em><em>optional</em>) – <p>the dictionary of arguments for plt.savefig(); some notes below:
- “path” must be specified; it can be any existed or non-existed path,</p>
<blockquote>
<div><p>with or without a suffix; if the suffix is not given in “path”, it will follow “format”</p>
</div></blockquote>
<ul>
<li><p>”format” can be one of {“pdf”, “eps”, “png”, “ps”} The default is None.</p></li>
</ul>
</p></li>
<li><p><strong>ax</strong> (<em>matplotlib.ax</em><em>, </em><em>optional</em>) – Matplotlib axis on which to return the plot. The default is None.</p></li>
<li><p><strong>xticks</strong> (<em>list</em><em>, </em><em>optional</em>) – xticks label. The default is None.</p></li>
<li><p><strong>yticks</strong> (<em>list</em><em>, </em><em>optional</em>) – yticks label. The default is None.</p></li>
<li><p><strong>plot_legend</strong> (<em>bool</em><em>, </em><em>optional</em>) – Wether to plot the legend. The default is True.</p></li>
<li><p><strong>curve_clr</strong> (<em>str</em><em>, </em><em>optional</em>) – Color of the main PSD. The default is sns.xkcd_rgb[‘pale red’].</p></li>
<li><p><strong>curve_lw</strong> (<em>str</em><em>, </em><em>optional</em>) – Width of the main PSD line. The default is 3.</p></li>
<li><p><strong>shade_clr</strong> (<em>str</em><em>, </em><em>optional</em>) – Color of the shaded envelope. The default is sns.xkcd_rgb[‘pale red’].</p></li>
<li><p><strong>shade_alpha</strong> (<em>float</em><em>, </em><em>optional</em>) – Transparency on the envelope. The default is 0.3.</p></li>
<li><p><strong>shade_label</strong> (<em>str</em><em>, </em><em>optional</em>) – Label for the envelope. The default is None.</p></li>
<li><p><strong>lgd_kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Parameters for the legend. The default is None.</p></li>
<li><p><strong>mute</strong> (<em>bool</em><em>, </em><em>optional</em>) – if True, the plot will not show;
recommend to turn on when more modifications are going to be made on ax. The default is False.</p></li>
<li><p><strong>members_plot_num</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of individual members to plot. The default is 10.</p></li>
<li><p><strong>members_alpha</strong> (<em>float</em><em>, </em><em>optional</em>) – Transparency of the lines representing the multiple members. The default is 0.3.</p></li>
<li><p><strong>members_lw</strong> (<em>float</em><em>, </em><em>optional</em>) – With of the lines representing the multiple members. The default is 1.</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) – Set the seed for random number generator. Useful for reproducibility. The default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>fig, ax</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.MultiplePSD.quantiles">
<span class="sig-name descname"><span class="pre">quantiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.05,</span> <span class="pre">0.5,</span> <span class="pre">0.95]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.5,</span> <span class="pre">1.5,</span> <span class="pre">0.5]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#MultiplePSD.quantiles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.MultiplePSD.quantiles" title="Permalink to this definition"></a></dt>
<dd><p>Calculate quantiles</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qs</strong> (<em>list</em><em>, </em><em>optional</em>) – List of quantiles to consider for the calculation. The default is [0.05, 0.5, 0.95].</p></li>
<li><p><strong>lw</strong> (<em>list</em><em>, </em><em>optional</em>) – Linewidth to use for plotting each level. Should be the same length as qs. The default is [0.5, 1.5, 0.5].</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – Frequency axis not consistent across the PSD list!</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>psds</strong></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>pyleoclim.MultiplePSD</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="scalogram-pyleoclim-scalogram">
<h2>Scalogram (pyleoclim.Scalogram)<a class="headerlink" href="#scalogram-pyleoclim-scalogram" title="Permalink to this headline"></a></h2>
<p>The Scalogram class is analogous to PSD, but for wavelet spectra (scalograms)</p>
<dl class="py class">
<dt class="sig sig-object py" id="pyleoclim.core.ui.Scalogram">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pyleoclim.core.ui.</span></span><span class="sig-name descname"><span class="pre">Scalogram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frequency</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amplitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Neff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeseries</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wave_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wave_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signif_qs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signif_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">period_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#Scalogram"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.Scalogram" title="Permalink to this definition"></a></dt>
<dd><p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyleoclim.core.ui.Scalogram.copy" title="pyleoclim.core.ui.Scalogram.copy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy</span></code></a>()</p></td>
<td><p>Copy object</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyleoclim.core.ui.Scalogram.plot" title="pyleoclim.core.ui.Scalogram.plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot</span></code></a>([in_period, xlabel, ylabel, title, ...])</p></td>
<td><p>Plot the scalogram</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyleoclim.core.ui.Scalogram.signif_test" title="pyleoclim.core.ui.Scalogram.signif_test"><code class="xref py py-obj docutils literal notranslate"><span class="pre">signif_test</span></code></a>([number, method, seed, qs, settings])</p></td>
<td><p>Significance test for wavelet analysis</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.Scalogram.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#Scalogram.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.Scalogram.copy" title="Permalink to this definition"></a></dt>
<dd><p>Copy object</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.Scalogram.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yticks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[10,</span> <span class="pre">8]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signif_clr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'white'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signif_linestyles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'-'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signif_linewidths</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contourf_style</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cbar_style</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savefig_settings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#Scalogram.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.Scalogram.plot" title="Permalink to this definition"></a></dt>
<dd><p>Plot the scalogram</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_period</strong> (<em>bool</em><em>, </em><em>optional</em>) – Plot the in period instead of frequency space. The default is True.</p></li>
<li><p><strong>xlabel</strong> (<em>str</em><em>, </em><em>optional</em>) – Label for the x-axis. The default is None.</p></li>
<li><p><strong>ylabel</strong> (<em>str</em><em>, </em><em>optional</em>) – Label for the y-axis. The default is None.</p></li>
<li><p><strong>title</strong> (<em>str</em><em>, </em><em>optional</em>) – Title for the figure. The default is None.</p></li>
<li><p><strong>ylim</strong> (<em>list</em><em>, </em><em>optional</em>) – Limits for the y-axis. The default is None.</p></li>
<li><p><strong>xlim</strong> (<em>list</em><em>, </em><em>optional</em>) – Limits for the x-axis. The default is None.</p></li>
<li><p><strong>yticks</strong> (<em>list</em><em>, </em><em>optional</em>) – yticks label. The default is None.</p></li>
<li><p><strong>figsize</strong> (<em>list</em><em>, </em><em>optional</em>) – Figure size The default is [10, 8].</p></li>
<li><p><strong>mute</strong> (<em>bool</em><em>, </em><em>optional</em>) – if True, the plot will not show;
recommend to turn on when more modifications are going to be made on ax The default is False.</p></li>
<li><p><strong>signif_clr</strong> (<em>str</em><em>, </em><em>optional</em>) – Color of the singificance line. The default is ‘white’.</p></li>
<li><p><strong>signif_linestyles</strong> (<em>str</em><em>, </em><em>optional</em>) – Linestyle of the significance line. The default is ‘-‘.</p></li>
<li><p><strong>signif_linewidths</strong> (<em>float</em><em>, </em><em>optional</em>) – Width for the significance line. The default is 1.</p></li>
<li><p><strong>contourf_style</strong> (<em>dict</em><em>, </em><em>optional</em>) – Arguments for the contour plot. The default is {}.</p></li>
<li><p><strong>cbar_style</strong> (<em>dict</em><em>, </em><em>optional</em>) – Arguments for the colarbar. The default is {}.</p></li>
<li><p><strong>savefig_settings</strong> (<em>dict</em><em>, </em><em>optional</em>) – saving options for the figure. The default is {}.</p></li>
<li><p><strong>ax</strong> (<em>ax</em><em>, </em><em>optional</em>) – Matplotlib Axis on which to return the figure. The default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>fig, ax</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#pyleoclim.core.ui.Series.wavelet" title="pyleoclim.core.ui.Series.wavelet"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.core.ui.Series.wavelet</span></code></a></dt><dd><p>Wavelet analysis</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.Scalogram.signif_test">
<span class="sig-name descname"><span class="pre">signif_test</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">number</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ar1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.95]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">settings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#Scalogram.signif_test"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.Scalogram.signif_test" title="Permalink to this definition"></a></dt>
<dd><p>Significance test for wavelet analysis</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>number</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of surrogates to generate for significance analysis. The default is 200.</p></li>
<li><p><strong>method</strong> (<em>{'ar1'}</em><em>, </em><em>optional</em>) – Method to use to generate the surrogates. The default is ‘ar1’.</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) – Set the seed for the random number generator. Useful for reproducibility The default is None.</p></li>
<li><p><strong>qs</strong> (<em>list</em><em>, </em><em>optional</em>) – Significane level to consider. The default is [0.95].</p></li>
<li><p><strong>settings</strong> (<em>dict</em><em>, </em><em>optional</em>) – Parameters for the model. The default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – qs should be a list with at least one value.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>new</strong> – A new Scalogram object with the significance level</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>pyleoclim.Scalogram</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#pyleoclim.core.ui.Series.wavelet" title="pyleoclim.core.ui.Series.wavelet"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.core.ui.Series.wavelet</span></code></a></dt><dd><p>wavelet analysis</p>
</dd>
</dl>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="multiplescalogram-pyleoclim-multiplescalogram">
<h2>MultipleScalogram (pyleoclim.MultipleScalogram)<a class="headerlink" href="#multiplescalogram-pyleoclim-multiplescalogram" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyleoclim.core.ui.MultipleScalogram">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pyleoclim.core.ui.</span></span><span class="sig-name descname"><span class="pre">MultipleScalogram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scalogram_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#MultipleScalogram"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.MultipleScalogram" title="Permalink to this definition"></a></dt>
<dd><p>Multiple Scalogram objects</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyleoclim.core.ui.MultipleScalogram.copy" title="pyleoclim.core.ui.MultipleScalogram.copy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy</span></code></a>()</p></td>
<td><p>Copy the object</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyleoclim.core.ui.MultipleScalogram.quantiles" title="pyleoclim.core.ui.MultipleScalogram.quantiles"><code class="xref py py-obj docutils literal notranslate"><span class="pre">quantiles</span></code></a>([qs])</p></td>
<td><p>Calculate quantiles</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.MultipleScalogram.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#MultipleScalogram.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.MultipleScalogram.copy" title="Permalink to this definition"></a></dt>
<dd><p>Copy the object</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.MultipleScalogram.quantiles">
<span class="sig-name descname"><span class="pre">quantiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.05,</span> <span class="pre">0.5,</span> <span class="pre">0.95]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#MultipleScalogram.quantiles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.MultipleScalogram.quantiles" title="Permalink to this definition"></a></dt>
<dd><p>Calculate quantiles</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>qs</strong> (<em>list</em><em>, </em><em>optional</em>) – List of quantiles to consider for the calculation. The default is [0.05, 0.5, 0.95].</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – Frequency axis not consistent across the PSD list!</p></li>
<li><p><strong>Value Error</strong> – Time axis not consistent across the scalogram list!</p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>scals</strong></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>pyleoclim.MultipleScalogram</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="coherence-pyleoclim-coherence">
<h2>Coherence (pyleoclim.Coherence)<a class="headerlink" href="#coherence-pyleoclim-coherence" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyleoclim.core.ui.Coherence">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pyleoclim.core.ui.</span></span><span class="sig-name descname"><span class="pre">Coherence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frequency</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coherence</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeseries1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeseries2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signif_qs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signif_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Neff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">period_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#Coherence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.Coherence" title="Permalink to this definition"></a></dt>
<dd><p>Coherence object</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#pyleoclim.core.ui.Series.wavelet_coherence" title="pyleoclim.core.ui.Series.wavelet_coherence"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.core.ui.Series.wavelet_coherence</span></code></a></dt><dd><p>Wavelet coherence</p>
</dd>
</dl>
</div>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyleoclim.core.ui.Coherence.copy" title="pyleoclim.core.ui.Coherence.copy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy</span></code></a>()</p></td>
<td><p>Copy object</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyleoclim.core.ui.Coherence.plot" title="pyleoclim.core.ui.Coherence.plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot</span></code></a>([xlabel, ylabel, title, figsize, ylim, ...])</p></td>
<td><p>Plot the cross-wavelet results</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyleoclim.core.ui.Coherence.signif_test" title="pyleoclim.core.ui.Coherence.signif_test"><code class="xref py py-obj docutils literal notranslate"><span class="pre">signif_test</span></code></a>([number, method, seed, qs, ...])</p></td>
<td><p>Significance testing</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.Coherence.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#Coherence.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.Coherence.copy" title="Permalink to this definition"></a></dt>
<dd><p>Copy object</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.Coherence.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xlabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[10,</span> <span class="pre">8]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yticks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contourf_style</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase_style</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cbar_style</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savefig_settings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signif_clr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'white'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signif_linestyles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'-'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signif_linewidths</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">under_clr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ivory'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">over_clr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'black'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bad_clr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'dimgray'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#Coherence.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.Coherence.plot" title="Permalink to this definition"></a></dt>
<dd><p>Plot the cross-wavelet results</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xlabel</strong> (<em>str</em><em>, </em><em>optional</em>) – x-axis label. The default is None.</p></li>
<li><p><strong>ylabel</strong> (<em>str</em><em>, </em><em>optional</em>) – y-axis label. The default is None.</p></li>
<li><p><strong>title</strong> (<em>str</em><em>, </em><em>optional</em>) – Title of the plot. The default is None.</p></li>
<li><p><strong>figsize</strong> (<em>list</em><em>, </em><em>optional</em>) – Figure size. The default is [10, 8].</p></li>
<li><p><strong>ylim</strong> (<em>list</em><em>, </em><em>optional</em>) – y-axis limits. The default is None.</p></li>
<li><p><strong>xlim</strong> (<em>list</em><em>, </em><em>optional</em>) – x-axis limits. The default is None.</p></li>
<li><p><strong>in_period</strong> (<em>bool</em><em>, </em><em>optional</em>) – Plots periods instead of frequencies The default is True.</p></li>
<li><p><strong>yticks</strong> (<em>list</em><em>, </em><em>optional</em>) – y-ticks label. The default is None.</p></li>
<li><p><strong>mute</strong> (<em>bool</em><em>, </em><em>optional</em>) – if True, the plot will not show;
recommend to turn on when more modifications are going to be made on ax The default is False. The default is False.</p></li>
<li><p><strong>contourf_style</strong> (<em>dict</em><em>, </em><em>optional</em>) – Arguments for the contour plot. The default is {}.</p></li>
<li><p><strong>phase_style</strong> (<em>dict</em><em>, </em><em>optional</em>) – Arguments for the phase arrows. The default is {}. It includes:
- ‘pt’: the default threshold above which phase arrows will be plotted
- ‘skip_x’: the number of points to skip between phase arrows along the x-axis
- ‘skip_y’:  the number of points to skip between phase arrows along the y-axis
- ‘scale’: number of data units per arrow length unit (see matplotlib.pyplot.quiver)
- ‘width’: shaft width in arrow units (see matplotlib.pyplot.quiver)</p></li>
<li><p><strong>cbar_style</strong> (<em>dict</em><em>, </em><em>optional</em>) – Arguments for the color bar. The default is {}.</p></li>
<li><p><strong>savefig_settings</strong> (<em>dict</em><em>, </em><em>optional</em>) – <p>The default is {}.
the dictionary of arguments for plt.savefig(); some notes below:
- “path” must be specified; it can be any existed or non-existed path,</p>
<blockquote>
<div><p>with or without a suffix; if the suffix is not given in “path”, it will follow “format”</p>
</div></blockquote>
<ul>
<li><p>”format” can be one of {“pdf”, “eps”, “png”, “ps”}</p></li>
</ul>
</p></li>
<li><p><strong>ax</strong> (<em>ax</em><em>, </em><em>optional</em>) – Matplotlib axis on which to return the figure. The default is None.</p></li>
<li><p><strong>signif_clr</strong> (<em>str</em><em>, </em><em>optional</em>) – Color of the singificance line. The default is ‘white’.</p></li>
<li><p><strong>signif_linestyles</strong> (<em>str</em><em>, </em><em>optional</em>) – Style of the significance line. The default is ‘-‘.</p></li>
<li><p><strong>signif_linewidths</strong> (<em>float</em><em>, </em><em>optional</em>) – Width of the significance line. The default is 1.</p></li>
<li><p><strong>under_clr</strong> (<em>str</em><em>, </em><em>optional</em>) – Color for under 0. The default is ‘ivory’.</p></li>
<li><p><strong>over_clr</strong> (<em>str</em><em>, </em><em>optional</em>) – Color for over 1. The default is ‘black’.</p></li>
<li><p><strong>bad_clr</strong> (<em>str</em><em>, </em><em>optional</em>) – Color for missing values. The default is ‘dimgray’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>fig, ax</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#pyleoclim.core.ui.Series.wavelet_coherence" title="pyleoclim.core.ui.Series.wavelet_coherence"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.core.ui.Series.wavelet_coherence</span></code></a>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">matplotlib.pyplot.quiver</span></code></p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.Coherence.signif_test">
<span class="sig-name descname"><span class="pre">signif_test</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">number</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ar1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.95]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">settings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mute_pbar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#Coherence.signif_test"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.Coherence.signif_test" title="Permalink to this definition"></a></dt>
<dd><p>Significance testing</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>number</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of surrogate series to create for significance testing. The default is 200.</p></li>
<li><p><strong>method</strong> (<em>{'ar1'}</em><em>, </em><em>optional</em>) – Method through which to generate the surrogate series. The default is ‘ar1’.</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) – Fixes the seed for the random number generator. Useful for reproducibility. The default is None.</p></li>
<li><p><strong>qs</strong> (<em>list</em><em>, </em><em>optional</em>) – Significanc level to return. The default is [0.95].</p></li>
<li><p><strong>settings</strong> (<em>dict</em><em>, </em><em>optional</em>) – Parameters for surrogate model. The default is None.</p></li>
<li><p><strong>mute_pbar</strong> (<em>bool</em><em>, </em><em>optional</em>) – Mute the progress bar. The default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>new</strong> – Coherence with significance level</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pyleoclim.Coherence</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#pyleoclim.core.ui.Series.wavelet_coherence" title="pyleoclim.core.ui.Series.wavelet_coherence"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.core.ui.Series.wavelet_coherence</span></code></a></dt><dd><p>Wavelet coherence</p>
</dd>
</dl>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="corr-pyleoclim-corr">
<h2>Corr (pyleoclim.Corr)<a class="headerlink" href="#corr-pyleoclim-corr" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyleoclim.core.ui.Corr">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pyleoclim.core.ui.</span></span><span class="sig-name descname"><span class="pre">Corr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signif</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_fmt_td</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_fmt_style</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'exp'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#Corr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.Corr" title="Permalink to this definition"></a></dt>
<dd><p>The object for correlation result in order to format the print message</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r</strong> (<em>float</em>) – the correlation coefficient</p></li>
<li><p><strong>p</strong> (<em>float</em>) – the p-value</p></li>
<li><p><strong>p_fmt_td</strong> (<em>float</em>) – the threshold for p-value formating (0.01 by default, i.e., if p&lt;0.01, will print “&lt; 0.01” instead of “0”)</p></li>
<li><p><strong>p_fmt_style</strong> (<em>str</em>) – the style for p-value formating (exponential notation by default)</p></li>
<li><p><strong>signif</strong> (<em>bool</em>) – the significance</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) – The significance level (0.05 by default)</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="../utils/correlation/corr_sig.html#pyleoclim.utils.correlation.corr_sig" title="pyleoclim.utils.correlation.corr_sig"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.correlation.corr_sig</span></code></a></dt><dd><p>Correlation function</p>
</dd>
<dt><a class="reference internal" href="../utils/correlation/fdr.html#pyleoclim.utils.correlation.fdr" title="pyleoclim.utils.correlation.fdr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.correlation.fdr</span></code></a></dt><dd><p>FDR function</p>
</dd>
</dl>
</div>
</dd></dl>

</section>
<section id="correns-pyleoclim-correns">
<h2>CorrEns (pyleoclim.CorrEns)<a class="headerlink" href="#correns-pyleoclim-correns" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyleoclim.core.ui.CorrEns">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pyleoclim.core.ui.</span></span><span class="sig-name descname"><span class="pre">CorrEns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signif</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signif_fdr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_fmt_td</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_fmt_style</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'exp'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#CorrEns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.CorrEns" title="Permalink to this definition"></a></dt>
<dd><p>Correlation Ensemble</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r</strong> (<em>list</em>) – the list of correlation coefficients</p></li>
<li><p><strong>p</strong> (<em>list</em>) – the list of p-values</p></li>
<li><p><strong>p_fmt_td</strong> (<em>float</em>) – the threshold for p-value formating (0.01 by default, i.e., if p&lt;0.01, will print “&lt; 0.01” instead of “0”)</p></li>
<li><p><strong>p_fmt_style</strong> (<em>str</em>) – the style for p-value formating (exponential notation by default)</p></li>
<li><p><strong>signif</strong> (<em>list</em>) – the list of significance without FDR</p></li>
<li><p><strong>signif_fdr</strong> (<em>list</em>) – the list of significance with FDR</p></li>
<li><p><strong>signif_fdr</strong> – the list of significance with FDR</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) – The significance level</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="../utils/correlation/corr_sig.html#pyleoclim.utils.correlation.corr_sig" title="pyleoclim.utils.correlation.corr_sig"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.correlation.corr_sig</span></code></a></dt><dd><p>Correlation function</p>
</dd>
<dt><a class="reference internal" href="../utils/correlation/fdr.html#pyleoclim.utils.correlation.fdr" title="pyleoclim.utils.correlation.fdr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.correlation.fdr</span></code></a></dt><dd><p>FDR function</p>
</dd>
</dl>
</div>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyleoclim.core.ui.CorrEns.plot" title="pyleoclim.core.ui.CorrEns.plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot</span></code></a>([figsize, title, ax, savefig_settings, ...])</p></td>
<td><p>Plot the correlation ensembles</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.CorrEns.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[4,</span> <span class="pre">4]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savefig_settings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hist_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clr_insignif</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'#929591'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clr_signif</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'#029386'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clr_signif_fdr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'#ffa756'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clr_percentile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'#ff796c'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rwidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vrange</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#CorrEns.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.CorrEns.plot" title="Permalink to this definition"></a></dt>
<dd><p>Plot the correlation ensembles</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>list</em><em>, </em><em>optional</em>) – The figure size. The default is [4, 4].</p></li>
<li><p><strong>title</strong> (<em>str</em><em>, </em><em>optional</em>) – Plot title. The default is None.</p></li>
<li><p><strong>savefig_settings</strong> (<em>dict</em>) – <p>the dictionary of arguments for plt.savefig(); some notes below:
- “path” must be specified; it can be any existed or non-existed path,</p>
<blockquote>
<div><p>with or without a suffix; if the suffix is not given in “path”, it will follow “format”</p>
</div></blockquote>
<ul>
<li><p>”format” can be one of {“pdf”, “eps”, “png”, “ps”}</p></li>
</ul>
</p></li>
<li><p><strong>hist_kwargs</strong> (<em>dict</em>) – the keyword arguments for ax.hist()</p></li>
<li><p><strong>title_kwargs</strong> (<em>dict</em>) – the keyword arguments for ax.set_title()</p></li>
<li><p><strong>ax</strong> (<em>matplotlib.axis</em><em>, </em><em>optional</em>) – the axis object from matplotlib
See [matplotlib.axes](<a class="reference external" href="https://matplotlib.org/api/axes_api.html">https://matplotlib.org/api/axes_api.html</a>) for details.</p></li>
<li><p><strong>mute</strong> (<em>{True</em><em>,</em><em>False}</em>) – if True, the plot will not show;
recommend to turn on when more modifications are going to be made on ax</p></li>
<li><p><strong>xlim</strong> (<em>list</em><em>, </em><em>optional</em>) – x-axis limits. The default is None.</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">matplotlib.pyplot.hist</span></code></dt><dd><p><a class="reference external" href="https://matplotlib.org/3.3.3/api/_as_gen/matplotlib.pyplot.hist.html">https://matplotlib.org/3.3.3/api/_as_gen/matplotlib.pyplot.hist.html</a></p>
</dd>
</dl>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="spatialdecomp-pyleoclim-spatialdecomp">
<h2>SpatialDecomp (pyleoclim.SpatialDecomp)<a class="headerlink" href="#spatialdecomp-pyleoclim-spatialdecomp" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyleoclim.core.ui.SpatialDecomp">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pyleoclim.core.ui.</span></span><span class="sig-name descname"><span class="pre">SpatialDecomp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">locs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eigvals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eigvecs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pctvar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pcs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neff</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#SpatialDecomp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.SpatialDecomp" title="Permalink to this definition"></a></dt>
<dd><p>Class to hold the results of spatial decompositions
applies to : <cite>pca()</cite>, <cite>mcpca()</cite>, <cite>mssa()</cite></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pyleoclim.core.ui.SpatialDecomp.time">
<span class="sig-name descname"><span class="pre">time</span></span><a class="headerlink" href="#pyleoclim.core.ui.SpatialDecomp.time" title="Permalink to this definition"></a></dt>
<dd><p>the common time axis</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyleoclim.core.ui.SpatialDecomp.locs">
<span class="sig-name descname"><span class="pre">locs</span></span><a class="headerlink" href="#pyleoclim.core.ui.SpatialDecomp.locs" title="Permalink to this definition"></a></dt>
<dd><p>a p x 2 array of coordinates (latitude, longitude) for mapping the spatial patterns (“EOFs”)</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float (p, 2)</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyleoclim.core.ui.SpatialDecomp.name">
<span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#pyleoclim.core.ui.SpatialDecomp.name" title="Permalink to this definition"></a></dt>
<dd><p>name of the dataset/analysis to use in plots</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyleoclim.core.ui.SpatialDecomp.eigvals">
<span class="sig-name descname"><span class="pre">eigvals</span></span><a class="headerlink" href="#pyleoclim.core.ui.SpatialDecomp.eigvals" title="Permalink to this definition"></a></dt>
<dd><p>vector of eigenvalues from the decomposition</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyleoclim.core.ui.SpatialDecomp.eigvecs">
<span class="sig-name descname"><span class="pre">eigvecs</span></span><a class="headerlink" href="#pyleoclim.core.ui.SpatialDecomp.eigvecs" title="Permalink to this definition"></a></dt>
<dd><p>array of eigenvectors from the decomposition</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyleoclim.core.ui.SpatialDecomp.pctvar">
<span class="sig-name descname"><span class="pre">pctvar</span></span><a class="headerlink" href="#pyleoclim.core.ui.SpatialDecomp.pctvar" title="Permalink to this definition"></a></dt>
<dd><p>array of pct variance accounted for by each mode</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pyleoclim.core.ui.SpatialDecomp.neff">
<span class="sig-name descname"><span class="pre">neff</span></span><a class="headerlink" href="#pyleoclim.core.ui.SpatialDecomp.neff" title="Permalink to this definition"></a></dt>
<dd><p>scalar representing the effective sample size of the leading mode</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyleoclim.core.ui.SpatialDecomp.modeplot" title="pyleoclim.core.ui.SpatialDecomp.modeplot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">modeplot</span></code></a>([mode, figsize, ax, ...])</p></td>
<td><p>Dashboard visualizing the properties of a given mode, including:</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyleoclim.core.ui.SpatialDecomp.screeplot" title="pyleoclim.core.ui.SpatialDecomp.screeplot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">screeplot</span></code></a>([figsize, uq, title, ax, ...])</p></td>
<td><p>Plot the eigenvalue spectrum with uncertainties</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.SpatialDecomp.modeplot">
<span class="sig-name descname"><span class="pre">modeplot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[10,</span> <span class="pre">5]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savefig_settings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spec_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mtm'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#SpatialDecomp.modeplot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.SpatialDecomp.modeplot" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Dashboard visualizing the properties of a given mode, including:</dt><dd><ol class="arabic simple">
<li><p>The temporal coefficient (PC or similar)</p></li>
<li><p>its spectrum</p></li>
<li><p>The spatial loadings (EOF or similar)</p></li>
</ol>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mode</strong> (<em>int</em>) – the (one-based) index of the mode to visualize</p></li>
<li><p><strong>figsize</strong> (<em>list</em><em>, </em><em>optional</em>) – The figure size. The default is [10, 5].</p></li>
<li><p><strong>savefig_settings</strong> (<em>dict</em>) – <p>the dictionary of arguments for plt.savefig(); some notes below:
- “path” must be specified; it can be any existed or non-existed path,</p>
<blockquote>
<div><p>with or without a suffix; if the suffix is not given in “path”, it will follow “format”</p>
</div></blockquote>
<ul>
<li><p>”format” can be one of {“pdf”, “eps”, “png”, “ps”}</p></li>
</ul>
</p></li>
<li><p><strong>title_kwargs</strong> (<em>dict</em>) – the keyword arguments for ax.set_title()</p></li>
<li><p><strong>gs</strong> (<em>matplotlib.gridspec object</em><em>, </em><em>optional</em>) – the axis object from matplotlib
See [matplotlib.gridspec.GridSpec](<a class="reference external" href="https://matplotlib.org/stable/tutorials/intermediate/gridspec.html">https://matplotlib.org/stable/tutorials/intermediate/gridspec.html</a>) for details.</p></li>
<li><p><strong>mute</strong> (<em>{True</em><em>,</em><em>False}</em>) – if True, the plot will not show;
recommend to turn on when more modifications are going to be made on ax</p></li>
<li><p><strong>spec_method</strong> (<em>str</em><em>, </em><em>optional</em>) – The name of the spectral method to be applied on the PC. Default: MTM
Note that the data are evenly-spaced, so any spectral method that
assumes even spacing is applicable here:  ‘mtm’, ‘welch’, ‘periodogram’
‘wwz’ is relevant too if scaling exponents need to be estimated.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.SpatialDecomp.screeplot">
<span class="sig-name descname"><span class="pre">screeplot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[6,</span> <span class="pre">4]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'N82'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'scree</span> <span class="pre">plot'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savefig_settings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0,</span> <span class="pre">10]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clr_eig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'C0'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#SpatialDecomp.screeplot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.SpatialDecomp.screeplot" title="Permalink to this definition"></a></dt>
<dd><p>Plot the eigenvalue spectrum with uncertainties</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>list</em><em>, </em><em>optional</em>) – The figure size. The default is [6, 4].</p></li>
<li><p><strong>title</strong> (<em>str</em><em>, </em><em>optional</em>) – Plot title. The default is ‘scree plot’.</p></li>
<li><p><strong>savefig_settings</strong> (<em>dict</em>) – <p>the dictionary of arguments for plt.savefig(); some notes below:
- “path” must be specified; it can be any existed or non-existed path,</p>
<blockquote>
<div><p>with or without a suffix; if the suffix is not given in “path”, it will follow “format”</p>
</div></blockquote>
<ul>
<li><p>”format” can be one of {“pdf”, “eps”, “png”, “ps”}</p></li>
</ul>
</p></li>
<li><p><strong>title_kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – the keyword arguments for ax.set_title()</p></li>
<li><p><strong>ax</strong> (<em>matplotlib.axis</em><em>, </em><em>optional</em>) – the axis object from matplotlib
See [matplotlib.axes](<a class="reference external" href="https://matplotlib.org/api/axes_api.html">https://matplotlib.org/api/axes_api.html</a>) for details.</p></li>
<li><p><strong>mute</strong> (<em>{True</em><em>,</em><em>False}</em>) – if True, the plot will not show;
recommend to turn on when more modifications are going to be made on ax</p></li>
<li><p><strong>xlim</strong> (<em>list</em><em>, </em><em>optional</em>) – x-axis limits. The default is [0, 10] (first 10 eigenvalues)</p></li>
<li><p><strong>uq</strong> (<em>str</em><em>, </em><em>optional</em>) – Method used for uncertainty quantification of the eigenvalues.
‘N82’ uses the North et al “rule of thumb” [1] with effective sample size
computed as in [2].
‘MC’ uses Monte-Carlo simulations (e.g. MC-EOF). Returns an error if no ensemble is found.</p></li>
<li><p><strong>clr_eig</strong> (<em>str</em><em>, </em><em>optional</em>) – color to be used for plotting eigenvalues</p></li>
</ul>
</dd>
</dl>
<p class="rubric">References</p>
<dl class="simple">
<dt>[1] North, G. R., T. L. Bell, R. F. Cahalan, and F. J. Moeng (1982),</dt><dd><p>Sampling errors in the estimation of empirical orthogonal functions,
Mon. Weather Rev., 110, 699–706.</p>
</dd>
<dt>[2] Hannachi, A., I. T. Jolliffe, and D. B. Stephenson (2007), Empirical</dt><dd><p>orthogonal functions and related techniques in atmospheric science:
A review, International Journal of Climatology, 27(9),
1119–1152, doi:10.1002/joc.1499.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="ssares-pyleoclim-ssares">
<h2>SsaRes (pyleoclim.SsaRes)<a class="headerlink" href="#ssares-pyleoclim-ssares" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pyleoclim.core.ui.SsaRes">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">pyleoclim.core.ui.</span></span><span class="sig-name descname"><span class="pre">SsaRes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eigvals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eigvecs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pctvar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RCmat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RCseries</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eigvals_q</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#SsaRes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.SsaRes" title="Permalink to this definition"></a></dt>
<dd><p>Class to hold the results of SSA method</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eigvals</strong> (<em>float</em><em> (</em><em>M</em><em>, </em><em>1</em><em>)</em>) – a vector of real eigenvalues derived from the signal</p></li>
<li><p><strong>pctvar</strong> (<em>float</em><em> (</em><em>M</em><em>, </em><em>1</em><em>)</em>) – same vector, expressed in % variance accounted for by each mode.</p></li>
<li><p><strong>eigvals_q</strong> (<em>float</em><em> (</em><em>M</em><em>, </em><em>2</em><em>)</em>) – array containing the 5% and 95% quantiles of the Monte-Carlo eigenvalue spectrum [ assigned NaNs if unused ]</p></li>
<li><p><strong>eigvecs</strong> (<em>float</em><em> (</em><em>M</em><em>, </em><em>M</em><em>)</em>) – a matrix of the temporal eigenvectors (T-EOFs), i.e. the temporal patterns that explain most of the variations in the original series.</p></li>
<li><p><strong>PC</strong> (<em>float</em><em> (</em><em>N - M + 1</em><em>, </em><em>M</em><em>)</em>) – array of principal components, i.e. the loadings that, convolved with the T-EOFs, produce the reconstructed components, or RCs</p></li>
<li><p><strong>RCmat</strong> (<em>float</em><em> (</em><em>N</em><em>,  </em><em>M</em><em>)</em>) – array of reconstructed components, One can think of each RC as the contribution of each mode to the timeseries, weighted by their eigenvalue (loosely speaking, their “amplitude”). Summing over all columns of RC recovers the original series. (synthesis, the reciprocal operation of analysis).</p></li>
<li><p><strong>mode_idx</strong> (<em>list</em>) – index of retained modes</p></li>
<li><p><strong>RCseries</strong> (<em>float</em><em> (</em><em>N</em><em>, </em><em>1</em><em>)</em>) – reconstructed series based on the RCs of mode_idx (scale and mean fit to original series)</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="../utils/decomposition/ssa.html#pyleoclim.utils.decomposition.ssa" title="pyleoclim.utils.decomposition.ssa"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.decomposition.ssa</span></code></a></dt><dd><p>Singular Spectrum Analysis</p>
</dd>
</dl>
</div>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#pyleoclim.core.ui.SsaRes.modeplot" title="pyleoclim.core.ui.SsaRes.modeplot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">modeplot</span></code></a>([mode, figsize, ax, ...])</p></td>
<td><p>Dashboard visualizing the properties of a given SSA mode, including:</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#pyleoclim.core.ui.SsaRes.screeplot" title="pyleoclim.core.ui.SsaRes.screeplot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">screeplot</span></code></a>([figsize, title, ax, ...])</p></td>
<td><p>Scree plot for SSA, visualizing the eigenvalue spectrum and indicating which modes were retained.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.SsaRes.modeplot">
<span class="sig-name descname"><span class="pre">modeplot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[10,</span> <span class="pre">5]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savefig_settings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spec_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mtm'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#SsaRes.modeplot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.SsaRes.modeplot" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Dashboard visualizing the properties of a given SSA mode, including:</dt><dd><ol class="arabic simple">
<li><p>the analyzing function (T-EOF)</p></li>
<li><p>the reconstructed component (RC)</p></li>
<li><p>its spectrum</p></li>
</ol>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mode</strong> (<em>int</em>) – the (one-based) index of the mode to visualize</p></li>
<li><p><strong>figsize</strong> (<em>list</em><em>, </em><em>optional</em>) – The figure size. The default is [10, 5].</p></li>
<li><p><strong>savefig_settings</strong> (<em>dict</em>) – <p>the dictionary of arguments for plt.savefig(); some notes below:
- “path” must be specified; it can be any existed or non-existed path,</p>
<blockquote>
<div><p>with or without a suffix; if the suffix is not given in “path”, it will follow “format”</p>
</div></blockquote>
<ul>
<li><p>”format” can be one of {“pdf”, “eps”, “png”, “ps”}</p></li>
</ul>
</p></li>
<li><p><strong>title_kwargs</strong> (<em>dict</em>) – the keyword arguments for ax.set_title()</p></li>
<li><p><strong>ax</strong> (<em>matplotlib.axis</em><em>, </em><em>optional</em>) – the axis object from matplotlib
See [matplotlib.axes](<a class="reference external" href="https://matplotlib.org/api/axes_api.html">https://matplotlib.org/api/axes_api.html</a>) for details.</p></li>
<li><p><strong>mute</strong> (<em>{True</em><em>,</em><em>False}</em>) – if True, the plot will not show;
recommend to turn on when more modifications are going to be made on ax</p></li>
<li><p><strong>spec_method</strong> (<em>str</em><em>, </em><em>optional</em>) – The name of the spectral method to be applied on the PC. Default: MTM
Note that the data are evenly-spaced, so any spectral method that
assumes even spacing is applicable here:  ‘mtm’, ‘welch’, ‘periodogram’
‘wwz’ is relevant too if scaling exponents need to be estimated.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pyleoclim.core.ui.SsaRes.screeplot">
<span class="sig-name descname"><span class="pre">screeplot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[6,</span> <span class="pre">4]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'SSA</span> <span class="pre">scree</span> <span class="pre">plot'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savefig_settings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clr_mcssa</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'#e50000'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clr_signif</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'#029386'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clr_eig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'black'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#SsaRes.screeplot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.core.ui.SsaRes.screeplot" title="Permalink to this definition"></a></dt>
<dd><p>Scree plot for SSA, visualizing the eigenvalue spectrum and indicating which modes were retained.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>figsize</strong> (<em>list</em><em>, </em><em>optional</em>) – The figure size. The default is [6, 4].</p></li>
<li><p><strong>title</strong> (<em>str</em><em>, </em><em>optional</em>) – Plot title. The default is ‘SSA scree plot’.</p></li>
<li><p><strong>savefig_settings</strong> (<em>dict</em>) – <p>the dictionary of arguments for plt.savefig(); some notes below:
- “path” must be specified; it can be any existed or non-existed path,</p>
<blockquote>
<div><p>with or without a suffix; if the suffix is not given in “path”, it will follow “format”</p>
</div></blockquote>
<ul>
<li><p>”format” can be one of {“pdf”, “eps”, “png”, “ps”}</p></li>
</ul>
</p></li>
<li><p><strong>title_kwargs</strong> (<em>dict</em>) – the keyword arguments for ax.set_title()</p></li>
<li><p><strong>ax</strong> (<em>matplotlib.axis</em><em>, </em><em>optional</em>) – the axis object from matplotlib
See [matplotlib.axes](<a class="reference external" href="https://matplotlib.org/api/axes_api.html">https://matplotlib.org/api/axes_api.html</a>) for details.</p></li>
<li><p><strong>mute</strong> (<em>{True</em><em>,</em><em>False}</em>) – if True, the plot will not show;
recommend to turn on when more modifications are going to be made on ax</p></li>
<li><p><strong>xlim</strong> (<em>list</em><em>, </em><em>optional</em>) – x-axis limits. The default is None.</p></li>
<li><p><strong>clr_mcssa</strong> (<em>str</em><em>, </em><em>optional</em>) – color of the Monte Carlo SSA AR(1) shading (if data are provided)
default: red</p></li>
<li><p><strong>clr_eig</strong> (<em>str</em><em>, </em><em>optional</em>) – color of the eigenvalues, default: black</p></li>
<li><p><strong>clr_signif</strong> (<em>str</em><em>, </em><em>optional</em>) – <dl class="simple">
<dt>color of the highlights for significant eigenvalue.</dt><dd><p>default: teal</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="gen-ts-pyleoclim-gen-ts">
<h2>gen_ts (pyleoclim.gen_ts)<a class="headerlink" href="#gen-ts-pyleoclim-gen-ts" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pyleoclim.gen_ts">
<span class="sig-prename descclassname"><span class="pre">pyleoclim.</span></span><span class="sig-name descname"><span class="pre">gen_ts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pyleoclim/core/ui.html#gen_ts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pyleoclim.gen_ts" title="Permalink to this definition"></a></dt>
<dd><p>Generate pyleoclim.Series with timeseries models</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>str</em><em>, </em><em>{'colored_noise'</em><em>, </em><em>'colored_noise_2regimes'</em><em>, </em><em>'ar1'}</em>) – the timeseries model to use
- colored_noise : colored noise with one scaling slope
- colored_noise_2regimes : colored noise with two regimes of two different scaling slopes
- ar1 : AR(1) series</p></li>
<li><p><strong>t</strong> (<em>array</em>) – the time axis</p></li>
<li><p><strong>nt</strong> (<em>number of time points</em>) – only works if ‘t’ is None, and it will use an evenly-spaced vector with nt points</p></li>
<li><p><strong>kwargs</strong> (<em>dict</em>) – the keyward arguments for the specified timeseries model</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>ts</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>pyleoclim.Series</cite></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="../utils/tsmodel/colored_noise.html#pyleoclim.utils.tsmodel.colored_noise" title="pyleoclim.utils.tsmodel.colored_noise"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.tsmodel.colored_noise</span></code></a></dt><dd><p>generate a colored noise timeseries</p>
</dd>
<dt><a class="reference internal" href="../utils/tsmodel/colored_noise_2regimes.html#pyleoclim.utils.tsmodel.colored_noise_2regimes" title="pyleoclim.utils.tsmodel.colored_noise_2regimes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.tsmodel.colored_noise_2regimes</span></code></a></dt><dd><p>generate a colored noise timeseries with two regimes</p>
</dd>
<dt><a class="reference internal" href="../utils/tsmodel/gen_ar1_evenly.html#pyleoclim.utils.tsmodel.gen_ar1_evenly" title="pyleoclim.utils.tsmodel.gen_ar1_evenly"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyleoclim.utils.tsmodel.gen_ar1_evenly</span></code></a></dt><dd><p>generate an AR(1) series</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<ul class="simple">
<li><p>AR(1) series</p></li>
</ul>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">pyleoclim</span> <span class="k">as</span> <span class="nn">pyleo</span>

<span class="go"># default length nt=1000; default persistence parameter g=0.5</span>
<span class="gp">In [2]: </span><span class="n">ts</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">gen_ts</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s1">&#39;ar1&#39;</span><span class="p">)</span>

<span class="gp">In [3]: </span><span class="n">g</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">tsmodel</span><span class="o">.</span><span class="n">ar1_fit</span><span class="p">(</span><span class="n">ts</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;g=</span><span class="si">{</span><span class="n">g</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="go">&lt;Figure size 1000x400 with 1 Axes&gt;</span>

<span class="gp">In [5]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">closefig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>

<span class="go"># use &#39;nt&#39; to modify the data length</span>
<span class="gp">In [6]: </span><span class="n">ts</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">gen_ts</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s1">&#39;ar1&#39;</span><span class="p">,</span> <span class="n">nt</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="gp">In [7]: </span><span class="n">g</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">tsmodel</span><span class="o">.</span><span class="n">ar1_fit</span><span class="p">(</span><span class="n">ts</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

<span class="gp">In [8]: </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;g=</span><span class="si">{</span><span class="n">g</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="go">&lt;Figure size 1000x400 with 1 Axes&gt;</span>

<span class="gp">In [9]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">closefig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>

<span class="go"># use &#39;settings&#39; to modify the persistence parameter &#39;g&#39;</span>
<span class="gp">In [10]: </span><span class="n">ts</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">gen_ts</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s1">&#39;ar1&#39;</span><span class="p">,</span> <span class="n">g</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>

<span class="gp">In [11]: </span><span class="n">g</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">tsmodel</span><span class="o">.</span><span class="n">ar1_fit</span><span class="p">(</span><span class="n">ts</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

<span class="gp">In [12]: </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;g=</span><span class="si">{</span><span class="n">g</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="go">&lt;Figure size 1000x400 with 1 Axes&gt;</span>

<span class="gp">In [13]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">closefig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/gen_ar1_t0.png" src="../_images/gen_ar1_t0.png" />
<img alt="../_images/gen_ar1_t1.png" src="../_images/gen_ar1_t1.png" />
<img alt="../_images/gen_ar1_t2.png" src="../_images/gen_ar1_t2.png" />
<ul class="simple">
<li><p>Colored noise with 1 regime</p></li>
</ul>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="go"># default scaling slope &#39;alpha&#39; is 1</span>
<span class="gp">In [14]: </span><span class="n">ts</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">gen_ts</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s1">&#39;colored_noise&#39;</span><span class="p">)</span>

<span class="gp">In [15]: </span><span class="n">psd</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">spectral</span><span class="p">()</span>

<span class="go"># estimate the scaling slope</span>
<span class="gp">In [16]: </span><span class="n">beta_info</span> <span class="o">=</span> <span class="n">psd</span><span class="o">.</span><span class="n">beta_est</span><span class="p">(</span><span class="n">fmin</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">50</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>

<span class="gp">In [17]: </span><span class="nb">print</span><span class="p">(</span><span class="n">beta_info</span><span class="p">[</span><span class="s1">&#39;beta&#39;</span><span class="p">])</span>
<span class="go">0.9985976796482925</span>

<span class="go"># visualize</span>
<span class="gp">In [18]: </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">psd</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="go">&lt;Figure size 1000x400 with 1 Axes&gt;</span>

<span class="gp">In [19]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">closefig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>

<span class="go"># modify &#39;alpha&#39; with &#39;settings&#39;</span>
<span class="gp">In [20]: </span><span class="n">ts</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">gen_ts</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s1">&#39;colored_noise&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="gp">In [21]: </span><span class="n">psd</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">spectral</span><span class="p">()</span>

<span class="go"># estimate the scaling slope</span>
<span class="gp">In [22]: </span><span class="n">beta_info</span> <span class="o">=</span> <span class="n">psd</span><span class="o">.</span><span class="n">beta_est</span><span class="p">(</span><span class="n">fmin</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">50</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>

<span class="gp">In [23]: </span><span class="nb">print</span><span class="p">(</span><span class="n">beta_info</span><span class="p">[</span><span class="s1">&#39;beta&#39;</span><span class="p">])</span>
<span class="go">1.8725854986733843</span>

<span class="go"># visualize</span>
<span class="gp">In [24]: </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">psd</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="go">&lt;Figure size 1000x400 with 1 Axes&gt;</span>

<span class="gp">In [25]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">closefig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/gen_cn_t0.png" src="../_images/gen_cn_t0.png" />
<img alt="../_images/gen_cn_t1.png" src="../_images/gen_cn_t1.png" />
<ul class="simple">
<li><p>Colored noise with 2 regimes</p></li>
</ul>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="go"># default scaling slopes &#39;alpha1&#39; is 0.5 and &#39;alpha2&#39; is 2, with break at 1/20</span>
<span class="gp">In [26]: </span><span class="n">ts</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">gen_ts</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s1">&#39;colored_noise_2regimes&#39;</span><span class="p">)</span>

<span class="gp">In [27]: </span><span class="n">psd</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">spectral</span><span class="p">()</span>

<span class="go"># estimate the scaling slope</span>
<span class="gp">In [28]: </span><span class="n">beta_info_lf</span> <span class="o">=</span> <span class="n">psd</span><span class="o">.</span><span class="n">beta_est</span><span class="p">(</span><span class="n">fmin</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">50</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">20</span><span class="p">)</span>

<span class="gp">In [29]: </span><span class="n">beta_info_hf</span> <span class="o">=</span> <span class="n">psd</span><span class="o">.</span><span class="n">beta_est</span><span class="p">(</span><span class="n">fmin</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">20</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>

<span class="gp">In [30]: </span><span class="nb">print</span><span class="p">(</span><span class="n">beta_info_lf</span><span class="p">[</span><span class="s1">&#39;beta&#39;</span><span class="p">])</span>
<span class="go">2.236662602348876</span>

<span class="gp">In [31]: </span><span class="nb">print</span><span class="p">(</span><span class="n">beta_info_hf</span><span class="p">[</span><span class="s1">&#39;beta&#39;</span><span class="p">])</span>
<span class="go">0.5236511745881505</span>

<span class="go"># visualize</span>
<span class="gp">In [32]: </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">psd</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="go">&lt;Figure size 1000x400 with 1 Axes&gt;</span>

<span class="gp">In [33]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">closefig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>

<span class="go"># modify the scaling slopes and scaling break with &#39;settings&#39;</span>
<span class="gp">In [34]: </span><span class="n">ts</span> <span class="o">=</span> <span class="n">pyleo</span><span class="o">.</span><span class="n">gen_ts</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s1">&#39;colored_noise_2regimes&#39;</span><span class="p">,</span> <span class="n">alpha1</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">alpha2</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">f_break</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span>

<span class="gp">In [35]: </span><span class="n">psd</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">spectral</span><span class="p">()</span>

<span class="go"># estimate the scaling slope</span>
<span class="gp">In [36]: </span><span class="n">beta_info_lf</span> <span class="o">=</span> <span class="n">psd</span><span class="o">.</span><span class="n">beta_est</span><span class="p">(</span><span class="n">fmin</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">50</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span>

<span class="gp">In [37]: </span><span class="n">beta_info_hf</span> <span class="o">=</span> <span class="n">psd</span><span class="o">.</span><span class="n">beta_est</span><span class="p">(</span><span class="n">fmin</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">10</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>

<span class="gp">In [38]: </span><span class="nb">print</span><span class="p">(</span><span class="n">beta_info_lf</span><span class="p">[</span><span class="s1">&#39;beta&#39;</span><span class="p">])</span>
<span class="go">1.0270592267250753</span>

<span class="gp">In [39]: </span><span class="nb">print</span><span class="p">(</span><span class="n">beta_info_hf</span><span class="p">[</span><span class="s1">&#39;beta&#39;</span><span class="p">])</span>
<span class="go">1.8696561897790713</span>

<span class="go"># visualize</span>
<span class="gp">In [40]: </span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">psd</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="go">&lt;Figure size 1000x400 with 1 Axes&gt;</span>

<span class="gp">In [41]: </span><span class="n">pyleo</span><span class="o">.</span><span class="n">closefig</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/gen_cn2_t0.png" src="../_images/gen_cn2_t0.png" />
<img alt="../_images/gen_cn2_t1.png" src="../_images/gen_cn2_t1.png" />
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../installation.html" class="btn btn-neutral float-left" title="Installing Pyleoclim" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../tutorials.html" class="btn btn-neutral float-right" title="Tutorials" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2017-2021, Deborah Khider, Feng Zhu, Julien Emile-Geay, Alexander James.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>